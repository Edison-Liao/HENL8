/** layuiAdmin.std-v1.0.0 LPPL License By http://www.layui.com/admin/ */
 ;"use strict";layui.config({base:"../../../layuiadmin/"}).extend({index:"lib/index"}).use(["index","table","form","consts","common"],function(){var e=layui.$,a=layui.table,t=layui.common,n=layui.form,i={},l={},o={},r={},s={},d=(layui.laypage,a.render({elem:"#LAY-yingyewangdianTable",id:"LAY-yingyewangdianTable",url:layui.setter.revenueUrl+"/api/BusinessHall/query/list",where:{Method:"list"},parseData:layui.setter.parseData,request:layui.setter.request,page:!0,cols:[[{field:"Coding",title:"营业网点编码",templet:function(e){return e.Me.Coding}},{field:"Name",title:"营业网点名称",templet:function(e){return e.Me.Name}},{field:"Addr",title:"营业地址",templet:function(e){return e.Me.Addr}},{field:"Tels",title:"联系电话",templet:function(e){return e.Me.Tels}},{field:"WorkTimeInfo",title:"营业时间",templet:function(e){return e.Me.WorkTimeInfo}},{field:"LeaderName",title:"主管操作员",templet:function(e){return e.Me.LeaderName}},{field:"Description",title:"描述",templet:function(e){return e.Me.Description}},{field:"CreateDate",title:"创建时间",templet:function(e){return"<div>"+layui.util.toDateString(e.Me.CreateDate)+"</div>"}},{field:"ModifyDate",title:"修改时间",templet:function(e){return"<div>"+layui.util.toDateString(e.Me.ModifyDate)+"</div>"}},{title:"操作",fixed:"right",align:"center",width:160,toolbar:"#LAY-yingyewangdianTable-barOperation"}]],loading:!0,limit:10,text:"对不起，加载出现异常！"}),{add:function(t){layer.closeAll(),layer.load(0,{shade:!1});var n=layui.consts.basePostData();console.info(t),delete t.P1,delete t.A1,delete t.C1,n.Data=t,n.Data.LeaderName=s.FixedUser_Name?s.FixedUser_Name:"",n.Data.LeaderID=s.FixedUser_Id?s.FixedUser_Id:"",n.Method="insert";var i=JSON.stringify(n);console.info("data",i),e.ajax({type:"Post",url:layui.setter.revenueUrl+"/api/BusinessHall/insert",data:i,async:!0,dataType:"json",headers:{Accept:"application/json","Content-Type":"application/json"},success:function(t){layer.closeAll(),t.IsSucceed?(layer.msg("添加营业网点成功!",{icon:6}),a.reload("LAY-yingyewangdianTable"),e("#lock-from").find("input[type=text],select,input[type=hidden]").each(function(){e(this).val("")})):(a.reload("LAY-yingyewangdianTable"),layer.msg("失败: "+t.Errors[0].Message,{icon:5}))},error:function(e){layer.closeAll(),layer.msg("数据操作失败",{icon:5})}}),a.reload("LAY-yingyewangdianTable")},"delete":function(t){layer.closeAll(),layer.load(0,{shade:!1});var n=layui.consts.basePostData();n.Data={Id:t.Me.Id},n.Method="remove";var i=JSON.stringify(n);e.ajax({type:"delete",url:layui.setter.revenueUrl+"/api/BusinessHall/Remove/",async:!0,data:i,dataType:"json",headers:{Accept:"application/json","Content-Type":"application/json"},success:function(e){layer.closeAll(),e.IsSucceed?(layer.msg("删除营业网点成功!",{icon:6}),a.reload("LAY-yingyewangdianTable")):(a.reload("LAY-yingyewangdianTable"),layer.msg("删除失败: "+e.Errors[0].Message,{icon:5}))},error:function(e){layer.closeAll(),layer.msg("数据操作失败",{icon:5})}})},detail:function(a){layer.load(0,{shade:!1,time:1e4});var t=layui.consts.basePostData(),n=JSON.stringify(t);e.ajax({type:"get",url:layui.setter.revenueUrl+"/api/BusinessHall/query/key?Data.Id="+para.Me.Id+"&Method=key",async:!0,data:n,dataType:"json",success:function(a){a.IsSucceed?layer.open({type:0,title:"营业网点详情",content:e("#lock-from").html(),maxmin:!0,area:["700px","400px"],btn:["确定"],yes:function(e,a){layer.close(e),layer.closeAll("loading")}}):layer.msg("失败"+res.Errors[0].Description,{icon:5})},error:function(e){layer.closeAll(),layer.msg("数据加载失败",{icon:5})}})},edit:function(d){layui.consts.basePostData();e.ajax({type:"get",url:layui.setter.revenueUrl+"/api/BusinessHall/query/key?Data.Id="+d.Me.Id+"&Method=key",async:!0,success:function(c){if(c.IsSucceed){console.info(c);var u=c.Result.Me;if(layer.open({type:1,title:"修改营业网点",content:e("#lock-from"),maxmin:!0,area:["900px","500px"],btn:["确定","取消"],yes:function(t,i){var l=e("#LAY-wangdian-add-submit");n.on("submit(LAY-wangdian-add-submit)",function(n){var i=n.field,l=layui.consts.basePostData();new Date;l.Data=i,l.Data.Id=u.Id,delete n.P1,delete n.A1,delete n.C1,l.Data.LeaderName=s.FixedUser_Name?s.FixedUser_Name:"",l.Data.LeaderID=s.FixedUser_Id?s.FixedUser_Id:"",l.Method="update";var o=JSON.stringify(l);console.info("data",o),e.ajax({type:"Put",url:layui.setter.revenueUrl+"/api/BusinessHall/update",data:o,async:!0,dataType:"json",headers:{Accept:"application/json","Content-Type":"application/json"},success:function(t){layer.closeAll(),t.IsSucceed?(layer.msg("修改营业网点成功!",{icon:6}),a.reload("LAY-yingyewangdianTable"),e("#lock-from").find("input[type=text],select,input[type=hidden]").each(function(){e(this).val("")})):(a.reload("LAY-yingyewangdianTable"),layer.msg("失败: "+t.Errors[0].Message,{icon:5}))},error:function(e){layer.closeAll(),layer.msg("数据操作失败",{icon:5})}}),layer.close(t)}),l.trigger("click")}}),n.val("lock-from",{Coding:u.Coding,Name:u.Name,CompanyCoding:u.CompanyCoding,Addr:u.Addr,Tels:u.Tels,WorkTimeInfo:u.WorkTimeInfo,LeaderID:u.LeaderID,LeaderName:u.LeaderName,SortNum:u.SortNum,Description:u.Description}),d.Me.LeaderName){r=t.findObjectByKeyVal(i,"Title",d.Me.LeaderName),o=t.findObjectByKeyVal(i,"Id",r.ParentId),l=t.findObjectByKeyVal(i,"Id",o.ParentId),console.info(l.Title,o.Title,r.Title),e(province).html(""),e(province).append("<option selected>全部</option>");for(var y in i)e(province).append("<option  &nbsp; id="+i[y].Id+" &nbsp; value="+i[y].Title+">"+i[y].Title+"</option>");e(province).find("option[value='"+l.Title+"']").attr("selected",!0),n.render("select"),e(city).html(""),e(city).append("<option>全部</option>");var f=l.Children;if(f){for(var y in f)e(city).append("<option &nbsp;  id="+f[y].Id+" &nbsp;  value="+f[y].Title+">"+f[y].Title+"</option>");e(city).find("option[value='"+o.Title+"']").attr("selected",!0)}if(n.render("select"),e(city).next().find(".layui-this").removeClass("layui-this").click(),p.formHidden("province",c.value),e(".pca-label-province").html(c.value),e(area).html(""),e(area).append("<option>全部</option>"),f=o.Children){for(var y in f)console.info(f[y].Id),e(area).append("<option &nbsp; id="+f[y].Id+" &nbsp; value="+f[y].Title+">"+f[y].Title+"</option>");e(area).find("option[value='"+r.Title+"']").attr("selected",!0)}n.render("select"),e(area).next().find(".layui-this").removeClass("layui-this").click(),p.formHidden("city",c.value),e(".pca-label-city").html(c.value)}else p.init("select[name=P1]","select[name=C1]","select[name=A1]"),n.render("select");console.info(d)}else layer.msg("失败"+c.Errors[0].Message,{icon:5})},error:function(e){layer.closeAll(),layer.msg("数据加载失败",{icon:5})}})}}),c={batchdel:function(){var e=a.checkStatus("LAY-user-manage"),t=e.data;return 0===t.length?layer.msg("请选择数据"):(layer.close(index),void layer.confirm("确定删除吗？",function(e){a.reload("LAY-user-manage"),layer.msg("已删除")}))},add:function(){e.ajax({type:"Get",url:layui.setter.baseUrl+"/api/Organ/treeview",async:!0,headers:{Accept:"application/json, text/javascript, */*; q=0.01"},success:function(e){e.IsSucceed&&(i=e.Result.TreeNodes[0].Children,p.init("select[name=P1]","select[name=C1]","select[name=A1]"),n.render("select"))},error:function(e){layer.msg("数据操作失败",{icon:5})}}),layer.open({type:1,title:"添加营业网点",content:e("#lock-from"),maxmin:!0,area:["900px","500px"],btn:["确定","取消"],yes:function(a,t){var i=e("#LAY-wangdian-add-submit");n.on("submit(LAY-wangdian-add-submit)",function(t){var n=t.field;e.ajax({type:"get",url:layui.setter.revenueUrl+"/api/Common/GetInsertGuid",async:!0,dataType:"json",headers:{Accept:"application/json","Content-Type":"application/json"},success:function(e){e.IsSucceed?(n.Idd=e.Result,d.add(n),layer.close(a)):layer.msg("添加网点数据失败"+e,{icon:5})},error:function(e){layer.closeAll(),layer.msg("数据操作失败",{icon:5})}})}),i.trigger("click")}})}},p={};p.keys={},p.ckeys={},p.init=function(a,t,l,o,r,d){if(a&&e(a).length){e(a).html(""),e(a).append("<option selected>全部</option>");for(var c in i)e(a).append("<option  &nbsp; id="+i[c].Id+" &nbsp; value="+i[c].Title+">"+i[c].Title+"</option>"),p.keys[i[c].Title]=i[c];n.render("select"),t&&e(t).length&&(p.formRender(t),n.on("select(province)",function(a){var i=p.keys[a.value].Children;if(e(t).html(""),e(t).append("<option>全部</option>"),i){for(var l in i)e(t).append("<option &nbsp;  id="+i[l].Id+" &nbsp;  value="+i[l].Title+">"+i[l].Title+"</option>"),p.ckeys[i[l].Title]=i[l];e(t).find("option:eq(1)").attr("selected",!0)}n.render("select"),e(t).next().find(".layui-this").removeClass("layui-this").click(),p.formHidden("province",a.value),e(".pca-label-province").html(a.value)}),l&&e(l).length&&(p.formRender(l),n.on("select(city)",function(a){var t=p.ckeys[a.value];if(e(l).html(""),e(l).append("<option>全部</option>"),t){t=t.Children;for(var i in t)console.info(t[i].Id),e(l).append("<option &nbsp; id="+t[i].Id+" &nbsp; value="+t[i].Title+">"+t[i].Title+"</option>");e(l).find("option:eq(1)").attr("selected",!0)}n.render("select"),e(l).next().find(".layui-this").removeClass("layui-this").click(),p.formHidden("city",a.value),e(".pca-label-city").html(a.value)}),n.on("select(area)",function(a){s.FixedUser_Name=e("#area option[selected='selected']").val(),s.FixedUser_Id=e("#area option[selected='selected']").attr("id"),p.formHidden("area",a.value),e(".pca-label-area").html(a.value)})))}},p.formRender=function(a){e(a).html(""),e(a).append("<option>全部</option>"),n.render("select")},p.formHidden=function(a,t){e("#pca-hide-"+a).length?e("#pca-hide-"+a).val(t):e("body").append('<input id="pca-hide-'+a+'" type="hidden" value="'+t+'" />')},e(".layui-btn.layuiadmin-btn-useradmin").on("click",function(){var a=e(this).data("type");c[a]?c[a].call(this):""}),a.on("tool()",function(a){var t=a.data,n=a.event;a.tr;"detail"===n?(console.info("do detail"),d.detail(t)):"del"===n?layer.confirm("真的删除行么",function(e){d["delete"](t),layer.close(e)}):"edit"===n&&(console.info(t),e.ajax({type:"Get",url:layui.setter.baseUrl+"/api/Organ/treeview",async:!0,headers:{Accept:"application/json, text/javascript, */*; q=0.01"},success:function(e){e.IsSucceed&&(i=e.Result.TreeNodes[0].Children,console.info(i),d.edit(t))},error:function(e){layer.msg("数据操作失败",{icon:5})}}))})});
//# sourceMappingURL=../src/maps/shoufeiguanli/yingyewangdian.js.map

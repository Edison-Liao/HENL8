layui.define(["jquery","jquery_ztree"],function(e){var t,c="jquery_ztree_excheck",h=layui.jquery_ztree,a=layui.$;!function(e){var t={event:{CHECK:"ztree_check"},id:{CHECK:"_check"},checkbox:{STYLE:"checkbox",DEFAULT:"chk",DISABLED:"disable",FALSE:"false",TRUE:"true",FULL:"full",PART:"part",FOCUS:"focus"},radio:{STYLE:"radio",TYPE_ALL:"all",TYPE_LEVEL:"level"}},c={check:{enable:!1,autoCheckTrigger:!1,chkStyle:t.checkbox.STYLE,nocheckInherit:!1,chkDisabledInherit:!1,radioType:t.radio.TYPE_LEVEL,chkboxType:{Y:"ps",N:"ps"}},data:{key:{checked:"checked"}},callback:{beforeCheck:null,onCheck:null}},a=function(e){var t=N.getRoot(e);t.radioCheckedList=[]},n=function(e){},i=function(e){var t=e.treeObj,c=S.event;t.bind(c.CHECK,function(t,c,h,a){t.srcEvent=c,v.apply(e.callback.onCheck,[t,h,a])})},r=function(e){var t=e.treeObj,c=S.event;t.unbind(c.CHECK)},d=function(e){var t=e.target,c=N.getSetting(e.data.treeId),h="",a=null,n="",i="",r=null,d=null;if(v.eqs(e.type,"mouseover")?c.check.enable&&v.eqs(t.tagName,"span")&&null!==t.getAttribute("treeNode"+S.id.CHECK)&&(h=v.getNodeMainDom(t).id,n="mouseoverCheck"):v.eqs(e.type,"mouseout")?c.check.enable&&v.eqs(t.tagName,"span")&&null!==t.getAttribute("treeNode"+S.id.CHECK)&&(h=v.getNodeMainDom(t).id,n="mouseoutCheck"):v.eqs(e.type,"click")&&c.check.enable&&v.eqs(t.tagName,"span")&&null!==t.getAttribute("treeNode"+S.id.CHECK)&&(h=v.getNodeMainDom(t).id,n="checkNode"),h.length>0)switch(a=N.getNodeCache(c,h),n){case"checkNode":r=u.onCheckNode;break;case"mouseoverCheck":r=u.onMouseoverCheck;break;case"mouseoutCheck":r=u.onMouseoutCheck}var o={stop:"checkNode"===n,node:a,nodeEventType:n,nodeEventCallback:r,treeEventType:i,treeEventCallback:d};return o},o=function(e,t,c,h,a,n,i){if(c){var r=N.nodeChecked(e,c);if(r=N.nodeChecked(e,c,r),c.checkedOld=r,"string"==typeof c.nocheck&&(c.nocheck=v.eqs(c.nocheck,"true")),c.nocheck=!!c.nocheck||e.check.nocheckInherit&&h&&!!h.nocheck,"string"==typeof c.chkDisabled&&(c.chkDisabled=v.eqs(c.chkDisabled,"true")),c.chkDisabled=!!c.chkDisabled||e.check.chkDisabledInherit&&h&&!!h.chkDisabled,"string"==typeof c.halfCheck&&(c.halfCheck=v.eqs(c.halfCheck,"true")),c.halfCheck=!!c.halfCheck,c.check_Child_State=-1,c.check_Focus=!1,c.getCheckStatus=function(){return N.getCheckStatus(e,c)},e.check.chkStyle==S.radio.STYLE&&e.check.radioType==S.radio.TYPE_ALL&&r){var d=N.getRoot(e);d.radioCheckedList.push(c)}}},k=function(e,t,c){e.check.enable&&(N.makeChkFlag(e,t),c.push("<span ID='",t.tId,S.id.CHECK,"' class='",_.makeChkClass(e,t),"' treeNode",S.id.CHECK,t.nocheck===!0?" style='display:none;'":"","></span>"))},s=function(e,t){t.checkNode=function(t,c,h,a){var n=N.nodeChecked(e,t);if(t.chkDisabled!==!0&&(c!==!0&&c!==!1&&(c=!n),a=!!a,(n!==c||h)&&(!a||0!=v.apply(this.setting.callback.beforeCheck,[this.setting.treeId,t],!0))&&v.uCanDo(this.setting)&&this.setting.check.enable&&t.nocheck!==!0)){N.nodeChecked(e,t,c);var i=E(t,S.id.CHECK,this.setting);(h||this.setting.check.chkStyle===S.radio.STYLE)&&_.checkNodeRelation(this.setting,t),_.setChkClass(this.setting,i,t),_.repairParentChkClassWithSelf(this.setting,t),a&&this.setting.treeObj.trigger(S.event.CHECK,[null,this.setting.treeId,t])}},t.checkAllNodes=function(e){_.repairAllChk(this.setting,!!e)},t.getCheckedNodes=function(t){var t=t!==!1,c=N.nodeChildren(e,N.getRoot(this.setting));return N.getTreeCheckedNodes(this.setting,c,t)},t.getChangeCheckedNodes=function(){var t=N.nodeChildren(e,N.getRoot(this.setting));return N.getTreeChangeCheckedNodes(this.setting,t)},t.setChkDisabled=function(e,t,c,h){t=!!t,c=!!c,h=!!h,_.repairSonChkDisabled(this.setting,e,t,h),_.repairParentChkDisabled(this.setting,e.getParentNode(),t,c)};var c=t.updateNode;t.updateNode=function(e,h){if(c&&c.apply(t,arguments),e&&this.setting.check.enable){var a=E(e,this.setting);if(a.get(0)&&v.uCanDo(this.setting)){var n=E(e,S.id.CHECK,this.setting);1!=h&&this.setting.check.chkStyle!==S.radio.STYLE||_.checkNodeRelation(this.setting,e),_.setChkClass(this.setting,n,e),_.repairParentChkClassWithSelf(this.setting,e)}}}},l={getRadioCheckedList:function(e){for(var t=N.getRoot(e).radioCheckedList,c=0,h=t.length;c<h;c++)N.getNodeCache(e,t[c].tId)||(t.splice(c,1),c--,h--);return t},getCheckStatus:function(e,t){if(!e.check.enable||t.nocheck||t.chkDisabled)return null;var c=N.nodeChecked(e,t),h={checked:c,half:t.halfCheck?t.halfCheck:e.check.chkStyle==S.radio.STYLE?2===t.check_Child_State:c?t.check_Child_State>-1&&t.check_Child_State<2:t.check_Child_State>0};return h},getTreeCheckedNodes:function(e,t,c,h){if(!t)return[];var a=c&&e.check.chkStyle==S.radio.STYLE&&e.check.radioType==S.radio.TYPE_ALL;h=h?h:[];for(var n=0,i=t.length;n<i;n++){var r=t[n],d=N.nodeChildren(e,r),o=N.nodeChecked(e,r);if(r.nocheck!==!0&&r.chkDisabled!==!0&&o==c&&(h.push(r),a))break;if(N.getTreeCheckedNodes(e,d,c,h),a&&h.length>0)break}return h},getTreeChangeCheckedNodes:function(e,t,c){if(!t)return[];c=c?c:[];for(var h=0,a=t.length;h<a;h++){var n=t[h],i=N.nodeChildren(e,n),r=N.nodeChecked(e,n);n.nocheck!==!0&&n.chkDisabled!==!0&&r!=n.checkedOld&&c.push(n),N.getTreeChangeCheckedNodes(e,i,c)}return c},makeChkFlag:function(e,t){if(t){var c=-1,h=N.nodeChildren(e,t);if(h)for(var a=0,n=h.length;a<n;a++){var i=h[a],r=N.nodeChecked(e,i),d=-1;if(e.check.chkStyle==S.radio.STYLE){if(d=i.nocheck===!0||i.chkDisabled===!0?i.check_Child_State:i.halfCheck===!0?2:r?2:i.check_Child_State>0?2:0,2==d){c=2;break}0==d&&(c=0)}else if(e.check.chkStyle==S.checkbox.STYLE){if(d=i.nocheck===!0||i.chkDisabled===!0?i.check_Child_State:i.halfCheck===!0?1:r?i.check_Child_State===-1||2===i.check_Child_State?2:1:i.check_Child_State>0?1:0,1===d){c=1;break}if(2===d&&c>-1&&a>0&&d!==c){c=1;break}if(2===c&&d>-1&&d<2){c=1;break}d>-1&&(c=d)}}t.check_Child_State=c}}},C={},u={onCheckNode:function(e,t){if(t.chkDisabled===!0)return!1;var c=N.getSetting(e.data.treeId);if(0==v.apply(c.callback.beforeCheck,[c.treeId,t],!0))return!0;var h=N.nodeChecked(c,t);N.nodeChecked(c,t,!h),_.checkNodeRelation(c,t);var a=E(t,S.id.CHECK,c);return _.setChkClass(c,a,t),_.repairParentChkClassWithSelf(c,t),c.treeObj.trigger(S.event.CHECK,[e,c.treeId,t]),!0},onMouseoverCheck:function(e,t){if(t.chkDisabled===!0)return!1;var c=N.getSetting(e.data.treeId),h=E(t,S.id.CHECK,c);return t.check_Focus=!0,_.setChkClass(c,h,t),!0},onMouseoutCheck:function(e,t){if(t.chkDisabled===!0)return!1;var c=N.getSetting(e.data.treeId),h=E(t,S.id.CHECK,c);return t.check_Focus=!1,_.setChkClass(c,h,t),!0}},f={},g={checkNodeRelation:function(e,t){var c,h,a,n=S.radio,i=N.nodeChecked(e,t);if(e.check.chkStyle==n.STYLE){var r=N.getRadioCheckedList(e);if(i)if(e.check.radioType==n.TYPE_ALL){for(h=r.length-1;h>=0;h--){c=r[h];var d=N.nodeChecked(e,c);d&&c!=t&&(N.nodeChecked(e,c,!1),r.splice(h,1),_.setChkClass(e,E(c,S.id.CHECK,e),c),c.parentTId!=t.parentTId&&_.repairParentChkClassWithSelf(e,c))}r.push(t)}else{var o=t.parentTId?t.getParentNode():N.getRoot(e),k=N.nodeChildren(e,o);for(h=0,a=k.length;h<a;h++){c=k[h];var d=N.nodeChecked(e,c);d&&c!=t&&(N.nodeChecked(e,c,!1),_.setChkClass(e,E(c,S.id.CHECK,e),c))}}else if(e.check.radioType==n.TYPE_ALL)for(h=0,a=r.length;h<a;h++)if(t==r[h]){r.splice(h,1);break}}else{var k=N.nodeChildren(e,t);i&&(!k||0==k.length||e.check.chkboxType.Y.indexOf("s")>-1)&&_.setSonNodeCheckBox(e,t,!0),i||k&&0!=k.length&&!(e.check.chkboxType.N.indexOf("s")>-1)||_.setSonNodeCheckBox(e,t,!1),i&&e.check.chkboxType.Y.indexOf("p")>-1&&_.setParentNodeCheckBox(e,t,!0),!i&&e.check.chkboxType.N.indexOf("p")>-1&&_.setParentNodeCheckBox(e,t,!1)}},makeChkClass:function(e,t){var c=S.checkbox,h=S.radio,a="",n=N.nodeChecked(e,t);a=t.chkDisabled===!0?c.DISABLED:t.halfCheck?c.PART:e.check.chkStyle==h.STYLE?t.check_Child_State<1?c.FULL:c.PART:n?2===t.check_Child_State||t.check_Child_State===-1?c.FULL:c.PART:t.check_Child_State<1?c.FULL:c.PART;var i=e.check.chkStyle+"_"+(n?c.TRUE:c.FALSE)+"_"+a;return i=t.check_Focus&&t.chkDisabled!==!0?i+"_"+c.FOCUS:i,S.className.BUTTON+" "+c.DEFAULT+" "+i},repairAllChk:function(e,t){if(e.check.enable&&e.check.chkStyle===S.checkbox.STYLE)for(var c=N.getRoot(e),h=N.nodeChildren(e,c),a=0,n=h.length;a<n;a++){var i=h[a];i.nocheck!==!0&&i.chkDisabled!==!0&&N.nodeChecked(e,i,t),_.setSonNodeCheckBox(e,i,t)}},repairChkClass:function(e,t){if(t&&(N.makeChkFlag(e,t),t.nocheck!==!0)){var c=E(t,S.id.CHECK,e);_.setChkClass(e,c,t)}},repairParentChkClass:function(e,t){if(t&&t.parentTId){var c=t.getParentNode();_.repairChkClass(e,c),_.repairParentChkClass(e,c)}},repairParentChkClassWithSelf:function(e,t){if(t){var c=N.nodeChildren(e,t);c&&c.length>0?_.repairParentChkClass(e,c[0]):_.repairParentChkClass(e,t)}},repairSonChkDisabled:function(e,t,c,h){if(t){t.chkDisabled!=c&&(t.chkDisabled=c),_.repairChkClass(e,t);var a=N.nodeChildren(e,t);if(a&&h)for(var n=0,i=a.length;n<i;n++){var r=a[n];_.repairSonChkDisabled(e,r,c,h)}}},repairParentChkDisabled:function(e,t,c,h){t&&(t.chkDisabled!=c&&h&&(t.chkDisabled=c),_.repairChkClass(e,t),_.repairParentChkDisabled(e,t.getParentNode(),c,h))},setChkClass:function(e,t,c){t&&(c.nocheck===!0?t.hide():t.show(),t.attr("class",_.makeChkClass(e,c)))},setParentNodeCheckBox:function(e,t,c,h){var a=E(t,S.id.CHECK,e);if(h||(h=t),N.makeChkFlag(e,t),t.nocheck!==!0&&t.chkDisabled!==!0&&(N.nodeChecked(e,t,c),_.setChkClass(e,a,t),e.check.autoCheckTrigger&&t!=h&&e.treeObj.trigger(S.event.CHECK,[null,e.treeId,t])),t.parentTId){var n=!0;if(!c)for(var i=N.nodeChildren(e,t.getParentNode()),r=0,d=i.length;r<d;r++){var o=i[r],k=N.nodeChecked(e,o);if(o.nocheck!==!0&&o.chkDisabled!==!0&&k||(o.nocheck===!0||o.chkDisabled===!0)&&o.check_Child_State>0){n=!1;break}}n&&_.setParentNodeCheckBox(e,t.getParentNode(),c,h)}},setSonNodeCheckBox:function(e,t,c,h){if(t){var a=E(t,S.id.CHECK,e);h||(h=t);var n=!1,i=N.nodeChildren(e,t);if(i)for(var r=0,d=i.length;r<d;r++){var o=i[r];_.setSonNodeCheckBox(e,o,c,h),o.chkDisabled===!0&&(n=!0)}t!=N.getRoot(e)&&t.chkDisabled!==!0&&(n&&t.nocheck!==!0&&N.makeChkFlag(e,t),t.nocheck!==!0&&t.chkDisabled!==!0?(N.nodeChecked(e,t,c),n||(t.check_Child_State=i&&i.length>0?c?2:0:-1)):t.check_Child_State=-1,_.setChkClass(e,a,t),e.check.autoCheckTrigger&&t!=h&&t.nocheck!==!0&&t.chkDisabled!==!0&&e.treeObj.trigger(S.event.CHECK,[null,e.treeId,t]))}}},b={tools:f,view:g,event:C,data:l};e.extend(!0,h.consts,t),e.extend(!0,h._z,b);var p=h,v=p._z.tools,S=p.consts,_=p._z.view,N=p._z.data,E=(p._z.event,v.$);N.nodeChecked=function(e,t,c){if(!t)return!1;var h=e.data.key.checked;return"undefined"!=typeof c&&("string"==typeof c&&(c=v.eqs(c,"true")),c=!!c,t[h]=c),t[h]},N.exSetting(c),N.addInitBind(i),N.addInitUnBind(r),N.addInitCache(n),N.addInitNode(o),N.addInitProxy(d,!0),N.addInitRoot(a),N.addBeforeA(k),N.addZTreeTools(s);var T=_.createNodes;_.createNodes=function(e,t,c,h,a){T&&T.apply(_,arguments),c&&_.repairParentChkClassWithSelf(e,h)};var y=_.removeNode;_.removeNode=function(e,t){var c=t.getParentNode();y&&y.apply(_,arguments),t&&c&&(_.repairChkClass(e,c),_.repairParentChkClass(e,c))};var D=_.appendNodes;_.appendNodes=function(e,t,c,h,a,n,i){var r="";return D&&(r=D.apply(_,arguments)),h&&N.makeChkFlag(e,h),r}}(a),t=h,e(c,t)});
//# sourceMappingURL=src/maps/jquery_ztree_excheck.js.map

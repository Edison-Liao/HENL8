{"version":3,"sources":["common.js"],"names":["_defineProperty","obj","key","value","Object","defineProperty","enumerable","configurable","writable","_typeof","Symbol","iterator","constructor","prototype","layui","define","exports","$","layer","title","laytpl","setter","view","admin","commonFunction","getTreeNodeName","treeData","id","name","i","length","Id","children","isDisableButton","el","isDisable","addClass","attr","removeClass","removeAttr","isDisableElment","showtips","mouseenter","e","tips","this","data","mouseleave","closeAll","getTimeOffset","d1","Date","toUTCString","Math","floor","getTime","getRequest","webside","undefined","url","location","search","theRequest","indexOf","num","str","substr","strs","split","formatRequertDate","console","log","trimDate","trim","join","setSessionStorage","sessionStorage","setItem","JSON","stringify","Exception","msg","ajaxFun","method","option","_option","loading","successText","errorText","headers","Accept","Content-Type","X-Requested-With","Authorization","getItem","baseUrl","extend","load","dtd","Deferred","reject","statusText","toUpperCase","ajaxReq","_transport","ajax","dataType","timeout","crossDomain","hrFields","withCredentials","success","textStatus","jqXHR","close","resolve","error","errorThrown","checkHttpStatus","status","icon","promise","codeMessage","200","201","202","204","400","401","403","404","406","410","422","500","502","503","504","555","window","appResult","isSucceeded","appResultJson","IsSucceed","loadErrorText","ErrorText","isArray","Errors","Message","text","result","Succeeded","Result","findObjectByKeyVal","val","hasOwnProperty","found"],"mappings":"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","file":"../../common.js","sourcesContent":["/*\r\n * @Author: hongChuan Zhang\r\n * @Date: 2018-11-1 10:52:42\r\n * @Last Modified by: hongChuan Zhang\r\n * @Last Modified time: 2018-11-16 14:05:32\r\n */\r\n\r\nlayui.define(function(exports) {\r\n  var $ = layui.$,\r\n    layer = layui.layer,\r\n    laytpl = layui.laytpl,\r\n    setter = layui.setter,\r\n    view = layui.view,\r\n    admin = layui.admin;\r\n  //公共业务的逻辑处理可以写在此处，切换任何页面都会执行\r\n  /**\r\n   * @description\r\n   */\r\n  var title = \"暂无数据\";\r\n  var commonFunction = {\r\n    //树形结构查询 '2d765b20-a14e'=>'张三'\r\n    getTreeNodeName: function(treeData, id, name) {\r\n      for (var i = 0; i < treeData.length; i++) {\r\n        // if (title !== \"暂无数据\") {\r\n        //   break; //跳出循环\r\n        // }\r\n        if (treeData[i].Id === id) {\r\n          title = treeData[i][name];\r\n          return title;\r\n          break;\r\n        } else if (treeData[i].children.length > 0) {\r\n          commonFunction.getTreeNodeName(treeData[i].children, id, name);\r\n        } else {\r\n          continue;\r\n        }\r\n      }\r\n      return title;\r\n    },\r\n    //按钮禁用与反\r\n    isDisableButton: function(el, isDisable) {\r\n      if (isDisable) {\r\n        $(\"body \" + el)\r\n          .addClass(\"layui-btn-disabled\")\r\n          .addClass(\"layui-btn-primary\")\r\n          .attr(\"disabled\", \"true\");\r\n      } else {\r\n        $(\"body \" + el)\r\n          .removeClass(\"layui-btn-disabled\")\r\n          .removeAttr(\"disabled\");\r\n      }\r\n    },\r\n    isDisableElment: function(el, isDisable) {\r\n      if (isDisable) {\r\n        $(el)\r\n          .addClass(\"layui-btn-disabled\")\r\n          .addClass(\"layui-btn-primary\")\r\n          .attr(\"disabled\", \"true\");\r\n      } else {\r\n        $(\"body \" + el)\r\n          .removeClass(\"layui-btn-disabled\")\r\n          .removeAttr(\"disabled\");\r\n      }\r\n    },\r\n    //吸附弹出层\r\n    showtips: function(el) {\r\n      $(el)\r\n        .mouseenter(function(e) {\r\n          layer.tips($(this).data(\"tips\"), $(this), {\r\n            tips: [1, \"#363636\"]\r\n          });\r\n        })\r\n        .mouseleave(function(e) {\r\n          layer.closeAll(\"tips\");\r\n        });\r\n    },\r\n    //获取当前时间偏移量\r\n    getTimeOffset: function() {\r\n      const d1 = new Date();\r\n      d1.toUTCString();\r\n      return Math.floor(d1.getTime() / 1000);\r\n    },\r\n    //获取网址url后参数信息?name='张三'&age=14=>{name:张三,age:14}\r\n    getRequest: function(webside) {\r\n      // 接收一个url 如果没有参数则获取本地网址\r\n      if (webside == undefined) {\r\n        var url = location.search; // 获取本地url中\"?\"符后的字串\r\n      } else {\r\n        var url = webside;\r\n        var theRequest = new Object();\r\n        if (url.indexOf(\"?\") != -1) {\r\n          const num = url.indexOf(\"?\");\r\n          const str = url.substr(num + 1);\r\n          strs = str.split(\"&\"); // 分割为数组\r\n          for (let i = 0; i < strs.length; i++) {\r\n            // 循环创建对象\r\n            theRequest[strs[i].split(\"=\")[0]] = strs[i].split(\"=\")[1];\r\n          }\r\n        }\r\n      }\r\n      return theRequest;\r\n    },\r\n    //时间 格式化 2018-11-11=>20181111\r\n    formatRequertDate: function(data) {\r\n      if (typeof data !== \"string\" || data.length > 1) {\r\n        console.log(\"时间格式不符合规范\");\r\n        return \"\";\r\n      }\r\n      var trimDate = $.trim(data);\r\n      return trimDate.split(\"-\").join(\"\");\r\n    },\r\n    setSessionStorage: function(key, data) {\r\n      try {\r\n        if (typeof data === \"object\") {\r\n          sessionStorage.setItem(key, JSON.stringify(data));\r\n        } else {\r\n          sessionStorage.setItem(key, data);\r\n        }\r\n      } catch (Exception) {\r\n        console.log(\"超出本地存储限额！\");\r\n        layer.msg(\"存储数据失败!\");\r\n        return false;\r\n      }\r\n    }\r\n  };\r\n\r\n  //ajax 简单封装\r\n  var ajaxFun = function(method, url, data, option) {\r\n    var _option = {\r\n      loading: true, //是否开启loading 框\r\n      successText: \"\",\r\n      errorText: \"\",\r\n      headers: {\r\n        Accept: \"application/json\",\r\n        \"Content-Type\": \"application/json\",\r\n        \"X-Requested-With\": \"XMLHttpRequest\", // 用于判断是否为ajax请求\r\n        Authorization: `Bearer ${sessionStorage.getItem(\"access_token\")}` //token\r\n      },\r\n      baseUrl: layui.setter.baseUrl\r\n    };\r\n\r\n    $.extend(_option, option);\r\n    var load = \"\";\r\n    //设置Promise\r\n    var dtd = $.Deferred();\r\n    if (typeof method !== \"string\") {\r\n      layer.msg(\"请求方法不正确!\");\r\n      return dtd.reject({ statusText: \"请求方法不正确!\" });\r\n    }\r\n    if (typeof url !== \"string\") {\r\n      layer.msg(\"缺少请求地址!\");\r\n      return dtd.reject({ statusText: \"缺少请求地址!\" });\r\n    }\r\n    if (_option.loading) {\r\n      if (method.toUpperCase() === \"GET\") {\r\n        load = layer.load(2);\r\n      } else {\r\n        load = layer.load(3);\r\n      }\r\n    }\r\n    var ajaxReq = {\r\n      _transport: function(method, url, data, _option) {\r\n        $.ajax({\r\n          url: _option.baseUrl + url,\r\n          method: method.toUpperCase(),\r\n          dataType: \"json\",\r\n          timeout: 2500,\r\n          data: data,\r\n          crossDomain: true,\r\n          hrFields: {\r\n            withCredentials: true\r\n          },\r\n          headers: _option.headers,\r\n          success: function(data, textStatus, jqXHR) {\r\n            layer.close(load);\r\n            dtd.resolve(data == \"[]\" ? null : data, textStatus, jqXHR);\r\n          },\r\n          // complete: function(jqxhr) {\r\n          //   console.log(jqxhr, \"~~~~\");\r\n          // },\r\n          error: function(jqXHR, textStatus, errorThrown) {\r\n            layer.close(load);\r\n            //捕获状态码子\r\n            ajaxReq.checkHttpStatus(jqXHR.status);\r\n            if (_option.errorText.length > 0 && _option.loading) {\r\n              layer.msg(_option.errorText + jqXHR.status, { icon: 5 });\r\n            } else if (_option.loading) {\r\n              layer.msg(\"数据操作失败!\" + jqXHR.status, { icon: 5 });\r\n            }\r\n            dtd.reject(jqXHR, textStatus, errorThrown);\r\n          }\r\n        });\r\n        return dtd.promise();\r\n      },\r\n      checkHttpStatus: function(status) {\r\n        var codeMessage = {\r\n          200: \"服务器成功返回请求的数据\",\r\n          201: \"新建或修改数据成功。\",\r\n          202: \"一个请求已经进入后台排队（异步任务）\",\r\n          204: \"删除数据成功。\",\r\n          400: \"发出的请求有错误，服务器没有进行新建或修改数据的操作。\",\r\n          401: \"用户没有权限（或者登录令牌过期）。\",\r\n          403: \"用户得到授权，但是访问是被禁止的。\",\r\n          404: \"发出的请求针对的是不存在的记录，服务器没有进行操作\",\r\n          406: \"请求的格式不可得。\",\r\n          410: \"请求的资源被永久删除，且不会再得到的。\",\r\n          422: \"当创建一个对象时，发生一个验证错误。\",\r\n          500: \"服务器发生错误，请检查服务器\",\r\n          502: \"网关错误\",\r\n          503: \"服务不可用，服务器暂时过载或维护\",\r\n          504: \"网关超时\",\r\n          555: \"网络请求错误\"\r\n        };\r\n        if (status == 401) {\r\n          layer.msg(codeMessage.status, function() {\r\n            //关闭后的操作\r\n            window.location = \"../../login.html\";\r\n          });\r\n        }\r\n        //其余判断...\r\n      }\r\n    };\r\n    return ajaxReq._transport(method, url, data, _option);\r\n  };\r\n  //ajax 返回结果判断\r\n  var appResult = {\r\n    //判断是否为成功状态\r\n    isSucceeded: function(appResultJson) {\r\n      if (appResultJson == undefined || appResultJson.IsSucceed == undefined) {\r\n        return false;\r\n      }\r\n\r\n      return appResultJson.IsSucceed;\r\n    },\r\n    //错误文本\r\n    loadErrorText: function(appResultJson, ErrorText) {\r\n      if ($.isArray(appResultJson.Errors) && appResultJson.Errors.length > 0) {\r\n        layer.msg(appResultJson.Errors[0].Message, { icon: 5 });\r\n      } else {\r\n        var text = ErrorText ? ErrorText : \"数据操作失败!状态:未知\";\r\n        layer.msg(text, { icon: 5 });\r\n      }\r\n    },\r\n    // 正确返回的数据\r\n    result: function(appResultJson) {\r\n      if (appResultJson == undefined || appResultJson.Succeeded == undefined)\r\n        return null;\r\n      if (this.isSucceeded(appResultJson)) return appResultJson.Result;\r\n      return null;\r\n    }\r\n  };\r\n\r\n  var findObjectByKeyVal = function(obj, key, val) {\r\n    if (!obj || typeof obj === \"string\") {\r\n      return null;\r\n    }\r\n    if (obj[key] === val) {\r\n      return obj;\r\n    }\r\n\r\n    for (var i in obj) {\r\n      if (obj.hasOwnProperty(i)) {\r\n        var found = findObjectByKeyVal(obj[i], key, val);\r\n        if (found) {\r\n          return found;\r\n        }\r\n      }\r\n    }\r\n    return null;\r\n  };\r\n  //对外暴露的接口\r\n  exports(\r\n    \"common\",\r\n    $.extend(\r\n      commonFunction,\r\n      { ajaxFun: ajaxFun },\r\n      { appResult, appResult },\r\n      { findObjectByKeyVal: findObjectByKeyVal }\r\n    )\r\n  );\r\n});\r\n"]}
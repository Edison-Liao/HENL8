{"version":3,"sources":["common.js"],"names":["_defineProperty","obj","key","value","Object","defineProperty","enumerable","configurable","writable","_typeof","Symbol","iterator","constructor","prototype","layui","define","exports","$","layer","title","laytpl","setter","view","admin","commonFunction","getTreeNodeName","treeData","id","name","i","length","Id","children","isDisableButton","el","isDisable","addClass","attr","removeClass","removeAttr","showtips","mouseenter","e","tips","this","data","mouseleave","closeAll","getTimeOffset","d1","Date","toUTCString","Math","floor","getTime","getRequest","webside","undefined","url","location","search","theRequest","indexOf","num","str","substr","strs","split","formatRequertDate","console","log","trimDate","trim","join","setSessionStorage","sessionStorage","setItem","JSON","stringify","Exception","msg","ajaxFun","method","option","_option","loading","successText","errorText","headers","Accept","Content-Type","X-Requested-With","Authorization","getItem","baseUrl","extend","load","dtd","Deferred","reject","statusText","toUpperCase","ajaxReq","_transport","ajax","dataType","timeout","crossDomain","hrFields","withCredentials","success","textStatus","jqXHR","close","resolve","error","errorThrown","status","icon","promise","appResult","isSucceeded","appResultJson","IsSucceed","loadErrorText","ErrorText","isArray","Errors","Message","text","result","Succeeded","Result","findObjectByKeyVal","val","hasOwnProperty","found"],"mappings":"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","file":"../../common.js","sourcesContent":["layui.define(function(exports) {\r\n  var $ = layui.$,\r\n    layer = layui.layer,\r\n    laytpl = layui.laytpl,\r\n    setter = layui.setter,\r\n    view = layui.view,\r\n    admin = layui.admin;\r\n  //公共业务的逻辑处理可以写在此处，切换任何页面都会执行\r\n  /**\r\n   * @description\r\n   */\r\n  var title = \"暂无数据\";\r\n  var commonFunction = {\r\n    //树形结构查询 '2d765b20-a14e'=>'张三'\r\n    getTreeNodeName: function(treeData, id, name) {\r\n      for (var i = 0; i < treeData.length; i++) {\r\n        // if (title !== \"暂无数据\") {\r\n        //   break; //跳出循环\r\n        // }\r\n        if (treeData[i].Id === id) {\r\n          title = treeData[i][name];\r\n          return title;\r\n          break;\r\n        } else if (treeData[i].children.length > 0) {\r\n          commonFunction.getTreeNodeName(treeData[i].children, id, name);\r\n        } else {\r\n          continue;\r\n        }\r\n      }\r\n      return title;\r\n    },\r\n    //按钮禁用与反\r\n    isDisableButton: function(el, isDisable) {\r\n      if (isDisable) {\r\n        $(\"body \" + el)\r\n          .addClass(\"layui-btn-disabled\")\r\n          .addClass(\"layui-btn-primary\")\r\n          .attr(\"disabled\", \"true\");\r\n      } else {\r\n        $(\"body \" + el)\r\n          .removeClass(\"layui-btn-disabled\")\r\n          .removeAttr(\"disabled\");\r\n      }\r\n    },\r\n    //吸附弹出层\r\n    showtips: function(el) {\r\n      $(el)\r\n        .mouseenter(function(e) {\r\n          layer.tips($(this).data(\"tips\"), $(this), {\r\n            tips: [1, \"#363636\"]\r\n          });\r\n        })\r\n        .mouseleave(function(e) {\r\n          layer.closeAll(\"tips\");\r\n        });\r\n    },\r\n    //获取当前时间偏移量\r\n    getTimeOffset: function() {\r\n      const d1 = new Date();\r\n      d1.toUTCString();\r\n      return Math.floor(d1.getTime() / 1000);\r\n    },\r\n    //获取网址url后参数信息?name='张三'&age=14=>{name:张三,age:14}\r\n    getRequest: function(webside) {\r\n      // 接收一个url 如果没有参数则获取本地网址\r\n      if (webside == undefined) {\r\n        var url = location.search; // 获取本地url中\"?\"符后的字串\r\n      } else {\r\n        var url = webside;\r\n        var theRequest = new Object();\r\n        if (url.indexOf(\"?\") != -1) {\r\n          const num = url.indexOf(\"?\");\r\n          const str = url.substr(num + 1);\r\n          strs = str.split(\"&\"); // 分割为数组\r\n          for (let i = 0; i < strs.length; i++) {\r\n            // 循环创建对象\r\n            theRequest[strs[i].split(\"=\")[0]] = strs[i].split(\"=\")[1];\r\n          }\r\n        }\r\n      }\r\n      return theRequest;\r\n    },\r\n    //时间 格式化 2018-11-11=>20181111\r\n    formatRequertDate: function(data) {\r\n      if (typeof data !== \"string\" || data.length > 1) {\r\n        console.log(\"时间格式不符合规范\");\r\n        return \"\";\r\n      }\r\n      var trimDate = $.trim(data);\r\n      return trimDate.split(\"-\").join(\"\");\r\n    },\r\n    setSessionStorage: function(key, data) {\r\n      try {\r\n        if (typeof data === \"object\") {\r\n          sessionStorage.setItem(key, JSON.stringify(data));\r\n        } else {\r\n          sessionStorage.setItem(key, data);\r\n        }\r\n      } catch (Exception) {\r\n        console.log(\"超出本地存储限额！\");\r\n        layer.msg(\"存储数据失败!\");\r\n        return false;\r\n      }\r\n    }\r\n  };\r\n\r\n  //ajax 简单封装\r\n  var ajaxFun = function(method, url, data, option) {\r\n    var _option = {\r\n      loading: true, //是否开启loading 框\r\n      successText: \"\",\r\n      errorText: \"\",\r\n      headers: {\r\n        Accept: \"application/json\",\r\n        \"Content-Type\": \"application/json\",\r\n        \"X-Requested-With\": \"XMLHttpRequest\", // 用于判断是否为ajax请求\r\n        Authorization: `Bearer ${sessionStorage.getItem(\"access_token\")}` //token\r\n      },\r\n      baseUrl: layui.setter.baseUrl\r\n    };\r\n\r\n    $.extend(_option, option);\r\n    var load = \"\";\r\n    //设置Promise\r\n    var dtd = $.Deferred();\r\n    if (typeof method !== \"string\") {\r\n      layer.msg(\"请求方法不正确!\");\r\n      return dtd.reject({ statusText: \"请求方法不正确!\" });\r\n    }\r\n    if (typeof url !== \"string\") {\r\n      layer.msg(\"缺少请求地址!\");\r\n      return dtd.reject({ statusText: \"缺少请求地址!\" });\r\n    }\r\n    if (_option.loading) {\r\n      if (method.toUpperCase() === \"GET\") {\r\n        load = layer.load(2);\r\n      } else {\r\n        load = layer.load(3);\r\n      }\r\n    }\r\n    var ajaxReq = {\r\n      _transport: function(method, url, data, _option) {\r\n        console.log(data);\r\n        $.ajax({\r\n          url: _option.baseUrl + url,\r\n          method: method.toUpperCase(),\r\n          dataType: \"json\",\r\n          timeout: 2500,\r\n          data: data,\r\n          crossDomain: true,\r\n          hrFields: {\r\n            withCredentials: true\r\n          },\r\n          headers: _option.headers,\r\n          success: function(data, textStatus, jqXHR) {\r\n            layer.close(load);\r\n            dtd.resolve(data == \"[]\" ? null : data, textStatus, jqXHR);\r\n          },\r\n          error: function(jqXHR, textStatus, errorThrown) {\r\n            layer.close(load);\r\n            //捕获状态码子\r\n            if (_option.errorText.length > 0 && _option.loading) {\r\n              layer.msg(_option.errorText + jqXHR.status, { icon: 5 });\r\n            } else if (_option.loading) {\r\n              layer.msg(\"数据操作失败!\" + jqXHR.status, { icon: 5 });\r\n            }\r\n            dtd.reject(jqXHR, textStatus, errorThrown);\r\n            //  epd.ui.toast(epd.textError);\r\n          }\r\n        });\r\n        return dtd.promise();\r\n      }\r\n    };\r\n    return ajaxReq._transport(method, url, data, _option);\r\n  };\r\n  //ajax 返回结果判断\r\n  var appResult = {\r\n    //判断是否为成功状态\r\n    isSucceeded: function(appResultJson) {\r\n      if (appResultJson == undefined || appResultJson.IsSucceed == undefined) {\r\n        return false;\r\n      }\r\n\r\n      return appResultJson.IsSucceed;\r\n    },\r\n    //错误文本\r\n    loadErrorText: function(appResultJson, ErrorText) {\r\n      if ($.isArray(appResultJson.Errors) && appResultJson.Errors.length > 0) {\r\n        layer.msg(appResultJson.Errors[0].Message, { icon: 5 });\r\n      } else {\r\n        var text = ErrorText ? ErrorText : \"数据操作失败!状态:未知\";\r\n        layer.msg(text, { icon: 5 });\r\n      }\r\n    },\r\n    // 正确返回的数据\r\n    result: function(appResultJson) {\r\n      if (appResultJson == undefined || appResultJson.Succeeded == undefined)\r\n        return null;\r\n      if (this.isSucceeded(appResultJson)) return appResultJson.Result;\r\n      return null;\r\n    }\r\n  };\r\n\r\n  var findObjectByKeyVal = function(obj, key, val) {\r\n    if (!obj || typeof obj === \"string\") {\r\n      return null;\r\n    }\r\n    if (obj[key] === val) {\r\n      return obj;\r\n    }\r\n\r\n    for (var i in obj) {\r\n      if (obj.hasOwnProperty(i)) {\r\n        var found = findObjectByKeyVal(obj[i], key, val);\r\n        if (found) {\r\n          return found;\r\n        }\r\n      }\r\n    }\r\n    return null;\r\n  };\r\n  //对外暴露的接口\r\n  exports(\r\n    \"common\",\r\n    $.extend(\r\n      commonFunction,\r\n      { ajaxFun: ajaxFun },\r\n      { appResult, appResult },\r\n      { findObjectByKeyVal: findObjectByKeyVal }\r\n    )\r\n  );\r\n});\r\n"]}
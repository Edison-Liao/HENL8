{"version":3,"sources":["login.js"],"names":["layui","config","base","extend","index","use","user","$","consts","setter","admin","form","router","manager","search","Oidc","UserManager","userManagerConfig","events","addAccessTokenExpiring","console","log","addAccessTokenExpired","addSilentRenewError","e","message","addUserLoaded","loadedUser","getUser","then","res","signinSilentCallback","signinRedirectCallback","data","window","location","href","error","on","signoutPopupCallback","clearStaleState","signoutRedirect","state","resp","err","signinRedirect","layer","msg","icon"],"mappings":"AAAAA,MACGC,QACCC,KAAM,sBAEPC,QACCC,MAAO,cAERC,KAAK,QAAS,SAAU,UAAW,WAClC,GAUIC,GAVAC,EAAIP,MAAMO,EAIZC,GAHSR,MAAMS,OACPT,MAAMU,MACPV,MAAMW,KACJX,MAAMQ,QACfI,EAASZ,MAAMY,SAIbC,GAHOD,EAAOE,OAGJ,GAAIC,MAAKC,YAAYR,EAAOS,mBAM1CJ,GAAQK,OAAOC,uBAAuB,WACpCC,QAAQC,IAAI,oBAEdR,EAAQK,OAAOI,sBAAsB,WACnCF,QAAQC,IAAI,mBAGdR,EAAQK,OAAOK,oBAAoB,SAASC,GAC1CJ,QAAQC,IAAI,qBAAsBG,EAAEC,WAEtCZ,EAAQK,OAAOQ,cAAc,SAASC,GACpCrB,EAAOqB,EACPd,EAAQe,UAAUC,KAAK,SAASC,GAC9BV,QAAQC,IAAIS,EAAK,yDAIrB,GAAIf,MAAKC,aAAce,uBACvBlB,EACGe,UACAC,KAAK,SAASvB,GACbc,QAAQC,IAAIf,EAAM,UAHtBO,SAKS,SAAAW,GACLJ,QAAQC,IAAIG,EAAG,UAGnBX,EACGmB,uBAAuB,SAASC,GAC/Bb,QAAQC,IAAIY,GACZC,OAAOC,SAASC,KAAO,iBAH3BvB,SAKS,SAASwB,GACdjB,QAAQC,IAAI,UAAWgB,KAE3B9B,EAAE,UAAU+B,GAAG,QAAS,WAEtBzB,EAAQ0B,sBAAqB,GAC7B1B,EAAQ2B,kBACR3B,EACG4B,iBAAkBC,MAAO,cACzBb,KAAK,SAASc,GAEbtB,IAAI,aAAcsB,KAJtB9B,SAMS,SAAS+B,GACdvB,IAAIuB,OAGVrC,EAAE,UAAU+B,GAAG,QAAS,WACtBzB,EACGgC,gBAAiBH,MAAO,aACxBb,KAAK,WACJT,QAAQC,IAAI,yBAHhBR,SAKS,SAAS+B,GACdE,MAAMC,IAAI,WAAaC,KAAM,IAC7B5B,QAAQC,IAAIuB","file":"../../login.js","sourcesContent":["layui\r\n  .config({\r\n    base: \"../../layuiadmin/\" //静态资源所在路径\r\n  })\r\n  .extend({\r\n    index: \"lib/index\" //主入口模块\r\n  })\r\n  .use([\"index\", \"cookie\", \"consts\"], function() {\r\n    var $ = layui.$,\r\n      setter = layui.setter,\r\n      admin = layui.admin,\r\n      form = layui.form,\r\n      consts = layui.consts,\r\n      router = layui.router(),\r\n      search = router.search;\r\n    // form.render();\r\n\r\n    var manager = new Oidc.UserManager(consts.userManagerConfig);\r\n    var user;\r\n    ///////////////////////////////\r\n    //event 事件\r\n    ///////////////////////////////\r\n\r\n    manager.events.addAccessTokenExpiring(function() {\r\n      console.log(\"token expiring\");\r\n    });\r\n    manager.events.addAccessTokenExpired(function() {\r\n      console.log(\"token expired\");\r\n    });\r\n\r\n    manager.events.addSilentRenewError(function(e) {\r\n      console.log(\"silent renew error\", e.message);\r\n    });\r\n    manager.events.addUserLoaded(function(loadedUser) {\r\n      user = loadedUser;\r\n      manager.getUser().then(function(res) {\r\n        console.log(res, \"getUser loaded user after userLoaded event fired\");\r\n      });\r\n    });\r\n    //event 事件结束\r\n    new Oidc.UserManager().signinSilentCallback();\r\n    manager\r\n      .getUser()\r\n      .then(function(user) {\r\n        console.log(user, \"用户信息\");\r\n      })\r\n      .catch(e => {\r\n        console.log(e, \"错误信息\");\r\n      });\r\n\r\n    manager\r\n      .signinRedirectCallback(function(data) {\r\n        console.log(data);\r\n        window.location.href = \"./index.html\";\r\n      })\r\n      .catch(function(error) {\r\n        console.log(\"捕获到目前信息\", error);\r\n      });\r\n    $(\".clear\").on(\"click\", function() {\r\n      // true param will keep popup window open\r\n      manager.signoutPopupCallback(true);\r\n      manager.clearStaleState();\r\n      manager\r\n        .signoutRedirect({ state: \"some data\" })\r\n        .then(function(resp) {\r\n          //mgr.signoutRedirect().then(function(resp) {\r\n          log(\"signed out\", resp);\r\n        })\r\n        .catch(function(err) {\r\n          log(err);\r\n        });\r\n    });\r\n    $(\".login\").on(\"click\", function() {\r\n      manager\r\n        .signinRedirect({ state: \"HL8_SASS\" })\r\n        .then(function() {\r\n          console.log(\"signinRedirect done\");\r\n        })\r\n        .catch(function(err) {\r\n          layer.msg(\"授权登录出错!\", { icon: 5 });\r\n          console.log(err);\r\n        });\r\n    });\r\n  });\r\n"]}
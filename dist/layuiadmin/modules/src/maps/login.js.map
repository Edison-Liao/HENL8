{"version":3,"sources":["login.js"],"names":["layui","config","base","extend","index","use","$","setter","router","admin","form","search","console","log","protocol","window","location","local","hostname","port","user","userManagerConfig","authority","authorityUrl","client_id","automaticSilentRenew","popup_redirect_uri","post_logout_redirect_uri","redirect_uri","response_type","scope","filterProtocolClaims","loadUserInfo","manager","Oidc","UserManager","events","addUserLoaded","loadedUser","href","signinRedirectCallback","data","error","on","signoutPopupCallback","clearStaleState","signoutRedirectCallback","signoutRedirect","signinRedirect"],"mappings":"AAAAA,MACGC,QACCC,KAAM,sBAEPC,QACCC,MAAO,cAERC,KAAK,QAAS,UAAW,WACxB,GAAIC,GAAIN,MAAMM,EACZC,EAASP,MAAMO,OAGfC,GAFQR,MAAMS,MACPT,MAAMU,KACJV,MAAMQ,SACNA,GAAOG,MAElBC,SAAQC,KAR2B,IAS3BC,GAAaC,OAAOC,SAApBF,SACFG,EAAQF,OAAOC,SAASE,SACtBC,EAASJ,OAAOC,SAAhBG,IACRP,SAAQC,IAAIC,EAAUG,EAAOE,EAAM,OAEnC,IAcIC,GAdEC,GACJC,UAAWf,EAAOgB,aAClBC,UAAW,KACXC,sBAAsB,EACtBC,mBAAuBZ,EAAvB,KAAoCG,EAApC,IAA6CE,EAE7CQ,yBAA6Bb,EAA7B,KAA0CG,EAA1C,IAAmDE,EAAnD,cACAS,aAAiBd,EAAjB,KAA8BG,EAA9B,IAAuCE,EACvCU,cAAe,iBACfC,MAAO,sBACPC,sBAAsB,EACtBC,cAAc,GAEZC,EAAU,GAAIC,MAAKC,YAAYd,EAEnCY,GAAQG,OAAOC,cAAc,SAASC,GACpClB,EAAOkB,EACP1B,QAAQC,IAAIO,EAAM,QAClBL,OAAOC,SAASuB,KAAO,iBAEzBN,EACGO,uBAAuB,SAASC,GAC/B1B,OAAOC,SAASuB,KAAO,iBAF3BN,SAIS,SAASS,GACd9B,QAAQC,IAAI,UAAW6B,KAE3BpC,EAAE,UAAUqC,GAAG,QAAS,WAEtBV,EAAQW,sBAAqB,GAC7BX,EAAQY,kBACRZ,EAAQa,wBAAwB,SAASL,GACvC7B,QAAQC,IAAI4B,EAAM,QAEpBR,EAAQc,gBAAgB,SAASN,GAC/B7B,QAAQC,IAAI4B,EAAM,UAGtBnC,EAAE,UAAUqC,GAAG,QAAS,WACtBV,EACGe,eAAe,SAASP,GACvB7B,QAAQC,IAAI4B,KAFhBR,SAIS,SAASS,GACd9B,QAAQ8B,MAAM,2CAA4CA","file":"../../login.js","sourcesContent":["layui\r\n  .config({\r\n    base: \"../../layuiadmin/\" //静态资源所在路径\r\n  })\r\n  .extend({\r\n    index: \"lib/index\" //主入口模块\r\n  })\r\n  .use([\"index\", \"cookie\"], function() {\r\n    var $ = layui.$,\r\n      setter = layui.setter,\r\n      admin = layui.admin,\r\n      form = layui.form,\r\n      router = layui.router(),\r\n      search = router.search;\r\n    // form.render();\r\n    console.log();\r\n    const { protocol } = window.location; // http:\r\n    const local = window.location.hostname; // 192.168.5.191\r\n    const { port } = window.location; // 8000\r\n    console.log(protocol, local, port, \"地址信息\");\r\n\r\n    const userManagerConfig = {\r\n      authority: setter.authorityUrl, //认证服务器\r\n      client_id: \"js\", // 客户端标示\r\n      automaticSilentRenew: true,\r\n      popup_redirect_uri: `${protocol}//${local}:${port}`, // 重定向目标\r\n      // response_type: 'id_token',\r\n      post_logout_redirect_uri: `${protocol}//${local}:${port}/user/login`, // 退出URL\r\n      redirect_uri: `${protocol}//${local}:${port}`,\r\n      response_type: \"id_token token\",\r\n      scope: \"openid profile api1\",\r\n      filterProtocolClaims: true,\r\n      loadUserInfo: true\r\n    };\r\n    var manager = new Oidc.UserManager(userManagerConfig);\r\n    var user;\r\n    manager.events.addUserLoaded(function(loadedUser) {\r\n      user = loadedUser;\r\n      console.log(user, \"登录信息\");\r\n      window.location.href = \"./index.html\";\r\n    });\r\n    manager\r\n      .signinRedirectCallback(function(data) {\r\n        window.location.href = \"./index.html\";\r\n      })\r\n      .catch(function(error) {\r\n        console.log(\"捕获到目前信息\", error);\r\n      });\r\n    $(\".clear\").on(\"click\", function() {\r\n      // true param will keep popup window open\r\n      manager.signoutPopupCallback(true);\r\n      manager.clearStaleState();\r\n      manager.signoutRedirectCallback(function(data) {\r\n        console.log(data, \"退出\");\r\n      });\r\n      manager.signoutRedirect(function(data) {\r\n        console.log(data, \"退出\");\r\n      });\r\n    });\r\n    $(\".login\").on(\"click\", function() {\r\n      manager\r\n        .signinRedirect(function(data) {\r\n          console.log(data);\r\n        })\r\n        .catch(function(error) {\r\n          console.error(\"error while logging in through the popup\", error);\r\n        });\r\n    });\r\n  });\r\n"]}
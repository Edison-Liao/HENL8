{"version":3,"sources":["readmeterplan/readmeterplan.js"],"names":["layui","config","base","extend","index","use","$","form","common","table","consts","layer","haderSerch","data","key","option","baseUrl","setter","revenueUrl","chongxinguihua","renderTable","render","elem","id","url","where","Method","parseData","request","page","cols","field","title","templet","d","Me","Name","ksrq","jsrq","ReadMeterPlanZTBZNAME","util","toDateString","ModifyDate","loading","limit","text","none","tabelNoneText","add","closeAll","dataBean","basePostData","Data","str1","JSON","stringify","console","log","ajaxFun","then","res","appResult","isSucceeded","find","each","this","val","reload","msg","icon","loadErrorText","fail","err","active","open","type","content","maxmin","area","btn","yes","layero","submit","on","Idd","Result","info","trigger","formatRequertDate","Datetime","split","Data.Key","Data.PageIndex","Data.PageSize","call"],"mappings":"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","file":"../../../readmeterplan/readmeterplan.js","sourcesContent":["layui\r\n  .config({\r\n    base: \"../../../layuiadmin/\" //静态资源所在路径\r\n  })\r\n  .extend({\r\n    index: \"lib/index\" //主入口模块\r\n  })\r\n  .use([\"index\", \"table\", \"layer\", \"common\", \"consts\", \"haderSerch\"], function () {\r\n    var $ = layui.$,\r\n      form = layui.form,\r\n      common = layui.common,\r\n      table = layui.table,\r\n      consts = layui.consts,\r\n      layer = layui.layer;\r\n    layui.haderSerch(\"#readmeterplan-search\", {\r\n      data: [{\r\n        key: \"查询关键字\"\r\n      }]\r\n    });\r\n    var option = {\r\n      baseUrl: layui.setter.revenueUrl\r\n    }\r\n\r\n    var chongxinguihua = {\r\n        // getReadMeterPlan: function (id) {\r\n        //   common.ajaxFun(\"get\", \"api/ReadMeterPlan/query/key?Data.Id=\" + id + \"&Method=key\", \"\", option).then(function (res) {\r\n        //       if (common.appResult.isSucceeded(res)) {\r\n        //         console.log(res.Result)\r\n        //         res.Result.Me.Name\r\n        //       } else {\r\n        //         common.appResult.loadErrorText(res);\r\n        //       }\r\n        //     })\r\n        //     .fail(err => {\r\n        //       console.log(err);\r\n        //     });\r\n        // },\r\n        // getExport: function (id) {\r\n        //   common.ajaxFun(\"get\", \"/api/ReadMeterPlan/query/export\", \"\", option).then(function (res) {\r\n        //       console.log(res)\r\n        //       if (common.appResult.isSucceeded(res)) {\r\n        //         console.log(res.Result)\r\n        //       } else {\r\n        //         common.appResult.loadErrorText(res);\r\n        //       }\r\n        //     })\r\n        //     .fail(err => {\r\n        //       console.log(err);\r\n        //     });\r\n        // },\r\n        renderTable: function () {\r\n          table.render({\r\n            elem: \"#ReadMeterPlan\",\r\n            id: \"ReadMeterPlan\",\r\n            url: layui.setter.revenueUrl + \"/api/ReadMeterPlan/query/list\", //接口\r\n            where: {\r\n              \"Method\": \"list\"\r\n            },\r\n            parseData: layui.setter.parseData,\r\n            request: layui.setter.request,\r\n            page: true,\r\n            cols: [\r\n              [{\r\n                  field: \"ReadMeterPlanZTBZ\",\r\n                  title: \"计划代码\",\r\n                  templet: function (d) {\r\n                    return \"\";\r\n                  }\r\n                },\r\n                {\r\n                  field: \"ReadMeterPlanName\",\r\n                  title: \"计划名称\",\r\n                  templet: function (d) {\r\n                    return d.Me.Name;\r\n                  }\r\n                },\r\n                {\r\n                  field: \"ReadMeterPlanName\",\r\n                  title: \"抄表周期\",\r\n                  templet: function (d) {\r\n                    return \"\";\r\n                  }\r\n                },\r\n                {\r\n                  field: \"ReadMeterPlanKsrq\",\r\n                  title: \"计划开始时间\",\r\n                  templet: function (d) {\r\n                    return d.Me.ksrq;\r\n                  }\r\n                },\r\n                {\r\n                  field: \"ReadMeterPlanJsrq\",\r\n                  title: \"计划结束时间\",\r\n                  templet: function (d) {\r\n                    return d.Me.jsrq;\r\n                  }\r\n                },\r\n                {\r\n                  field: \"ReadMeterPlanZTBZNAME\",\r\n                  title: \"当前状态\",\r\n                  templet: function (d) {\r\n                    return d.Me.ReadMeterPlanZTBZNAME;\r\n                  }\r\n                },\r\n                {\r\n                  field: \"ReadMeterPlanModifyDate\",\r\n                  title: \"修改时间\",\r\n                  templet: function (d) {\r\n                    return layui.util.toDateString(d.Me.ModifyDate);\r\n                  }\r\n                },\r\n                // {title: \"操作\",fixed: 'right', align:'center', width:160,toolbar: '#LAY-dizhiTable-barOperation'}\r\n              ]\r\n            ],\r\n            loading: true,\r\n            limit: 10,\r\n            text: {\r\n              none: consts.tabelNoneText //默认：无数据。注：该属性为 layui 2.2.5 开始新增\r\n            }\r\n          });\r\n        },\r\n        add: function (data) {\r\n          layer.closeAll();\r\n          var dataBean = layui.consts.basePostData();\r\n          dataBean.Data = data;\r\n          dataBean.Method = \"insert\";\r\n          var str1 = JSON.stringify(dataBean);\r\n          console.log(str1);\r\n          common\r\n            .ajaxFun(\"post\", \"/api/ReadMeterPlan/insert\", str1, option)\r\n            .then(function (res) {\r\n              if (common.appResult.isSucceeded(res)) {\r\n                $(\"#lock-from\").find('input[type=text],select,input[type=hidden]').each(function () {\r\n                  $(this).val('');\r\n                });\r\n                table.reload(\"table-ReadMeterPlan\");\r\n                layer.msg(\"数据添加成功!\", {\r\n                  icon: 6\r\n                });\r\n              } else {\r\n                common.appResult.loadErrorText(res);\r\n              }\r\n            })\r\n            .fail(err => {\r\n              console.log(err);\r\n            });\r\n        },\r\n      },\r\n      active = {\r\n        add: function () {\r\n          layer.open({\r\n            type: 1,\r\n            title: \"添加地址\",\r\n            content: $('#lock-from'),\r\n            maxmin: true,\r\n            area: [\"800px\", \"500px\"],\r\n            btn: [\"确定\", \"取消\"],\r\n            yes: function (index, layero) {\r\n              var submit = $(\"#LAY-chaobiaojihua-add-submit\");\r\n\r\n              form.on('submit(LAY-chaobiaojihua-add-submit)', function (data) {\r\n                var field = data.field;\r\n                console.log(field)\r\n                common.ajaxFun(\"get\", \"/api/Common/GetInsertGuid\", \"\", option).then(function (res) {\r\n                    if (common.appResult.isSucceeded(res)) {\r\n                      field.Idd = res.Result;\r\n                      // field.AddressStatus = field.AddressStatus == \"on\" ? 1 : 2;\r\n                      // field.Area_Id_Building = field.Area_Id_Building == \"全部\" ? \"\" : field.Area_Id_Building\r\n                      // field.Area_Id_ReadingPoint = field.Area_Id_ReadingPoint == \"全部\" ? \"\" : field.Area_Id_ReadingPoint\r\n                      console.info(field)\r\n                      // if (field.ReadMeterPlanZTBZ == \"全部\") {\r\n                      //   layer.msg(\"请选择抄表计划状态\", {\r\n                      //     icon: 5\r\n                      //   });\r\n\r\n                      // } else {\r\n                      //   dizhiSeverEvent.add(field);\r\n                      // }\r\n                      chongxinguihua.add(field);\r\n\r\n                    } else {\r\n                      common.appResult.loadErrorText(res);\r\n                    }\r\n                  })\r\n                  .fail(err => {\r\n                    console.log(err);\r\n                  });\r\n              });\r\n              submit.trigger(\"click\");\r\n\r\n            }\r\n          });\r\n        }\r\n      }\r\n    //监听搜索\r\n    form.on(\"submit(searchbtn)\", function (data) {\r\n      var field = data.field;\r\n      console.log(field, \"搜索数据\");\r\n      var DatetimeBegin = common.formatRequertDate(\r\n        field.Datetime.split(\"~\")[0]\r\n      );\r\n      var DatetimeEnd = common.formatRequertDate(\r\n        field.Datetime.split(\"~\")[1]\r\n      );\r\n      table.reload(\"LAY-user-manage\", {\r\n        where: {\r\n          \"Data.Key\": field.key,\r\n          // \"Data.DatetimeBegin\": DatetimeBegin || \"20180511\",\r\n          \"Data.PageIndex\": 1,\r\n          \"Data.PageSize\": 10\r\n        }\r\n      });\r\n    });\r\n    // chongxinguihua.getReadMeterPlan(\"ba751bf5-5887-4a1f-8d85-cb3291351dbc\")\r\n    chongxinguihua.renderTable()\r\n\r\n    $(\".layui-btn.layuiadmin-btn-useradmin\").on(\"click\", function () {\r\n      var type = $(this).data(\"type\");\r\n      active[type] ? active[type].call(this) : \"\";\r\n    });\r\n  });\r\n"]}
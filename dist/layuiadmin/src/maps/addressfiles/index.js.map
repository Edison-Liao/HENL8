{"version":3,"sources":["addressfiles/index.js"],"names":["layui","config","base","extend","index","use","$","form","table","layer","getData","original","selected","on","data","field","console","log","reload","where","render","elem","url","setter","huibleUrl","parseData","request","cols","width","type","title","minWidth","templet","d","DeviceType","IsActived","util","toDateString","CreateDate","align","fixed","toolbar","loading","page","limit","text","done","res","curr","count","obj","checked","event","msg","confirm","icon","userSeverEvent","unActive","addMac","closeAll","load","shade","dataBean","basePostData","Data","str1","JSON","stringify","ajax","async","dataType","headers","Accept","Content-Type","success","IsSucceed","error","err","RegistId","Id","Errors","active","add","open","content","area","btn","yes","macData","Mac","val","Description","IsForce","MacStr","substr","length","btn2","layero","this","call"],"mappings":"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","file":"../../../addressfiles/index.js","sourcesContent":["layui\r\n  .config({\r\n    base: \"../../../layuiadmin/\" //静态资源所在路径\r\n  })\r\n  .extend({\r\n    index: \"lib/index\" //主入口模块\r\n  })\r\n  .use([\"index\", \"table\", \"layer\"], function() {\r\n    var $ = layui.$,\r\n      form = layui.form,\r\n      table = layui.table,\r\n      layer = layui.layer,\r\n      getData = {\r\n        original: [], // 通过接口获取的原始数据\r\n        selected: [] // 选中的数据\r\n      };\r\n\r\n    //监听搜索\r\n    form.on(\"submit(IccRegist-search)\", function(data) {\r\n      var field = data.field;\r\n      console.log(data, \"数据\");\r\n      //执行重载\r\n      table.reload(\"addressFilesTable\", {\r\n        where: field\r\n      });\r\n    });\r\n\r\n    //用户管理表格渲染\r\n    var addressFilesTable = table.render({\r\n      elem: \"#addressFilesTable\",\r\n      url: layui.setter.huibleUrl + \"/api/IccWchat/regist/search\", //接口\r\n      parseData: layui.setter.parseData,\r\n      request: layui.setter.request,\r\n      cols: [\r\n        [\r\n          {\r\n            width: 50,\r\n            type: \"checkbox\"\r\n          },\r\n          { field: \"DeviceId\", title: \"设备Id\", minWidth: 100 },\r\n          {\r\n            field: \"DeviceType\",\r\n            title: \"设备类型\",\r\n            templet: function(d) {\r\n              if (d.DeviceType === \"blue\") {\r\n                return '<span class=\"layui-badge layui-bg-blue\">蓝牙</span>';\r\n              } else {\r\n                return '<span class=\"layui-badge layui-bg-gray\">蓝牙</span>';\r\n              }\r\n            }\r\n          },\r\n          {\r\n            field: \"IsActived\",\r\n            title: \"设备是否激活\",\r\n            templet: function(d) {\r\n              if (d.IsActived == true) {\r\n                return '<span class=\"layui-badge layui-bg-blue\">已激活</span>';\r\n              } else {\r\n                return '<span class=\"layui-badge layui-bg-gray layui-badge-rim\">未激活</span>';\r\n              }\r\n            }\r\n          },\r\n          {\r\n            field: \"CreateDate\",\r\n            title: \"设备创建时间\",\r\n            templet: function(d) {\r\n              return \"<div>\" + layui.util.toDateString(d.CreateDate) + \"</div>\";\r\n            }\r\n          },\r\n          {\r\n            title: \"操作\",\r\n            width: 150,\r\n            align: \"center\",\r\n            fixed: \"right\",\r\n            toolbar: \"#table-AddressFiles\"\r\n          }\r\n        ]\r\n      ],\r\n      loading: true,\r\n      page: true,\r\n      limit: 10,\r\n      text: \"对不起，加载出现异常！\",\r\n      done: function(res, curr, count) {\r\n        //如果是异步请求数据方式，res即为你接口返回的信息。\r\n        //如果是直接赋值的方式，res即为：{data: [], count: 99} data为当前页数据、count为数据总长度\r\n        console.log(res);\r\n        // 获取到表格数据后赋值给 getData.selected\r\n        getData.original = res.data;\r\n\r\n        //得到当前页码\r\n        console.log(curr);\r\n\r\n        //得到数据总量\r\n        console.log(count);\r\n      }\r\n    });\r\n\r\n    //监听复选框\r\n    table.on(\"checkbox(table-AddressFiles)\", function(obj) {\r\n      console.log(getData.original, \"original Data\");\r\n      console.log(getData.selected, \"selected Data\");\r\n      console.log(obj.checked); //当前是否选中状态\r\n      console.log(obj.data); //选中行的相关数据\r\n      console.log(obj.type); //如果触发的是全选，则为：all，如果触发的是单选，则为：one\r\n    });\r\n    //监听工具条\r\n    table.on(\"tool(table-AddressFiles)\", function(obj) {\r\n      var data = obj.data;\r\n      if (obj.event === \"unActive\") {\r\n        var msg = data.IsActived\r\n          ? \"确认要取消激活该设备吗?\"\r\n          : \"确认要激活该设备吗?\";\r\n        layer.confirm(msg, { icon: 3, title: \"提示\" }, function(index) {\r\n          userSeverEvent.unActive(data);\r\n        });\r\n      }\r\n    });\r\n    //服务交互\r\n    var userSeverEvent = {\r\n      addMac: function(data) {\r\n        layer.closeAll();\r\n        layer.load(0, { shade: false });\r\n        var dataBean = layui.setter.basePostData;\r\n        dataBean.Data = data;\r\n        var str1 = JSON.stringify(dataBean);\r\n        $.ajax({\r\n          type: \"Post\",\r\n          url: layui.setter.huibleUrl + \"/api/IccWchat/regist\",\r\n          data: str1,\r\n          async: true,\r\n          dataType: \"json\",\r\n          headers: {\r\n            Accept: \"application/json\",\r\n            \"Content-Type\": \"application/json\"\r\n          },\r\n          success: function(data) {\r\n            layer.closeAll();\r\n            console.log(data);\r\n            if (data.IsSucceed) {\r\n              layer.msg(\"添加用户成功!\", { icon: 6 });\r\n              table.reload(\"addressFilesTable\");\r\n            } else {\r\n              table.reload(\"addressFilesTable\");\r\n              layer.msg(\"失败\" + data, { icon: 5 });\r\n            }\r\n          },\r\n          error: function(err) {\r\n            layer.closeAll();\r\n            layer.msg(\"数据操作失败\", { icon: 5 });\r\n          }\r\n        });\r\n      },\r\n      unActive: function(data) {\r\n        layer.closeAll();\r\n        layer.load(0, { shade: false });\r\n        var dataBean = layui.setter.basePostData;\r\n        dataBean.Data = {\r\n          IsActived: !data.IsActived,\r\n          RegistId: data.Id\r\n        };\r\n        var str1 = JSON.stringify(dataBean);\r\n        $.ajax({\r\n          type: \"put\",\r\n          url: layui.setter.huibleUrl + \"/api/IccWchat/regist\",\r\n          data: str1,\r\n          async: true,\r\n          dataType: \"json\",\r\n          headers: {\r\n            Accept: \"application/json\",\r\n            \"Content-Type\": \"application/json\"\r\n          },\r\n          success: function(res) {\r\n            layer.closeAll();\r\n            console.log(data);\r\n            if (res.IsSucceed) {\r\n              var msg = data.IsActived ? \"设备取消激活成功!\" : \"设备激活成功!\";\r\n              layer.msg(msg, { icon: 6 });\r\n              table.reload(\"addressFilesTable\");\r\n            } else {\r\n              table.reload(\"addressFilesTable\");\r\n              layer.msg(\"失败\" + res.Errors[0], { icon: 5 });\r\n            }\r\n          },\r\n          error: function(err) {\r\n            layer.closeAll();\r\n            layer.msg(\"数据操作失败\", { icon: 5 });\r\n          }\r\n        });\r\n      }\r\n    };\r\n    //事件\r\n    var active = {\r\n      add: function() {\r\n        layer.open({\r\n          type: 1,\r\n          title: \"新增设备注册信息\", //不显示标题\r\n          content: $(\"#rigist-from\"),\r\n          area: [\"500px\"],\r\n          btn: [\"确认\", \"取消\"],\r\n          yes: function() {\r\n            var macData = {\r\n              Mac: $(\"#Mac\").val(),\r\n              Description: \"\",\r\n              DeviceType: \"blue\",\r\n              IsForce: \"fasle\"\r\n            };\r\n            var MacStr = macData.Mac.substr(0, 7);\r\n            if (MacStr !== \"34008AD\") {\r\n              layer.msg(\"请输入34008AD开始的MAC号!\");\r\n              return;\r\n            } else if (macData.Mac.length !== 12) {\r\n              layer.msg(\"MAC号为12位字符串!\");\r\n              return;\r\n            }\r\n            userSeverEvent.addMac(macData);\r\n          },\r\n          btn2: function(index, layero) {\r\n            console.log(\"取消锁定解锁1\");\r\n          }\r\n        });\r\n      }\r\n    };\r\n    //按钮操作\r\n    $(\".layui-btn\").on(\"click\", function() {\r\n      var type = $(this).data(\"type\");\r\n      active[type] ? active[type].call(this) : \"\";\r\n    });\r\n  });\r\n"]}
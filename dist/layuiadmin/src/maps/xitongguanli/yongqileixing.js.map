{"version":3,"sources":["xitongguanli/yongqileixing.js"],"names":["layui","config","base","extend","index","use","$","table","form","common","yongqiSeverEvent","laypage","render","elem","id","url","setter","baseUrl","where","CompanyCoding","Method","parseData","request","tokenName","pageName","limitName","page","cols","field","title","templet","d","Name","Description","util","toDateString","CreateDate","ModifyDate","fixed","align","toolbar","loading","limit","text","add","data","layer","closeAll","dataBean","consts","basePostData","Data","CompanyName","console","log","str1","JSON","stringify","ajaxFun","then","res","appResult","isSucceeded","reload","find","each","this","val","msg","icon","loadErrorText","fail","err","delete","para","load","shade","Id","edit","Result","open","type","content","maxmin","area","btn","yes","layero","submit","on","info","close","trigger","Coding","SortNum","active","batchdel","checkStatus","checkData","length","confirm","Idd","call","obj","layEvent","event","tr","detail"],"mappings":";EAAA,YAAAA,OACGC,QACCC,KAAM,yBAEPC,QACCC,MAAO,cAERC,KAAK,QAAS,QAAS,OAAO,SAAS,UAAY,WAElD,GAAIC,GAAIN,MAAMM,EACdC,EAAQP,MAAMO,MACdC,EAAOR,MAAMQ,KACbC,EAAST,MAAMS,OA6DXC,GA5DUV,MAAMW,QAEKJ,EAAMK,QAC7BC,KAAM,0BACNC,GAAG,yBACHC,IAAKf,MAAMgB,OAAOC,QAAU,8BAE5BC,OAAOC,cAAgB,WAAWC,OAAS,QAC3CC,UAAUrB,MAAMgB,OAAOK,UACvBC,SACEC,WAAW,EACXC,SAAU,YACVC,UAAW,YAEbC,MAAK,EACLC,QAqBMC,MAAO,OAASC,MAAO,SAAUC,QAAS,SAASC,GACjD,MAAOA,GAAEC,QAEXJ,MAAO,cAAgBC,MAAO,KAAMC,QAAS,SAASC,GACpD,MAAOA,GAAEE,eAEXL,MAAO,UAAYC,MAAO,MAAOC,QAAS,SAASC,GACjD,MAAOA,GAAEE,eAEXL,MAAO,aAAcC,MAAO,OAAOC,QAAS,SAASC,GACnD,MAAO,QAAU/B,MAAMkC,KAAKC,aAAaJ,EAAEK,YAAc,YAE3DR,MAAO,aAAcC,MAAO,OAAOC,QAAS,SAASC,GACnD,MAAO,QAAU/B,MAAMkC,KAAKC,aAAaJ,EAAEM,YAAc,YAE5DR,MAAO,KAAKS,MAAO,QAASC,MAAM,SAAUC,QAAS,0CAG1DC,SAAS,EACTC,MAAO,GACPC,KAAM,iBAKNC,IAAK,SAASC,GACZC,MAAMC,UACN,IAAIC,GAAWhD,MAAMiD,OAAOC,cAC5BF,GAASG,KAAON,EAChBG,EAASG,KAAKhC,cAAgB,WAC9B6B,EAASG,KAAKC,YAAc,WAC5BJ,EAAS5B,OAAO,SAEhBiC,QAAQC,IAAIT,EACZ,IAAIU,GAAOC,KAAKC,UAAUT,EAC1BvC,GACGiD,QAAQ,OAAQ,0BAA2BH,GAC3CI,KAAK,SAASC,GACTnD,EAAOoD,UAAUC,YAAYF,IAC/BrD,EAAMwD,OAAO,0BACbzD,EAAE,cAAc0D,KAAK,8CAA8CC,KAAK,WACnE3D,EAAE4D,MAAMC,IAAI,MAEjBrB,MAAMsB,IAAI,WAAaC,KAAM,KAE7B5D,EAAOoD,UAAUS,cAAcV,KAGlCW,KAAK,SAAAC,GACJnB,QAAQC,IAAIkB,MAGlBC,SAAQ,SAASC,GACf5B,MAAMC,WACND,MAAM6B,KAAK,GAAKC,OAAO,GACvB,IAAI5B,GAAWhD,MAAMiD,OAAOC,cAC5BF,GAASG,KAAOuB,EAAKG,GACrB7B,EAAS5B,OAAS,QAClB,IAAImC,GAAOC,KAAKC,UAAUT,EAC1BvC,GACGiD,QAAQ,SAAU,0BAA2BH,GAC7CI,KAAK,SAASC,GACTnD,EAAOoD,UAAUC,YAAYF,IAC/BrD,EAAMwD,OAAO,0BACbjB,MAAMsB,IAAI,WAAaC,KAAM,KAE7B5D,EAAOoD,UAAUS,cAAcV,KAGlCW,KAAK,SAAAC,GACJnB,QAAQC,IAAIkB,MAGlBM,KAAM,SAASJ,GACE1E,MAAMiD,OAAOC,cAC5BzC,GACGiD,QAAQ,MAAO,0BAA0BgB,EAAKG,IAC9ClB,KAAK,SAASC,GACb,GAAInD,EAAOoD,UAAUC,YAAYF,GAAM,CACrC,GAAIA,GAAMA,EAAImB,MACdjC,OAAMkC,MACJC,KAAM,EACNpD,MAAO,SACPqD,QAAS5E,EAAE,cACX6E,QAAQ,EACRC,MAAO,QAAS,SAChBC,KAAM,KAAM,MACZC,IAAK,SAASlF,EAAOmF,GACnB,GAAIC,GAASlF,EAAE,8BAGfE,GAAKiF,GAAG,qCAAsC,SAAU5C,GACtD,GAAIjB,GAAQiB,EAAKjB,MAGboB,EAAWhD,MAAMiD,OAAOC,cAE5BF,GAASG,KAAOvB,EAChBoB,EAASG,KAAK0B,GAAKjB,EAAIiB,GACvB7B,EAASG,KAAKC,YAAcQ,EAAIR,YAChCJ,EAASG,KAAKhC,cAAgByC,EAAIzC,cAClC6B,EAAS5B,OAAO,QAChB,IAAImC,GAAOC,KAAKC,UAAUT,EAC1BK,SAAQqC,KAAK,OAAQnC,GACrB9C,EAAOiD,QAAQ,MAAO,0BAA2BH,GAAMI,KAAK,SAASC,GAC/DnD,EAAOoD,UAAUC,YAAYF,IAC/BrD,EAAMwD,OAAO,0BACbzD,EAAE,cAAc0D,KAAK,8CAA8CC,KAAK,WACjE3D,EAAE4D,MAAMC,IAAI,MAEnBrB,MAAMsB,IAAI,WAAaC,KAAM,KAE7B5D,EAAOoD,UAAUS,cAAcV,KAGlCW,KAAK,SAAAC,GACJnB,QAAQC,IAAIkB,OAId1B,MAAM6C,MAAMvF,GACdoF,EAAOI,QAAQ,YAGnBvC,QAAQqC,KAAK9B,GACbpD,EAAK2D,IAAI,aACP0B,OAAUjC,EAAIiC,OACb7D,KAAQ4B,EAAI5B,KACZ8D,QAAWlC,EAAIkC,QACf7D,YAAe2B,EAAI3B,kBAGtBxB,GAAOoD,UAAUS,cAAcV,KAGlCW,KAAK,SAAAC,GACJnB,QAAQC,IAAIkB,QAiGhBuB,GACFC,SAAU,WACR,GAAIC,GAAc1F,EAAM0F,YAAY,mBAClCC,EAAYD,EAAYpD,IAC1B,OAAyB,KAArBqD,EAAUC,OACLrD,MAAMsB,IAAI,UAEnBtB,MAAM6C,MAAMvF,WACZ0C,OAAMsD,QAAQ,SAAU,SAAShG,GAC/BG,EAAMwD,OAAO,mBACbjB,MAAMsB,IAAI,WAGdxB,IAAK,WACHE,MAAMkC,MACJC,KAAM,EACNpD,MAAO,SACPqD,QAAS5E,EAAE,cACX6E,QAAQ,EACRC,MAAO,QAAS,SAChBC,KAAM,KAAM,MACZC,IAAK,SAASlF,EAAOmF,GACnB,GAAIC,GAASlF,EAAE,8BAGfE,GAAKiF,GAAG,qCAAsC,SAAU5C,GACtD,GAAIjB,GAAQiB,EAAKjB,KACjBnB,GAAOiD,QAAQ,MAAO,6BAA6BC,KAAK,SAASC,GAC3DnD,EAAOoD,UAAUC,YAAYF,IAC/BhC,EAAMyE,IAAMzC,EAAImB,OAChBrE,EAAiBkC,IAAIhB,IAErBnB,EAAOoD,UAAUS,cAAcV,KAGlCW,KAAK,SAAAC,GACJnB,QAAQC,IAAIkB,OAGhBgB,EAAOI,QAAQ,aAOvBtF,GAAE,uCAAuCmF,GAAG,QAAS,WACnD,GAAIR,GAAO3E,EAAE4D,MAAMrB,KAAK,OACxBkD,GAAOd,GAAQc,EAAOd,GAAMqB,KAAKpC,MAAQ,KAG3C3D,EAAMkF,GAAG,SAAU,SAASc,GAC1B,GAAI1D,GAAO0D,EAAI1D,KACX2D,EAAWD,EAAIE,KACVF,GAAIG,EACG,YAAbF,GAEDnD,QAAQqC,KAAK,aACbhF,EAAiBiG,OAAO9D,IAEH,QAAb2D,EACR1D,MAAMsD,QAAQ,SAAU,SAAShG,GAC/BiD,QAAQqC,KAAK7C,GACbnC,EAAAA,UAAwBmC,GACxBC,MAAM6C,MAAMvF,KAGO,SAAboG,IAERnD,QAAQqC,KAAK7C,GAEbnC,EAAiBoE,KAAKjC","file":"../../../xitongguanli/yongqileixing.js","sourcesContent":["layui\r\n  .config({\r\n    base: \"../../../layuiadmin/\" //静态资源所在路径\r\n  })\r\n  .extend({\r\n    index: \"lib/index\" //主入口模块\r\n  })\r\n  .use([\"index\", \"table\", \"form\",\"consts\",\"common\",], function() {\r\n    \r\n    var $ = layui.$,\r\n    table = layui.table,\r\n    form = layui.form,\r\n    common = layui.common;\r\n    var laypage = layui.laypage;\r\n    //用户管理表格渲染\r\n    var yongqileixingTable = table.render({\r\n      elem: \"#LAY-yongqileixingTable\",\r\n      id:\"LAY-yongqileixingTable\",\r\n      url: layui.setter.baseUrl + \"/api/UsergasType/query/list\", //接口\r\n      //response:layui.setter.response,\r\n      where:{\"CompanyCoding\":\"88888888\",\"Method\":\"list\"},\r\n      parseData:layui.setter.parseData,\r\n      request: {\r\n        tokenName: false,\r\n        pageName: \"PageIndex\",\r\n        limitName: \"PageSize\"\r\n      },//layui.setter.request,\r\n      page:true,\r\n      cols: [\r\n        [\r\n        /*\r\n          {\r\n            field: \"Id\",\r\n            width: 100,\r\n            title: \"用气类型ID\",templet: function(d) {\r\n              return d.Id;\r\n            }\r\n          },\r\n          { field: \"CompanyCoding\", title: \"公司编码\", width: 100,templet: function(d) {\r\n              return d.CompanyCoding;\r\n            } },\r\n          { field: \"CompanyName\", title: \"公司名称\", width: 100,templet: function(d) {\r\n              return d.CompanyCoding;\r\n            } },\r\n\r\n          { field: \"Coding\", title: \"用气类型编码\" ,templet: function(d) {\r\n              return d.Coding;\r\n            }},\r\n          */\r\n          { field: \"Name\",  title: \"用气类型名称\" ,templet: function(d) {\r\n              return d.Name;\r\n            }},\r\n          { field: \"Description\",  title: \"描述\" ,templet: function(d) {\r\n              return d.Description;\r\n            }},\r\n          { field: \"SortNum\",  title: \"排序号\" ,templet: function(d) {\r\n              return d.Description;\r\n            }},  \r\n          { field: \"CreateDate\", title: \"创建时间\",templet: function(d) {\r\n              return \"<div>\" + layui.util.toDateString(d.CreateDate) + \"</div>\";\r\n            } },\r\n          { field: \"ModifyDate\", title: \"修改时间\",templet: function(d) {\r\n              return \"<div>\" + layui.util.toDateString(d.ModifyDate) + \"</div>\";\r\n            } },\r\n          {title: \"操作\",fixed: 'right', align:'center', toolbar: '#LAY-yongqileixingTable-barOperation'}\r\n        ]\r\n      ],\r\n      loading: true,\r\n      limit: 10,\r\n      text: \"对不起，加载出现异常！\"\r\n    });\r\n\r\n    //服务交互\r\n    var yongqiSeverEvent = {\r\n      add: function(data) {\r\n        layer.closeAll();\r\n        var dataBean = layui.consts.basePostData();\r\n        dataBean.Data = data;\r\n        dataBean.Data.CompanyCoding = \"88888888\";\r\n        dataBean.Data.CompanyName = \"88888888\";\r\n        dataBean.Method=\"insert\";\r\n        \r\n        console.log(data);\r\n        var str1 = JSON.stringify(dataBean);\r\n        common\r\n          .ajaxFun(\"post\", \"/api/UsergasType/insert\", str1)\r\n          .then(function(res) {\r\n            if (common.appResult.isSucceeded(res)) {\r\n              table.reload(\"LAY-yongqileixingTable\");\r\n              $(\"#lock-from\").find('input[type=text],select,input[type=hidden]').each(function() {\r\n                   $(this).val('');\r\n              });\r\n              layer.msg(\"数据添加成功!\", { icon: 6 });\r\n            } else {\r\n              common.appResult.loadErrorText(res);\r\n            }\r\n          })\r\n          .fail(err => {\r\n            console.log(err);\r\n          });\r\n      },\r\n      delete: function(para) {\r\n        layer.closeAll();\r\n        layer.load(0, { shade: false });\r\n        var dataBean = layui.consts.basePostData();\r\n        dataBean.Data = para.Id\r\n        dataBean.Method = \"remove\"\r\n        var str1 = JSON.stringify(dataBean);\r\n        common\r\n          .ajaxFun(\"delete\", \"/api/UsergasType/remove\", str1)\r\n          .then(function(res) {\r\n            if (common.appResult.isSucceeded(res)) {\r\n              table.reload(\"LAY-yongqileixingTable\");\r\n              layer.msg(\"数据删除成功!\", { icon: 6 });\r\n            } else {\r\n              common.appResult.loadErrorText(res);\r\n            }\r\n          })\r\n          .fail(err => {\r\n            console.log(err);\r\n          });\r\n      },\r\n      edit: function(para) {\r\n        var dataBean = layui.consts.basePostData();\r\n        common\r\n          .ajaxFun(\"get\", \"/api/UsergasType/query/\"+para.Id)\r\n          .then(function(res) {\r\n            if (common.appResult.isSucceeded(res)) {\r\n              var res = res.Result\r\n              layer.open({\r\n                type: 1,\r\n                title: \"修改用气类型\",\r\n                content: $('#lock-from'),\r\n                maxmin: true,\r\n                area: [\"500px\", \"300px\"],\r\n                btn: [\"确定\", \"取消\"],\r\n                yes: function(index, layero) {\r\n                  var submit = $(\"#LAY-yongqileixi-add-submit\");\r\n                   //获取提交的字段\r\n                  //监听提交\r\n                  form.on('submit(LAY-yongqileixi-add-submit)', function (data) {\r\n                    var field = data.field; //获取提交的字段\r\n                  \r\n                    //提交 Ajax 成功后，静态更新表格中的数据\r\n                    var dataBean = layui.consts.basePostData();\r\n                    \r\n                    dataBean.Data = field;\r\n                    dataBean.Data.Id = res.Id;\r\n                    dataBean.Data.CompanyName = res.CompanyName;\r\n                    dataBean.Data.CompanyCoding = res.CompanyCoding;\r\n                    dataBean.Method=\"update\";\r\n                    var str1 = JSON.stringify(dataBean);\r\n                    console.info(\"data\", str1)\r\n                    common.ajaxFun(\"put\", \"/api/UsergasType/update\", str1).then(function(res) {\r\n                      if (common.appResult.isSucceeded(res)) {\r\n                        table.reload(\"LAY-yongqileixingTable\");\r\n                        $(\"#lock-from\").find('input[type=text],select,input[type=hidden]').each(function() {\r\n                               $(this).val('');\r\n                        });\r\n                        layer.msg(\"数据更新成功!\", { icon: 6 });\r\n                      } else {\r\n                        common.appResult.loadErrorText(res);\r\n                      }\r\n                    })\r\n                    .fail(err => {\r\n                      console.log(err);\r\n                    });\r\n                    \r\n                    });\r\n                    layer.close(index); //关闭弹层\r\n                  submit.trigger(\"click\");\r\n                }\r\n              });\r\n              console.info(res)\r\n              form.val(\"lock-from\", {\r\n                \"Coding\": res.Coding // \"name\": \"value\"\r\n                ,\"Name\": res.Name\r\n                ,\"SortNum\": res.SortNum\r\n                ,\"Description\": res.Description\r\n              })\r\n            } else {\r\n              common.appResult.loadErrorText(res);\r\n            }\r\n          })\r\n          .fail(err => {\r\n            console.log(err);\r\n          });\r\n        /*\r\n        $.ajax({\r\n          type: \"get\",\r\n          url:\r\n            layui.setter.baseUrl + \"/api/BusinessHall/query/key?Data.key=\"+para.Me.Id+\"&Method=key\",\r\n          async: true, \r\n          success: function(data) {\r\n            if (data.IsSucceed) {\r\n              console.info(data)\r\n              var res = data.Result.Me\r\n              layer.open({\r\n                type: 1,\r\n                title: \"修改用气类型\",\r\n                content: $('#lock-from'),\r\n                maxmin: true,\r\n                area: [\"700px\", \"400px\"],\r\n                btn: [\"确定\", \"取消\"],\r\n                yes: function(index, layero) {\r\n                  var submit = $(\"#LAY-wangdian-add-submit\");\r\n                   //获取提交的字段\r\n                  //监听提交\r\n                  form.on('submit(LAY-wangdian-add-submit)', function (data) {\r\n                    var field = data.field; //获取提交的字段\r\n                  \r\n                    //提交 Ajax 成功后，静态更新表格中的数据\r\n                    var dataBean = layui.consts.basePostData();\r\n                    var date = new Date();\r\n                    dataBean.Data = field;\r\n                    dataBean.Data.Id = res.Id;\r\n                    dataBean.Data.LeaderID = res.LeaderID ? res.LeaderID:null;\r\n                    dataBean.Data.CompanyCoding = \"88888888\";\r\n                    dataBean.Method=\"update\";\r\n                    var str1 = JSON.stringify(dataBean);\r\n                    console.info(\"data\", str1)\r\n                    $.ajax({\r\n                      type: \"Put\",\r\n                      url: layui.setter.baseUrl + \"/api/BusinessHall/update\",\r\n                      data: str1,\r\n                      async: true,\r\n                      dataType: \"json\",\r\n                      headers: {\r\n                        Accept: \"application/json\",\r\n                        \"Content-Type\": \"application/json\"\r\n                      },\r\n                      success: function(data) {\r\n                        layer.closeAll();\r\n                        \r\n                        if (data.IsSucceed) {\r\n                          layer.msg(\"修改用气类型成功!\", { icon: 6 });\r\n                          table.reload(\"LAY-yongqileixingTable\");\r\n                          $(\"#lock-from\").find('input[type=text],select,input[type=hidden]').each(function() {\r\n                               $(this).val('');\r\n                          });\r\n                        } else {\r\n                          table.reload(\"LAY-yongqileixingTable\");\r\n                          layer.msg(\"失败: \" + data.Errors[0].Message, { icon: 5 });\r\n                        }\r\n                      },\r\n                      error: function(err) {\r\n                        layer.closeAll();\r\n                        layer.msg(\"数据操作失败\", { icon: 5 });\r\n                      }\r\n                    });\r\n                    \r\n                    layer.close(index); //关闭弹层\r\n                  });\r\n\r\n                  submit.trigger(\"click\");\r\n                }\r\n              });\r\n              form.val(\"lock-from\", {\r\n                \"Coding\": res.Coding // \"name\": \"value\"\r\n                ,\"Name\": res.Name\r\n                ,\"CompanyCoding\": res.CompanyCoding\r\n                ,\"Addr\": res.Addr\r\n                ,\"Tels\": res.Tels\r\n                ,\"WorkTimeInfo\": res.WorkTimeInfo\r\n                ,\"LeaderID\":res.LeaderID\r\n                ,\"LeaderName\":res.LeaderName\r\n                ,\"SortNum\": res.SortNum\r\n                ,\"Description\": res.Description\r\n              })\r\n            } else {\r\n              layer.msg(\"失败\" + data.Errors[0].Message, { icon: 5 });\r\n            }\r\n          },\r\n          error: function(err) {\r\n            layer.closeAll();\r\n            layer.msg(\"数据加载失败\", { icon: 5 });\r\n          }\r\n        });\r\n        */\r\n      }\r\n    }\r\n    //事件\r\n    var active = {\r\n      batchdel: function() {\r\n        var checkStatus = table.checkStatus(\"LAY-user-manage\"),\r\n          checkData = checkStatus.data; //得到选中的数据\r\n        if (checkData.length === 0) {\r\n          return layer.msg(\"请选择数据\");\r\n        }\r\n        layer.close(index);\r\n        layer.confirm(\"确定删除吗？\", function(index) {\r\n          table.reload(\"LAY-user-manage\");\r\n          layer.msg(\"已删除\");\r\n        });\r\n      },\r\n      add: function() {\r\n        layer.open({\r\n          type: 1,\r\n          title: \"添加用气类型\",\r\n          content: $('#lock-from'),\r\n          maxmin: true,\r\n          area: [\"500px\", \"300px\"],\r\n          btn: [\"确定\", \"取消\"],\r\n          yes: function(index, layero) {\r\n            var submit = $(\"#LAY-yongqileixi-add-submit\");\r\n            //获取提交的字段\r\n            //监听提交\r\n            form.on('submit(LAY-yongqileixi-add-submit)', function (data) {\r\n              var field = data.field;\r\n              common.ajaxFun(\"get\", \"/api/Common/GetInsertGuid\").then(function(res) {\r\n                if (common.appResult.isSucceeded(res)) {\r\n                  field.Idd = res.Result;\r\n                  yongqiSeverEvent.add(field);\r\n                } else {\r\n                  common.appResult.loadErrorText(res);\r\n                }\r\n              })\r\n              .fail(err => {\r\n                console.log(err);\r\n              });\r\n            });\r\n            submit.trigger(\"click\");\r\n            \r\n          }\r\n        });\r\n      }\r\n    };\r\n\r\n    $(\".layui-btn.layuiadmin-btn-useradmin\").on(\"click\", function() {\r\n      var type = $(this).data(\"type\");\r\n      active[type] ? active[type].call(this) : \"\";\r\n    });\r\n\r\n    table.on('tool()', function(obj){ //注：tool是工具条事件名，test是table原始容器的属性 lay-filter=\"对应的值\"\r\n      var data = obj.data; //获得当前行数据\r\n      var layEvent = obj.event; //获得 lay-event 对应的值（也可以是表头的 event 参数对应的值）\r\n      var tr = obj.tr; //获得当前行 tr 的DOM对象\r\n      if(layEvent === 'detail'){ //查看\r\n        \r\n        console.info(\"do detail\");\r\n        yongqiSeverEvent.detail(data)\r\n        \r\n      } else if(layEvent === 'del'){ //删除\r\n        layer.confirm('真的删除行么', function(index){\r\n          console.info(data)\r\n          yongqiSeverEvent.delete(data); //删除对应行（tr）的DOM结构，并更新缓存\r\n          layer.close(index);\r\n          //向服务端发送删除指令\r\n        });\r\n      } else if(layEvent === 'edit'){ //编辑\r\n        //do something\r\n        console.info(data);\r\n        //同步更新缓存对应的值\r\n        yongqiSeverEvent.edit(data)\r\n      }\r\n    });\r\n  });\r\n"]}
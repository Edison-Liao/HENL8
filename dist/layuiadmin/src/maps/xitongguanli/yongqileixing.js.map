{"version":3,"sources":["xitongguanli/yongqileixing.js"],"names":["layui","config","base","extend","index","use","$","table","form","common","option","laypage","baseUrl","setter","revenueUrl","yongqiSeverEvent","render","elem","id","url","where","Data.Name","Method","parseData","request","page","cols","field","title","templet","d","Name","Description","SortNum","util","toDateString","CreateDate","ModifyDate","fixed","align","toolbar","loading","limit","text","add","data","layer","closeAll","dataBean","consts","basePostData","Data","CompanyCoding","CompanyName","console","log","str1","JSON","stringify","ajaxFun","then","res","appResult","isSucceeded","reload","find","each","this","val","msg","icon","loadErrorText","fail","err","delete","para","load","shade","Id","CompanyId","edit","Result","open","type","content","maxmin","area","btn","yes","layero","submit","on","info","close","trigger","Coding","active","batchdel","checkStatus","checkData","length","confirm","Idd","call","obj","layEvent","event","tr","detail"],"mappings":"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","file":"../../../xitongguanli/yongqileixing.js","sourcesContent":["layui\r\n  .config({\r\n    base: \"../../../layuiadmin/\" //静态资源所在路径\r\n  })\r\n  .extend({\r\n    index: \"lib/index\" //主入口模块\r\n  })\r\n  .use([\"index\", \"table\", \"form\",\"consts\",\"common\",], function() {\r\n    \r\n    var $ = layui.$,\r\n    table = layui.table,\r\n    form = layui.form,\r\n    common = layui.common;\r\n    var laypage = layui.laypage;\r\n    var option = {\r\n      baseUrl:layui.setter.revenueUrl,\r\n    }\r\n    //用户管理表格渲染\r\n    var yongqileixingTable = table.render({\r\n      elem: \"#LAY-yongqileixingTable\",\r\n      id:\"LAY-yongqileixingTable\",\r\n      url: layui.setter.revenueUrl + \"/api/UsergasType/query/list\", //接口\r\n      //response:layui.setter.response,\r\n      where:{\"Data.Name\":\"\",\"Method\":\"list\"},\r\n      parseData:layui.setter.parseData,\r\n      request: layui.setter.request,\r\n      page:true,\r\n      cols: [\r\n        [\r\n        /*\r\n          {\r\n            field: \"Id\",\r\n            width: 100,\r\n            title: \"用气类型ID\",templet: function(d) {\r\n              return d.Id;\r\n            }\r\n          },\r\n          { field: \"CompanyCoding\", title: \"公司编码\", width: 100,templet: function(d) {\r\n              return d.CompanyCoding;\r\n            } },\r\n          { field: \"CompanyName\", title: \"公司名称\", width: 100,templet: function(d) {\r\n              return d.CompanyCoding;\r\n            } },\r\n\r\n          { field: \"Coding\", title: \"用气类型编码\" ,templet: function(d) {\r\n              return d.Coding;\r\n            }},\r\n          */\r\n          { field: \"Name\",  title: \"用气类型名称\" ,templet: function(d) {\r\n              return d.Name;\r\n            }},\r\n          { field: \"Description\",  title: \"描述\" ,templet: function(d) {\r\n              return d.Description;\r\n            }},\r\n          { field: \"SortNum\",  title: \"排序号\" ,templet: function(d) {\r\n              return d.SortNum;\r\n            }},  \r\n          { field: \"CreateDate\", title: \"创建时间\",templet: function(d) {\r\n              return \"<div>\" + layui.util.toDateString(d.CreateDate) + \"</div>\";\r\n            } },\r\n          { field: \"ModifyDate\", title: \"修改时间\",templet: function(d) {\r\n              return \"<div>\" + layui.util.toDateString(d.ModifyDate) + \"</div>\";\r\n            } },\r\n          {title: \"操作\",fixed: 'right', align:'center', toolbar: '#LAY-yongqileixingTable-barOperation'}\r\n        ]\r\n      ],\r\n      loading: true,\r\n      limit: 10,\r\n      text: \"对不起，加载出现异常！\"\r\n    });\r\n\r\n    //服务交互\r\n    var yongqiSeverEvent = {\r\n      add: function(data) {\r\n        layer.closeAll();\r\n        var dataBean = layui.consts.basePostData();\r\n        dataBean.Data = data;\r\n        dataBean.Data.CompanyCoding = \"88888888\";\r\n        dataBean.Data.CompanyName = \"88888888\";\r\n        dataBean.Method=\"insert\";\r\n        \r\n        console.log(data);\r\n        var str1 = JSON.stringify(dataBean);\r\n        common\r\n          .ajaxFun(\"post\", \"/api/UsergasType/insert\", str1,option)\r\n          .then(function(res) {\r\n            if (common.appResult.isSucceeded(res)) {\r\n              table.reload(\"LAY-yongqileixingTable\");\r\n              $(\"#lock-from\").find('input[type=text],select,input[type=hidden]').each(function() {\r\n                   $(this).val('');\r\n              });\r\n              layer.msg(\"数据添加成功!\", { icon: 6 });\r\n            } else {\r\n              common.appResult.loadErrorText(res);\r\n            }\r\n          })\r\n          .fail(err => {\r\n            console.log(err);\r\n          });\r\n      },\r\n      delete: function(para) {\r\n        layer.closeAll();\r\n        layer.load(0, { shade: false });\r\n        var dataBean = layui.consts.basePostData();\r\n        dataBean.Data = {}\r\n        dataBean.Data.Id = para.Id\r\n        dataBean.Data.CompanyId = para.CompanyId\r\n        dataBean.Method = \"remove\"\r\n        var str1 = JSON.stringify(dataBean);\r\n        common\r\n          .ajaxFun(\"delete\", \"/api/UsergasType/remove\", str1,option)\r\n          .then(function(res) {\r\n            if (common.appResult.isSucceeded(res)) {\r\n              table.reload(\"LAY-yongqileixingTable\");\r\n              layer.msg(\"数据删除成功!\", { icon: 6 });\r\n            } else {\r\n              common.appResult.loadErrorText(res);\r\n            }\r\n          })\r\n          .fail(err => {\r\n            console.log(err);\r\n          });\r\n      },\r\n      edit: function(para) {\r\n        var dataBean = layui.consts.basePostData();\r\n        dataBean.Data = {}\r\n        dataBean.Data.Id = para.Id\r\n        common\r\n          .ajaxFun(\"get\", \"/api/UsergasType/query/key?Data.Id=\"+para.Id+\"&Method=key\",\"\",option)\r\n          .then(function(res) {\r\n            if (common.appResult.isSucceeded(res)) {\r\n              var res = res.Result\r\n              layer.open({\r\n                type: 1,\r\n                title: \"修改用气类型\",\r\n                content: $('#lock-from'),\r\n                maxmin: true,\r\n                area: [\"500px\", \"300px\"],\r\n                btn: [\"确定\", \"取消\"],\r\n                yes: function(index, layero) {\r\n                  var submit = $(\"#LAY-yongqileixi-add-submit\");\r\n                   //获取提交的字段\r\n                  //监听提交\r\n                  form.on('submit(LAY-yongqileixi-add-submit)', function (data) {\r\n                    var field = data.field; //获取提交的字段\r\n                  \r\n                    //提交 Ajax 成功后，静态更新表格中的数据\r\n                    var dataBean = layui.consts.basePostData();\r\n                    \r\n                    dataBean.Data = field;\r\n                    dataBean.Data.Id = res.Id;\r\n                    dataBean.Data.CompanyName = res.CompanyName;\r\n                    dataBean.Data.CompanyCoding = res.CompanyCoding;\r\n                    dataBean.Method=\"update\";\r\n                    var str1 = JSON.stringify(dataBean);\r\n                    console.info(\"data\", str1)\r\n                    common.ajaxFun(\"put\", \"/api/UsergasType/update\", str1,option).then(function(res) {\r\n                      if (common.appResult.isSucceeded(res)) {\r\n                        table.reload(\"LAY-yongqileixingTable\");\r\n                        $(\"#lock-from\").find('input[type=text],select,input[type=hidden]').each(function() {\r\n                               $(this).val('');\r\n                        });\r\n                        layer.msg(\"数据更新成功!\", { icon: 6 });\r\n                      } else {\r\n                        common.appResult.loadErrorText(res);\r\n                      }\r\n                    })\r\n                    .fail(err => {\r\n                      console.log(err);\r\n                    });\r\n                    \r\n                    });\r\n                    layer.close(index); //关闭弹层\r\n                  submit.trigger(\"click\");\r\n                }\r\n              });\r\n              console.info(res)\r\n              form.val(\"lock-from\", {\r\n                \"Coding\": res.Coding // \"name\": \"value\"\r\n                ,\"Name\": res.Name\r\n                ,\"SortNum\": res.SortNum\r\n                ,\"Description\": res.Description\r\n              })\r\n            } else {\r\n              common.appResult.loadErrorText(res);\r\n            }\r\n          })\r\n          .fail(err => {\r\n            console.log(err);\r\n          });\r\n      }\r\n    }\r\n    //事件\r\n    var active = {\r\n      batchdel: function() {\r\n        var checkStatus = table.checkStatus(\"LAY-user-manage\"),\r\n          checkData = checkStatus.data; //得到选中的数据\r\n        if (checkData.length === 0) {\r\n          return layer.msg(\"请选择数据\");\r\n        }\r\n        layer.close(index);\r\n        layer.confirm(\"确定删除吗？\", function(index) {\r\n          table.reload(\"LAY-user-manage\");\r\n          layer.msg(\"已删除\");\r\n        });\r\n      },\r\n      add: function() {\r\n        layer.open({\r\n          type: 1,\r\n          title: \"添加用气类型\",\r\n          content: $('#lock-from'),\r\n          maxmin: true,\r\n          area: [\"500px\", \"300px\"],\r\n          btn: [\"确定\", \"取消\"],\r\n          yes: function(index, layero) {\r\n            var submit = $(\"#LAY-yongqileixi-add-submit\");\r\n            //获取提交的字段\r\n            //监听提交\r\n            form.on('submit(LAY-yongqileixi-add-submit)', function (data) {\r\n              var field = data.field;\r\n              common.ajaxFun(\"get\", \"/api/Common/GetInsertGuid\",\"\",option).then(function(res) {\r\n                if (common.appResult.isSucceeded(res)) {\r\n                  field.Idd = res.Result;\r\n                  yongqiSeverEvent.add(field);\r\n                } else {\r\n                  common.appResult.loadErrorText(res);\r\n                }\r\n              })\r\n              .fail(err => {\r\n                console.log(err);\r\n              });\r\n            });\r\n            submit.trigger(\"click\");\r\n            \r\n          }\r\n        });\r\n      }\r\n    };\r\n\r\n    $(\".layui-btn.layuiadmin-btn-useradmin\").on(\"click\", function() {\r\n      var type = $(this).data(\"type\");\r\n      active[type] ? active[type].call(this) : \"\";\r\n    });\r\n\r\n    table.on('tool()', function(obj){ //注：tool是工具条事件名，test是table原始容器的属性 lay-filter=\"对应的值\"\r\n      var data = obj.data; //获得当前行数据\r\n      var layEvent = obj.event; //获得 lay-event 对应的值（也可以是表头的 event 参数对应的值）\r\n      var tr = obj.tr; //获得当前行 tr 的DOM对象\r\n      if(layEvent === 'detail'){ //查看\r\n        \r\n        console.info(\"do detail\");\r\n        yongqiSeverEvent.detail(data)\r\n        \r\n      } else if(layEvent === 'del'){ //删除\r\n        layer.confirm('真的删除行么', function(index){\r\n          console.info(data)\r\n          yongqiSeverEvent.delete(data); //删除对应行（tr）的DOM结构，并更新缓存\r\n          layer.close(index);\r\n          //向服务端发送删除指令\r\n        });\r\n      } else if(layEvent === 'edit'){ //编辑\r\n        //do something\r\n        console.info(data);\r\n        //同步更新缓存对应的值\r\n        yongqiSeverEvent.edit(data)\r\n      }\r\n    });\r\n  });\r\n"]}
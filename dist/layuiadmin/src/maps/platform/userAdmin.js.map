{"version":3,"sources":["platform/userAdmin.js"],"names":["layui","config","base","extend","index","use","$","form","common","table","on","data","field","reload","where","userSeverEvent","addUser","dataBean","consts","basePostData","Data","console","log","str1","JSON","stringify","ajaxFun","then","res","appResult","isSucceeded","layer","msg","icon","closeAll","loadErrorText","fail","err","loadUserClassify","render","loadSelect","Result","active","batchdel","checkStatus","checkData","length","close","confirm","add","open","type","title","content","maxmin","area","btn","yes","layero","iframeWindow","window","submitID","submit","find","contents","trigger","selectData","op","i","Value","Text","html","this","call"],"mappings":";EAAA,YAAAA,OACGC,QACCC,KAAM,yBAEPC,QACCC,MAAO,cAERC,KAAK,QAAS,YAAa,QAAS,SAAU,UAAW,WACxD,GAAIC,GAAIN,MAAMM,EACZC,EAAOP,MAAMO,KACbC,EAASR,MAAMQ,OACfC,EAAQT,MAAMS,KAEhBF,GAAKG,GAAG,gCAAiC,SAASC,GAChD,GAAIC,GAAQD,EAAKC,KAEjBH,GAAMI,OAAO,mBACXC,MAAOF,KAIX,IAAIG,IACFC,QAAS,SAASL,GAEhB,GAAIM,GAAWjB,MAAMkB,OAAOC,cAC5BF,GAASG,KAAOT,EAChBU,QAAQC,IAAIX,EACZ,IAAIY,GAAOC,KAAKC,UAAUR,EAC1BT,GACGkB,QAAQ,OAAQ,YAAaH,GAC7BI,KAAK,SAASC,GACTpB,EAAOqB,UAAUC,YAAYF,IAC/BG,MAAMC,IAAI,WAAaC,KAAM,IAC7BF,MAAMG,WACNzB,EAAMI,OAAO,oBAEbL,EAAOqB,UAAUM,cAAcP,KAGlCQ,KAAK,SAAAC,GACJhB,QAAQC,IAAIe,MAGlBC,iBAAkB,WAChB9B,EACGkB,QAAQ,MAAO,oBACfC,KAAK,SAAShB,GACTH,EAAOqB,UAAUC,YAAYnB,GAC/B4B,EAAOC,WAAW7B,EAAK8B,QAEvBjC,EAAOqB,UAAUM,cAAcP,OAGlCQ,KAAK,SAAAC,GACJhB,QAAQC,IAAIe,OAKhBK,GACFC,SAAU,WACR,GAAIC,GAAcnC,EAAMmC,YAAY,mBAClCC,EAAYD,EAAYjC,IAC1B,OAAyB,KAArBkC,EAAUC,OACLf,MAAMC,IAAI,UAEnBD,MAAMgB,MAAM3C,WACZ2B,OAAMiB,QAAQ,SAAU,SAAS5C,GAC/BK,EAAMI,OAAO,mBACbkB,MAAMC,IAAI,WAGdiB,IAAK,WACHlB,MAAMmB,MACJC,KAAM,EACNC,MAAO,OACPC,QAAS,4BAETC,QAAQ,EACRC,MAAO,QAAS,SAChBC,KAAM,KAAM,MACZC,IAAK,SAASrD,EAAOsD,GACnB,GAAIC,GAAeC,OAAO,qBAAuBxD,GAC/CyD,EAAW,wBACXC,EAASJ,EACNK,KAAK,UACLC,WACAD,KAAK,IAAMF,EAEhBF,GAAa3D,MAAMO,KAAKG,GAAG,UAAYmD,EAAW,IAAK,SACrDlD,GAEA,GAAIC,GAAQD,EAAKC,KAEjBG,GAAeC,QAAQJ,GAIvBmB,MAAMgB,MAAM3C,KAGd0D,EAAOG,QAAQ,cAKnB1B,GACFC,WAAY,SAAS0B,GACnB,GAAIC,GAAK,4BACT,KAAK,GAAIC,KAAKF,GACZC,GACE,iBACAD,EAAWE,GAAGC,MACd,IACAH,EAAWE,GAAGE,KACd,WAEJhE,GAAE,oBAAoBiE,KAAKJ,GAC3B5D,EAAKgC,OAAO,WAGhBxB,GAAeuB,mBACfhC,EAAE,uCAAuCI,GAAG,QAAS,WACnD,GAAIyC,GAAO7C,EAAEkE,MAAM7D,KAAK,OACxB+B,GAAOS,GAAQT,EAAOS,GAAMsB,KAAKD,MAAQ","file":"../../../platform/userAdmin.js","sourcesContent":["layui\r\n  .config({\r\n    base: \"../../../layuiadmin/\" //静态资源所在路径\r\n  })\r\n  .extend({\r\n    index: \"lib/index\" //主入口模块\r\n  })\r\n  .use([\"index\", \"useradmin\", \"table\", \"common\", \"consts\"], function() {\r\n    var $ = layui.$,\r\n      form = layui.form,\r\n      common = layui.common,\r\n      table = layui.table;\r\n    //监听搜索\r\n    form.on(\"submit(LAY-user-front-search)\", function(data) {\r\n      var field = data.field;\r\n      //执行重载\r\n      table.reload(\"LAY-user-manage\", {\r\n        where: field\r\n      });\r\n    });\r\n    //服务交互\r\n    var userSeverEvent = {\r\n      addUser: function(data) {\r\n        //\r\n        var dataBean = layui.consts.basePostData();\r\n        dataBean.Data = data;\r\n        console.log(data);\r\n        var str1 = JSON.stringify(dataBean);\r\n        common\r\n          .ajaxFun(\"post\", \"/api/User\", str1)\r\n          .then(function(res) {\r\n            if (common.appResult.isSucceeded(res)) {\r\n              layer.msg(\"数据添加成功!\", { icon: 6 });\r\n              layer.closeAll();\r\n              table.reload(\"LAY-user-manage\");\r\n            } else {\r\n              common.appResult.loadErrorText(res);\r\n            }\r\n          })\r\n          .fail(err => {\r\n            console.log(err);\r\n          });\r\n      },\r\n      loadUserClassify: function() {\r\n        common\r\n          .ajaxFun(\"get\", \"/api/User/groups\")\r\n          .then(function(data) {\r\n            if (common.appResult.isSucceeded(data)) {\r\n              render.loadSelect(data.Result);\r\n            } else {\r\n              common.appResult.loadErrorText(res);\r\n            }\r\n          })\r\n          .fail(err => {\r\n            console.log(err);\r\n          });\r\n      }\r\n    };\r\n    //事件\r\n    var active = {\r\n      batchdel: function() {\r\n        var checkStatus = table.checkStatus(\"LAY-user-manage\"),\r\n          checkData = checkStatus.data; //得到选中的数据\r\n        if (checkData.length === 0) {\r\n          return layer.msg(\"请选择数据\");\r\n        }\r\n        layer.close(index);\r\n        layer.confirm(\"确定删除吗？\", function(index) {\r\n          table.reload(\"LAY-user-manage\");\r\n          layer.msg(\"已删除\");\r\n        });\r\n      },\r\n      add: function() {\r\n        layer.open({\r\n          type: 2,\r\n          title: \"添加用户\",\r\n          content: \"../tpl/from/userFrom.html\",\r\n          // content: \"../tpl/tree/organTree.html\",\r\n          maxmin: true,\r\n          area: [\"700px\", \"400px\"],\r\n          btn: [\"确定\", \"取消\"],\r\n          yes: function(index, layero) {\r\n            var iframeWindow = window[\"layui-layer-iframe\" + index],\r\n              submitID = \"LAY-user-front-submit\",\r\n              submit = layero\r\n                .find(\"iframe\")\r\n                .contents()\r\n                .find(\"#\" + submitID);\r\n            //监听提交\r\n            iframeWindow.layui.form.on(\"submit(\" + submitID + \")\", function(\r\n              data\r\n            ) {\r\n              var field = data.field; //获取提交的字段\r\n\r\n              userSeverEvent.addUser(field);\r\n              //提交 Ajax 成功后，静态更新表格中的数据\r\n              //$.ajax({});\r\n\r\n              layer.close(index); //关闭弹层\r\n            });\r\n\r\n            submit.trigger(\"click\");\r\n          }\r\n        });\r\n      }\r\n    };\r\n    var render = {\r\n      loadSelect: function(selectData) {\r\n        var op = \"<option value=''></option>\";\r\n        for (var i in selectData) {\r\n          op +=\r\n            \"<option value=\" +\r\n            selectData[i].Value +\r\n            \">\" +\r\n            selectData[i].Text +\r\n            \"</option>\";\r\n        }\r\n        $(\"#userGroupSelect\").html(op);\r\n        form.render(\"select\");\r\n      }\r\n    };\r\n    userSeverEvent.loadUserClassify();\r\n    $(\".layui-btn.layuiadmin-btn-useradmin\").on(\"click\", function() {\r\n      var type = $(this).data(\"type\");\r\n      active[type] ? active[type].call(this) : \"\";\r\n    });\r\n  });\r\n"]}
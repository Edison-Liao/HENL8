{"version":3,"sources":["platform/role.js"],"names":["layui","config","base","extend","index","use","$","form","layer","table","common","tree","on","this","siblings","length","css","find","data","console","log","field","topName","organ","baseData","editFalge","server","eidtOrgan","addOrgan","init","getTreeData","render","showtips","event","treeNode","id","nodeData","click","html","showForm","val","name","moveNodeData","openDeleteConfirm","ajax","type","url","setter","baseUrl","dataType","headers","Accept","Content-Type","success","closeAll","IsSucceed","currData","i","Title","children","Children","Result","TreeNodes","nodeData1","renderTree","msg","icon","error","err","getNodedata","flage","urlID","load","dataNode","Name","Code","Message","Errors","dataBean","consts","basePostData","ParentId","Data","str1","JSON","stringify","Id","isRise","Flag","delet","alert","elem","target","item","renderTitle","getTreeNodeName","disabledBtton","nodes","flag","addClass","show","removeClass","renderFormData","isDisableButton","confirm","btn","treeData","title"],"mappings":"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","file":"../../../platform/role.js","sourcesContent":["layui\r\n  .config({\r\n    base: \"../../../layuiadmin/\"\r\n  })\r\n  .extend({\r\n    index: \"lib/index\" //主入口模块\r\n  })\r\n  .use([\"index\", \"table\", \"layer\", \"tree\", \"common\", \"consts\"], function() {\r\n    var $ = layui.$,\r\n      form = layui.form,\r\n      table = layui.table,\r\n      layer = layui.layer,\r\n      tree = layui.tree,\r\n      common = layui.common;\r\n    // const obj = { a: 1, b: { c: \"csc\", d: \"cc\" }, d: \"dd\" };\r\n    // console.log(...obj, \"~~~~~~~~~~~\");\r\n    // const a = { ...obj };\r\n    // console.log(a, \"解构\");\r\n    $(\"body\").on(\"mousedown\", \".layui-tree a\", function() {\r\n      if (!$(this).siblings(\"ul\").length) {\r\n        $(\".layui-tree a cite\").css(\"color\", \"#333\");\r\n        $(this)\r\n          .find(\"cite\")\r\n          .css(\"color\", \"red\");\r\n      }\r\n    });\r\n    //数据表单监听(部门)\r\n    form.on(\"submit(DepartmentFrom)\", function(data) {\r\n      console.log(data.field, \"新增部门\");\r\n      delete data.field.topName;\r\n      if (organ.baseData.editFalge) {\r\n        console.log(\"执行编辑命令\");\r\n        organ.server.eidtOrgan(data.field, \"/api/Role\", \"department\");\r\n      } else {\r\n        organ.server.addOrgan(data.field, \"/api/Role\", \"department\");\r\n        console.log(\"执行添加命令\");\r\n      }\r\n      return false;\r\n    });\r\n    //数据表单监听(角色)\r\n    form.on(\"submit(staffFrom)\", function(data) {\r\n      delete data.field.topName;\r\n      if (organ.baseData.editFalge) {\r\n        organ.server.eidtOrgan(data.field, \"/api/Role\", \"staff\");\r\n      } else {\r\n        organ.server.addOrgan(data.field, \"/api/Role\", \"staff\");\r\n      }\r\n      return false;\r\n    });\r\n    //organ\r\n    var organ = {\r\n      init: function() {\r\n        this.server.getTreeData();\r\n        this.render.showtips();\r\n        this.event();\r\n      },\r\n      baseData: {\r\n        treeNode: {},\r\n        id: \"\",\r\n        nodeData: {},\r\n        editFalge: false\r\n      },\r\n      event: function() {\r\n        $(\"#refresh\").click(function() {\r\n          $(\"#treeOrgan\").html(\"\");\r\n          organ.server.getTreeData();\r\n          organ.baseData.editFalge = false;\r\n        });\r\n        $(\"#showDepartment\").click(function() {\r\n          $(\"#formTitle\").html(\"新增角色分组信息\");\r\n          $(\".submit\").html(\"立即提交\");\r\n          organ.render.showForm(\"#DepartmentFrom\");\r\n          form.val(\"DepartmentFrom\", {\r\n            topName: organ.baseData.treeNode.name\r\n          });\r\n          organ.baseData.editFalge = false;\r\n        });\r\n        $(\"#showStaff\").click(function() {\r\n          $(\"#formTitle\").html(\"新增角色信息\");\r\n          $(\".submit\").html(\"立即提交\");\r\n          organ.render.showForm(\"#staffFrom\");\r\n          form.val(\"staffFrom\", {\r\n            topName: organ.baseData.treeNode.name\r\n          });\r\n          organ.baseData.editFalge = false;\r\n        });\r\n        $(\"#lower\").click(function() {\r\n          organ.server.moveNodeData(organ.baseData.treeNode, false);\r\n          organ.baseData.editFalge = false;\r\n        });\r\n        $(\"#upper\").click(function() {\r\n          organ.server.moveNodeData(organ.baseData.treeNode, true);\r\n          organ.baseData.editFalge = false;\r\n        });\r\n        $(\"#delet\").click(function() {\r\n          organ.render.openDeleteConfirm(organ.baseData.treeNode);\r\n        });\r\n      },\r\n      server: {\r\n        getTreeData: function() {\r\n          $.ajax({\r\n            type: \"get\",\r\n            url: layui.setter.baseUrl + \"/api/Role/treeview\",\r\n            dataType: \"json\",\r\n            headers: {\r\n              Accept: \"application/json\",\r\n              \"Content-Type\": \"application/json\"\r\n            },\r\n            success: function(data) {\r\n              layer.closeAll(\"loading\");\r\n              console.log(data);\r\n              if (data.IsSucceed) {\r\n                console.log(data.Result.TreeNodes);\r\n                var nodeData = data.Result.TreeNodes;\r\n                function currData(data) {\r\n                  if (data.length > 0) {\r\n                    for (var i = 0; i < data.length; i++) {\r\n                      data[i].name = data[i].Title;\r\n                      data[i].children = data[i].Children;\r\n                      if (data[i].Children.length > 0) {\r\n                        currData(data[i].Children);\r\n                      }\r\n                    }\r\n                  }\r\n                  return data;\r\n                }\r\n                var nodeData1 = currData(nodeData);\r\n                organ.render.renderTree(nodeData1);\r\n              } else {\r\n                layer.msg(\"获取数据失败\" + data, { icon: 5 });\r\n              }\r\n            },\r\n            error: function(err) {\r\n              layer.closeAll();\r\n              layer.msg(\"数据操作失败\", { icon: 5 });\r\n            }\r\n          });\r\n        },\r\n        getNodedata: function(flage, id) {\r\n          var urlID = \"\";\r\n          if (flage === \"roleCatalog\") {\r\n            urlID = \"/api/Role/\" + id;\r\n            organ.render.showForm(\"#DepartmentFrom\");\r\n          } else if (flage === \"roleInfo\") {\r\n            urlID = \"/api/Role/\" + id;\r\n            organ.render.showForm(\"#staffFrom\");\r\n          } else {\r\n            return;\r\n          }\r\n          layer.load(2);\r\n          $.ajax({\r\n            type: \"get\",\r\n            url: layui.setter.baseUrl + urlID,\r\n            dataType: \"json\",\r\n            headers: {\r\n              Accept: \"application/json\",\r\n              \"Content-Type\": \"application/json\"\r\n            },\r\n            success: function(data) {\r\n              layer.closeAll();\r\n              console.log(data);\r\n              if (data.IsSucceed) {\r\n                organ.baseData.nodeData = data.Result;\r\n                var dataNode = data.Result;\r\n                if (flage === \"roleCatalog\") {\r\n                  form.val(\"DepartmentFrom\", {\r\n                    Name: dataNode.Name,\r\n                    Code: dataNode.Code,\r\n                    Message: dataNode.Message\r\n                  });\r\n                } else if (flage === \"roleInfo\") {\r\n                  form.val(\"staffFrom\", {\r\n                    Name: dataNode.Name,\r\n                    Code: dataNode.Code,\r\n                    Message: dataNode.Message\r\n                  });\r\n                }\r\n              } else {\r\n                layer.msg(\"获取节点数据失败! \" + data.Errors[0].Message, {\r\n                  icon: 5\r\n                });\r\n              }\r\n            },\r\n            error: function(err) {\r\n              layer.closeAll();\r\n              layer.msg(\"数据操作失败\", { icon: 5 });\r\n            }\r\n          });\r\n        },\r\n        addOrgan: function(data, url, flage) {\r\n          var dataBean = layui.consts.basePostData();\r\n          if (flage === \"staff\") {\r\n            data.ParentId = organ.baseData.id;\r\n          }\r\n          dataBean.Data = data;\r\n          console.log(data);\r\n          var str1 = JSON.stringify(dataBean);\r\n          layer.load();\r\n          $.ajax({\r\n            type: \"post\",\r\n            url: layui.setter.baseUrl + url,\r\n            data: str1,\r\n            dataType: \"json\",\r\n            headers: {\r\n              Accept: \"application/json\",\r\n              \"Content-Type\": \"application/json\"\r\n            },\r\n            success: function(data) {\r\n              layer.closeAll();\r\n              console.log(data);\r\n              if (data.IsSucceed) {\r\n                $(\"#treeOrgan\").html(\"\");\r\n                organ.server.getTreeData();\r\n                layer.msg(\"添加成功!\", { icon: 6 });\r\n              } else {\r\n                layer.msg(\"增加数据失败! \" + data.Errors[0].Message, {\r\n                  icon: 5\r\n                });\r\n              }\r\n            },\r\n            error: function(err) {\r\n              layer.closeAll();\r\n              layer.msg(\"数据操作失败\", { icon: 5 });\r\n            }\r\n          });\r\n        },\r\n        eidtOrgan: function(data, url) {\r\n          var dataBean = layui.consts.basePostData();\r\n          data.Id = organ.baseData.id;\r\n          dataBean.Data = data;\r\n\r\n          var str1 = JSON.stringify(dataBean);\r\n          layer.load();\r\n          $.ajax({\r\n            type: \"put\",\r\n            url: layui.setter.baseUrl + url + \"/\" + organ.baseData.id,\r\n            data: str1,\r\n            dataType: \"json\",\r\n            headers: {\r\n              Accept: \"application/json\",\r\n              \"Content-Type\": \"application/json\"\r\n            },\r\n            success: function(data) {\r\n              layer.closeAll();\r\n              console.log(data);\r\n              if (data.IsSucceed) {\r\n                $(\"#treeOrgan\").html(\"\");\r\n                organ.server.getTreeData();\r\n                layer.msg(\"修改成功!\", { icon: 6 });\r\n              } else {\r\n                layer.msg(\"增加数据失败! \" + data.Errors[0].Message, {\r\n                  icon: 5\r\n                });\r\n              }\r\n            },\r\n            error: function(err) {\r\n              layer.closeAll();\r\n              layer.msg(\"数据操作失败\", { icon: 5 });\r\n            }\r\n          });\r\n        },\r\n        moveNodeData: function(data, isRise) {\r\n          var urlID = \"\";\r\n          if (data.Flag === \"roleInfo\") {\r\n            urlID = \"/api/Role/\" + data.Id + \"/order/\" + isRise;\r\n          } else {\r\n            return;\r\n          }\r\n          layer.load();\r\n          $.ajax({\r\n            type: \"put\",\r\n            url: layui.setter.baseUrl + urlID,\r\n            dataType: \"json\",\r\n            headers: {\r\n              Accept: \"application/json\",\r\n              \"Content-Type\": \"application/json\"\r\n            },\r\n            success: function(data) {\r\n              layer.closeAll(\"loading\");\r\n              console.log(data);\r\n              if (data.IsSucceed) {\r\n                $(\"#treeOrgan\").html(\"\");\r\n                organ.server.getTreeData();\r\n                layer.msg(\"数据移动成功\", { icon: 1 });\r\n              } else {\r\n                layer.msg(\"数据操作失败\" + data.Errors[0].Message, {\r\n                  icon: 5\r\n                });\r\n              }\r\n            },\r\n            error: function(err) {\r\n              layer.closeAll();\r\n              layer.msg(\"数据操作失败\", { icon: 5 });\r\n            }\r\n          });\r\n        },\r\n        delet: function(flage, id) {\r\n          layer.load();\r\n          var urlID = \"\";\r\n          if (flage === \"roleInfo\" || flage === \"roleCatalog\") {\r\n            urlID = \"/api/Role/\" + id;\r\n          } else {\r\n            layer.closeAll();\r\n            return;\r\n          }\r\n          $.ajax({\r\n            type: \"DELETE\",\r\n            url: layui.setter.baseUrl + urlID,\r\n            dataType: \"json\",\r\n            headers: {\r\n              Accept: \"application/json\",\r\n              \"Content-Type\": \"application/json\"\r\n            },\r\n            success: function(data) {\r\n              layer.closeAll();\r\n              console.log(data);\r\n              if (data.IsSucceed) {\r\n                $(\"#treeOrgan\").html(\"\");\r\n                organ.server.getTreeData();\r\n                layer.alert(\"删除成功\", {\r\n                  icon: 1\r\n                });\r\n              } else {\r\n                layer.msg(\"获取节点数据失败! \" + data.Errors[0].Message, {\r\n                  icon: 5\r\n                });\r\n              }\r\n            },\r\n            error: function(err) {\r\n              layer.closeAll();\r\n              layer.msg(\"数据操作失败\", { icon: 5 });\r\n            }\r\n          });\r\n        }\r\n      },\r\n      render: {\r\n        renderTree: function(data) {\r\n          //树形渲染\r\n          layui.tree({\r\n            elem: \"#treeOrgan\", //指定元素\r\n            target: \"_blank\", //是否新选项卡打开（比如节点返回href才有效）\r\n            click: function(item) {\r\n              //点击节点回调\r\n              organ.baseData.treeNode = item;\r\n              organ.baseData.id = item.Id;\r\n              organ.baseData.editFalge = true;\r\n              console.log(organ.baseData.treeNode);\r\n              organ.render.renderTitle(item.Flag);\r\n              organ.server.getNodedata(item.Flag, item.Id);\r\n              organ.currData.getTreeNodeName(data, item.ParentId);\r\n              organ.render.disabledBtton(item.Flag);\r\n            },\r\n            nodes: data\r\n          });\r\n        },\r\n        renderTitle: function(flag) {\r\n          if (flag === \"roleCatalog\") {\r\n            $(\"#formTitle\").html(\"编辑角色信息分组\");\r\n          } else if (flag === \"roleInfo\") {\r\n            $(\"#formTitle\").html(\"编辑角色信息\");\r\n          }\r\n        },\r\n        showForm: function(id) {\r\n          $(\"#DepartmentFrom\").addClass(\"layui-hide\");\r\n          $(\"#staffFrom\").addClass(\"layui-hide\");\r\n          $(id).show();\r\n          $(id).removeClass(\"layui-hide\");\r\n        },\r\n        renderFormData: function(data) {\r\n          if (data.Flag === \"roleCatalog\") {\r\n            form.val(\"DepartmentFrom\", {\r\n              Name: data.Title\r\n            });\r\n          }\r\n        },\r\n        disabledBtton: function(flage) {\r\n          common.isDisableButton(\"#lower\", false);\r\n          common.isDisableButton(\"#upper\", false);\r\n          common.isDisableButton(\"#delet\", false);\r\n          if (flage === \"roleCatalog\") {\r\n            common.isDisableButton(\"#lower\", true);\r\n            common.isDisableButton(\"#upper\", true);\r\n            common.isDisableButton(\"#showDepartment\", false);\r\n            common.isDisableButton(\"#showStaff\", false);\r\n          } else if (flage === \"roleInfo\") {\r\n            common.isDisableButton(\"#showDepartment\", true);\r\n            common.isDisableButton(\"#showStaff\", true);\r\n          }\r\n        },\r\n        showtips: function() {\r\n          common.showtips(\".layui-btn-group button\");\r\n        },\r\n        openDeleteConfirm: function(data) {\r\n          layer.confirm(\r\n            \"你确定要删除<span style='font-weight:bolder'>\" +\r\n              data.Title +\r\n              \"</span>的节点吗?\",\r\n            {\r\n              btn: [\"确定\", \"取消\"], //按钮\r\n              icon: 3\r\n            },\r\n            function() {\r\n              organ.server.delet(data.Flag, data.Id);\r\n            },\r\n            function() {\r\n              console.log(\"取消\");\r\n            }\r\n          );\r\n        }\r\n      },\r\n      currData: {\r\n        getTreeNodeName: function(treeData, id) {\r\n          var title = common.getTreeNodeName(treeData, id, \"name\");\r\n          $(\".topName\").val(title);\r\n          $(\".submit\").html(\"立即修改\");\r\n        }\r\n      }\r\n    };\r\n    organ.init();\r\n  });\r\n"]}
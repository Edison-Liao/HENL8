{"version":3,"sources":["platform/dictionary.js"],"names":["layui","config","base","extend","index","use","$","form","common","consts","table","z_treeConfig","on","data","console","log","field","dictionary","server","add","obj","event","msg","layer","confirm","icon","title","delet","render","openFrom","val","Name","Code","Sort","open","Description","init","getDictionaryData","baseData","editFalge","click","btn","organ","Flag","Id","currData","clearForm","ajaxFun","then","res","appResult","isSucceeded","Text","renderTree","Result","renderTable","loadErrorText","fail","err","dataBean","basePostData","str1","JSON","stringify","reload","eidt","treeObj","callback","onClick","treeOnClick","elem","cols","sort","width","align","fixed","toolbar","flage","type","content","area","yes","layero","submit","trigger"],"mappings":"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","file":"../../../platform/dictionary.js","sourcesContent":["layui\r\n  .config({\r\n    base: \"../../../layuiadmin/\" //静态资源所在路径\r\n  })\r\n  .extend({\r\n    index: \"lib/index\" //主入口模块\r\n  })\r\n  .use([\"index\", \"table\", \"consts\", \"common\", \"z_treeConfig\"], function() {\r\n    var $ = layui.$,\r\n      form = layui.form,\r\n      consts = layui.consts,\r\n      common = layui.common,\r\n      table = layui.table;\r\n    z_treeConfig = layui.z_treeConfig;\r\n    //右侧表格页面管理\r\n\r\n    form.on(\"submit(DepartmentSub)\", function(data) {\r\n      console.log(data.field); //当前容器的全部表单字段;\r\n      dictionary.server.add(data.field);\r\n      return false; //阻止表单跳转。如果需要表单跳转，去掉这段即可。\r\n    });\r\n    //监听工具条\r\n    table.on(\"tool(dectionaryTable)\", function(obj) {\r\n      var data = obj.data;\r\n      console.log(data);\r\n      if (obj.event === \"del\") {\r\n        var msg = \"你确定要删除该数据吗?\";\r\n        layer.confirm(msg, { icon: 3, title: \"提示\" }, function(index) {\r\n          dictionary.server.delet(data);\r\n        });\r\n      } else if (obj.event === \"edit\") {\r\n        dictionary.render.openFrom(true);\r\n        form.val(\"DepartmentFrom\", {\r\n          Name: data.Name, // \"name\": \"value\"\r\n          Code: data.Code,\r\n          Sort: data.Sort,\r\n          open: false,\r\n          Description: \"我爱layui\"\r\n        });\r\n      }\r\n    });\r\n    //\r\n    //字典管理\r\n    var dictionary = {\r\n      init: function() {\r\n        dictionary.server.getDictionaryData();\r\n        dictionary.event();\r\n      },\r\n      baseData: {\r\n        baseData: {},\r\n        editFalge: false\r\n      },\r\n      event: function() {\r\n        $(\"#delet\").click(function() {\r\n          layer.confirm(\r\n            \"你确定要删除该数据吗?\",\r\n            {\r\n              btn: [\"确定\", \"取消\"], //按钮\r\n              icon: 3\r\n            },\r\n            function() {\r\n              console.log(\"确认\", data);\r\n              organ.server.delet(data.Flag, data.Id);\r\n            },\r\n            function() {\r\n              console.log(\"取消\");\r\n            }\r\n          );\r\n        });\r\n        //弹出层\r\n        $(\"#showDepartment\").click(function() {\r\n          dictionary.render.openFrom(false);\r\n          dictionary.currData.clearForm();\r\n        });\r\n      },\r\n      server: {\r\n        getDictionaryData: function(data) {\r\n          common\r\n            .ajaxFun(\"get\", \"/api/Dictionary/info/business/list\")\r\n            .then(function(res) {\r\n              if (common.appResult.isSucceeded(res)) {\r\n                console.log(res, \"返回数据\");\r\n                //渲染树\r\n                var data = [\r\n                  { Name: \"字段1\", Code: \"0001\", Sort: 1, Text: \"属性1\" },\r\n                  { Name: \"字段2\", Code: \"0002\", Sort: 2, Text: \"属性1\" }\r\n                ];\r\n                dictionary.render.renderTree(res.Result);\r\n                dictionary.render.renderTable(data);\r\n              } else {\r\n                common.appResult.loadErrorText(res);\r\n              }\r\n            })\r\n            .fail(err => {\r\n              console.log(err);\r\n            });\r\n        },\r\n        add: function(data) {\r\n          var dataBean = layui.consts.basePostData(\"CreateDictionaryInfo\");\r\n          dataBean.data = data;\r\n          var str1 = JSON.stringify(dataBean);\r\n          common\r\n            .ajaxFun(\"post\", \"/api/Dictionary/info\", str1)\r\n            .then(function(res) {\r\n              if (common.appResult.isSucceeded(res)) {\r\n                layer.msg(\"添加成功!\", { icon: 6 });\r\n                table.reload(\"LAY-user-manage\");\r\n              } else {\r\n                layer.msg(\"添加数据失败!\", { icon: 5 });\r\n                common.appResult.loadErrorText(res);\r\n              }\r\n            })\r\n            .fail(err => {\r\n              console.log(err);\r\n            });\r\n        },\r\n        eidt: function(data) {\r\n          var dataBean = layui.consts.basePostData(\"UpdateDictionaryInfo\");\r\n          dataBean.data = data;\r\n          var str1 = JSON.stringify(dataBean);\r\n          common\r\n            .ajaxFun(\"put\", \"/api/Dictionary/info\", str1)\r\n            .then(function(res) {\r\n              if (common.appResult.isSucceeded(res)) {\r\n                layer.msg(\"数据更新成功!\", { icon: 6 });\r\n                table.reload(\"LAY-user-manage\");\r\n              } else {\r\n                common.appResult.loadErrorText(res);\r\n              }\r\n            })\r\n            .fail(err => {\r\n              console.log(err);\r\n            });\r\n        },\r\n        delet: function(data) {\r\n          var dataBean = layui.consts.basePostData(\"RemoveDictionaryInfo\");\r\n          dataBean.data = data;\r\n          var str1 = JSON.stringify(dataBean);\r\n          common\r\n            .ajaxFun(\"DELETE\", \"/api/Dictionary/info\", str1)\r\n            .then(function(res) {\r\n              if (common.appResult.isSucceeded(res)) {\r\n                layer.msg(\"数据删除成功!\", { icon: 6 });\r\n                table.reload(\"LAY-user-manage\");\r\n              } else {\r\n                layer.msg(\"数据删除失败!\", { icon: 5 });\r\n                common.appResult.loadErrorText(res);\r\n              }\r\n            })\r\n            .fail(err => {\r\n              console.log(err);\r\n            });\r\n        }\r\n      },\r\n      render: {\r\n        renderTree: function(data) {\r\n          //渲染树 1.数据 2.DOM节点 3.配置项目\r\n          console.log(11);\r\n          dictionary.baseData.treeObj = layui.z_treeConfig.renderTree(\r\n            data,\r\n            \"treeDictionary\",\r\n            {\r\n              callback: {\r\n                onClick: dictionary.currData.treeOnClick\r\n              }\r\n            }\r\n          );\r\n        },\r\n        renderTable: function(data) {\r\n          table.render({\r\n            elem: \"#dectionaryTable\", //指定原始表格元素选择器（推荐id选择器）\r\n            data: data,\r\n            cols: [\r\n              [\r\n                {\r\n                  field: \"Code\",\r\n                  title: \"字段编码\"\r\n                },\r\n                { field: \"Name\", title: \"字段名\" },\r\n                { field: \"Sort\", title: \"排序\", sort: true },\r\n                {\r\n                  title: \"操作\",\r\n                  width: 150,\r\n                  align: \"center\",\r\n                  fixed: \"right\",\r\n                  toolbar: \"#table-tool\"\r\n                }\r\n              ]\r\n            ]\r\n          });\r\n        },\r\n        openFrom: function(flage) {\r\n          dictionary.baseData.editFalge = flage;\r\n          layer.open({\r\n            type: 1,\r\n            title: dictionary.baseData.editFalge ? \"编辑字典\" : \"添加字典\",\r\n            content: $(\"#DepartmentFrom\"),\r\n            area: \"500px\",\r\n            btn: [\"确定\", \"取消\"],\r\n            yes: function(index, layero) {\r\n              var submit = $(\"#DepartmentSub\");\r\n              submit.trigger(\"click\");\r\n            }\r\n          });\r\n        }\r\n      },\r\n      currData: {\r\n        //清空表单\r\n        clearForm: function() {\r\n          form.val(\"DepartmentFrom\", {\r\n            Name: \"\", // \"name\": \"value\"\r\n            Code: \"\",\r\n            Sort: \"\",\r\n            open: \"\",\r\n            Description: \"\"\r\n          });\r\n        }\r\n      }\r\n    };\r\n    dictionary.init();\r\n  });\r\n"]}
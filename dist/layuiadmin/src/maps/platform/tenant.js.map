{"version":3,"sources":["platform/tenant.js"],"names":["layui","config","base","extend","index","use","$","form","consts","common","table","haderSerch","isRenderdate","render","data","key","isrender","demo","dataBen","basePostData","IsEncryption","Data","DatetimeBegin","DatetimeEnd","PageIndex","PageSize","elem","url","setter","baseUrl","where","Sign","Method","Timestamp","Data.DatetimeBegin","Data.DatetimeEnd","Data.PageIndex","Data.PageSize","parseData","cols","field","width","title","minWidth","templet","d","ProvinceName","CityName","sort","util","toDateString","CreateDate","IsActived","ActivedTime","align","fixed","toolbar","loading","limit","text","none","tabelNoneText","on","console","log","obj","event","tenant","del","edit","active","init","baseData","nodeData","editFalge","layer","confirm","btn","icon","organ","server","delet","Id","add","openFrom","dataBean","str1","JSON","stringify","ajaxFun","then","res","appResult","isSucceeded","msg","reload","loadErrorText","fail","err","eidt","params","param","content","open","type","maxmin","area","yes","layero","iframeWindow","window","submitID","submit","find","contents","trigger","currData","this","call"],"mappings":"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","file":"../../../platform/tenant.js","sourcesContent":["layui\r\n  .config({\r\n    base: \"../../../layuiadmin/\" //静态资源所在路径\r\n  })\r\n  .extend({\r\n    index: \"lib/index\" //主入口模块\r\n  })\r\n  .use(\r\n    [\"index\", \"table\", \"consts\", \"common\", \"haderSerch\", \"laydate\"],\r\n    function() {\r\n      var $ = layui.$,\r\n        form = layui.form,\r\n        consts = layui.consts,\r\n        common = layui.common,\r\n        table = layui.table;\r\n      layui.haderSerch(\"#headerSerch\", {\r\n        isRenderdate: { render: \"请选择日期\" },\r\n        data: [\r\n          { key: \"关键字1\" },\r\n          { isrender: \"范围\" },\r\n          { demo: \"德玛\" }\r\n          // { demo1: \"德玛1\" },\r\n          // { demo2: \"德玛2\" },\r\n          // { demo3: \"德玛3\" }\r\n        ]\r\n      });\r\n      //获取\r\n      dataBen = consts.basePostData(\"CompanyPageSearch\");\r\n      delete dataBen.IsEncryption;\r\n      var Data = {\r\n        key: \"\",\r\n        DatetimeBegin: \"20180511\",\r\n        DatetimeEnd: \"20191230\",\r\n        PageIndex: 1,\r\n        PageSize: 1\r\n      };\r\n      dataBen.Data = Data;\r\n      var tenantTable = table.render({\r\n        elem: \"#LAY-user-manage\",\r\n        url: layui.setter.baseUrl + \"/api/Tenant/company/info/search\", //接口\r\n        where: {\r\n          Sign: consts.basePostData(\"CompanyPageSearch\").Sign,\r\n          Method: consts.basePostData(\"CompanyPageSearch\").Method,\r\n          Timestamp: consts.basePostData(\"CompanyPageSearch\").Timestamp,\r\n          \"Data.DatetimeBegin\": Data.DatetimeBegin,\r\n          \"Data.DatetimeEnd\": Data.DatetimeEnd,\r\n          \"Data.PageIndex\": Data.PageIndex,\r\n          \"Data.PageSize\": Data.PageSize\r\n        },\r\n        parseData: layui.setter.parseData,\r\n        // request: layui.setter.request,\r\n        cols: [\r\n          [\r\n            {\r\n              field: \"ComCoding\",\r\n              width: 100,\r\n              title: \"公司编码\"\r\n            },\r\n            { field: \"ComName\", title: \"公司名称\", minWidth: 100 },\r\n            { field: \"ComPassword\", title: \"公司密码\" },\r\n            { field: \"SassPassword\", title: \"sass平台密码\" },\r\n            {\r\n              field: \"ProvinceName\",\r\n              title: \"所在省市\",\r\n              templet: function(d) {\r\n                return \"<div>\" + d.ProvinceName + \"/\" + d.CityName + \"</div>\";\r\n              }\r\n            },\r\n            {\r\n              field: \"CreateDate\",\r\n              title: \"创建日期\",\r\n              sort: true,\r\n              templet: function(d) {\r\n                return (\r\n                  \"<div>\" + layui.util.toDateString(d.CreateDate) + \"</div>\"\r\n                );\r\n              }\r\n            },\r\n            {\r\n              field: \"公司状态\",\r\n              title: \"公司状态\",\r\n              templet: function(d) {\r\n                if (d.IsActived) {\r\n                  return `<a class=\"layui-btn layui-btn-normal layui-btn-xs\" lay-event=\"unActived\">已启用</a><a>${layui.util.toDateString(\r\n                    d.ActivedTime\r\n                  )}</a>`;\r\n                } else {\r\n                  return '<a class=\"layui-btn layui-btn-primary layui-btn-xs\" lay-event=\"active\">禁用中</a>';\r\n                }\r\n              }\r\n            },\r\n            {\r\n              title: \"操作\",\r\n              width: 150,\r\n              align: \"center\",\r\n              fixed: \"right\",\r\n              toolbar: \"#table-tool\"\r\n            }\r\n          ]\r\n        ],\r\n        loading: true,\r\n        // page: {},\r\n        limit: 10,\r\n        text: {\r\n          none: consts.tabelNoneText //默认：无数据。注：该属性为 layui 2.2.5 开始新增\r\n        }\r\n      });\r\n      //监听搜索\r\n      form.on(\"submit(searchbtn)\", function(data) {\r\n        var field = data.field;\r\n        console.log(field, \"搜索数据\");\r\n        //执行重载\r\n        // table.reload(\"LAY-user-manage\", {\r\n        //   where: field\r\n        // });\r\n      });\r\n      //监听工具条\r\n      table.on(\"tool(LAY-user-manage)\", function(obj) {\r\n        var data = obj.data;\r\n\r\n        if (obj.event === \"del\") {\r\n          tenant.event.del(data);\r\n        } else if (obj.event === \"edit\") {\r\n          tenant.event.edit(data);\r\n        } else if (obj.event === \"active\") {\r\n          tenant.event.active(data);\r\n        } else if (obj.event === \"unActived\") {\r\n          tenant.event.active(data);\r\n        }\r\n      });\r\n      //租户管理\r\n      var tenant = {\r\n        init: function() {},\r\n        baseData: {\r\n          nodeData: {},\r\n          editFalge: false\r\n        },\r\n        event: {\r\n          del: function(data) {\r\n            layer.confirm(\r\n              \"你确定要删除该数据吗?\",\r\n              {\r\n                btn: [\"确定\", \"取消\"], //按钮\r\n                icon: 3\r\n              },\r\n              function() {\r\n                console.log(\"确认\", data);\r\n                organ.server.delet({ Id: data.Id });\r\n              },\r\n              function() {\r\n                console.log(\"取消\");\r\n              }\r\n            );\r\n          },\r\n          add: function(data) {\r\n            tenant.baseData.editFalge = false;\r\n            tenant.render.openFrom({});\r\n          },\r\n          edit: function(data) {\r\n            tenant.baseData.editFalge = true;\r\n            tenant.render.openFrom(data);\r\n          },\r\n          active: function(data) {\r\n            console.log(data);\r\n            var title = data.IsActived\r\n              ? \"你确定要<strong>停用</strong>该数据吗?\"\r\n              : \"你确定要<strong>启用</strong>该数据吗?\";\r\n            layer.confirm(\r\n              title,\r\n              {\r\n                btn: [\"确定\", \"取消\"], //按钮\r\n                icon: 3\r\n              },\r\n              function() {\r\n                tenant.server.active({\r\n                  Id: data.Id,\r\n                  IsActived: !data.IsActived\r\n                });\r\n              },\r\n              function() {\r\n                console.log(\"取消\");\r\n              }\r\n            );\r\n          }\r\n        },\r\n        server: {\r\n          add: function(data) {\r\n            var dataBean = layui.consts.basePostData(\"PushCompanyInfo\");\r\n            dataBean.data = data;\r\n            var str1 = JSON.stringify(dataBean);\r\n            common\r\n              .ajaxFun(\"post\", \"/api/Tenant/company/info/push\", str1)\r\n              .then(function(res) {\r\n                if (common.appResult.isSucceeded(res)) {\r\n                  layer.msg(\"添加成功!\", { icon: 6 });\r\n                  table.reload(\"LAY-user-manage\");\r\n                } else {\r\n                  layer.msg(\"添加数据失败!\", { icon: 5 });\r\n                  common.appResult.loadErrorText(res);\r\n                }\r\n              })\r\n              .fail(err => {\r\n                console.log(err);\r\n              });\r\n          },\r\n          eidt: function(data) {\r\n            var dataBean = layui.consts.basePostData(\"UpdateCompanyInfo\");\r\n            dataBean.data = data;\r\n            var str1 = JSON.stringify(dataBean);\r\n            common\r\n              .ajaxFun(\"put\", \"/api/Tenant/company/info\", str1)\r\n              .then(function(res) {\r\n                if (common.appResult.isSucceeded(res)) {\r\n                  layer.msg(\"数据更新成功!\", { icon: 6 });\r\n                  table.reload(\"LAY-user-manage\");\r\n                } else {\r\n                  common.appResult.loadErrorText(res);\r\n                }\r\n              })\r\n              .fail(err => {\r\n                console.log(err);\r\n              });\r\n          },\r\n          active: function(data) {\r\n            var dataBean = layui.consts.basePostData(\"UpdateCompanyActived\");\r\n            dataBean.data = data;\r\n            var str1 = JSON.stringify(dataBean);\r\n            common\r\n              .ajaxFun(\"put\", \"/api/Tenant/company/info/actived\", str1)\r\n              .then(function(res) {\r\n                if (common.appResult.isSucceeded(res)) {\r\n                  layer.msg(\"数据更新成功!\", { icon: 6 });\r\n                  table.reload(\"LAY-user-manage\");\r\n                } else {\r\n                  common.appResult.loadErrorText(res);\r\n                }\r\n              })\r\n              .fail(err => {\r\n                console.log(err);\r\n              });\r\n          },\r\n          delet: function(data) {\r\n            var dataBean = layui.consts.basePostData(\"RemoveCompanyInfo\");\r\n            dataBean.data = data;\r\n            var str1 = JSON.stringify(dataBean);\r\n            common\r\n              .ajaxFun(\"DELETE\", \"/api/Tenant/company/info\", str1)\r\n              .then(function(res) {\r\n                if (common.appResult.isSucceeded(res)) {\r\n                  layer.msg(\"数据删除成功!\", { icon: 6 });\r\n                  table.reload(\"LAY-user-manage\");\r\n                } else {\r\n                  layer.msg(\"数据删除成功!\", { icon: 5 });\r\n                  common.appResult.loadErrorText(res);\r\n                }\r\n              })\r\n              .fail(err => {\r\n                console.log(err);\r\n              });\r\n          }\r\n        },\r\n        render: {\r\n          openFrom: function(data) {\r\n            var title = tenant.baseData.editFalge ? \"编辑租户\" : \"添加租户\";\r\n            var params = $.param(data);\r\n            console.log(params);\r\n            var content = !tenant.baseData.editFalge\r\n              ? \"../tpl/from/tenant.html\"\r\n              : \"../tpl/from/tenant.html?\" + params;\r\n            layer.open({\r\n              type: 2,\r\n              title: title,\r\n              content: content,\r\n              maxmin: true,\r\n              area: [\"1000px\", \"320px\"],\r\n              btn: [\"确定\", \"取消\"],\r\n              yes: function(index, layero) {\r\n                var iframeWindow = window[\"layui-layer-iframe\" + index],\r\n                  submitID = \"LAY-user-front-submit\",\r\n                  submit = layero\r\n                    .find(\"iframe\")\r\n                    .contents()\r\n                    .find(\"#\" + submitID);\r\n                //监听提交\r\n                iframeWindow.layui.form.on(\"submit(\" + submitID + \")\", function(\r\n                  data\r\n                ) {\r\n                  var field = data.field; //获取提交的字段\r\n                  console.log(field, \"数据提交\");\r\n\r\n                  if (tenant.baseData.editFalge) {\r\n                    tenant.server.eidt(field);\r\n                  } else {\r\n                    tenant.server.add(field);\r\n                  }\r\n\r\n                  // layer.close(index); //关闭弹层\r\n                });\r\n\r\n                submit.trigger(\"click\");\r\n              }\r\n            });\r\n          }\r\n        },\r\n        currData: {}\r\n      };\r\n\r\n      $(\"body .layui-btn\").on(\"click\", function() {\r\n        var type = $(this).data(\"type\");\r\n\r\n        tenant.event[type] ? tenant.event[type].call(this) : \"\";\r\n      });\r\n    }\r\n  );\r\n"]}
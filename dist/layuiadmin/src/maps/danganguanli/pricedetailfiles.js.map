{"version":3,"sources":["danganguanli/pricedetailfiles.js"],"names":["layui","config","base","extend","index","use","$","form","table","layer","utils","tree","ztree","jquery_ztree_excheck","ladderType","common","surchargeType","surchargeStartType","on","data","field","console","log","reload","where","render","elem","url","setter","revenueUrl","parseData","request","Method","Data.CompanyCoding","cols","title","templet","d","PriceName","PriceCoding","Me","PriceVersion","BasePrice","IsLadder","util","toDateString","CreateDate","width","align","fixed","toolbar","loading","page","limit","text","none","consts","obj","event","active","Tip","Data","Id","edit","type","haveArray","JSON","stringify","getLadderType","res","IsSucceed","Result","errorMessage","Errors","Message","msg","icon","err","getSurchargeType","getSurchargeStartType","getSomeTypes","method","result","insertPriceDetail","params","contentType","addPriceDetail","Idd","PriceTypeID","editPriceDetail","delPriceDetail","export","create","content","param","open","maxmin","area","btn","yes","layero","iframeWindow","window","submitID","submit","find","contents","PriceStartDateTime","Date","toISOString","PriceEndDateTime","close","trigger","btn2","cancel","parseParams","parse","passFields","delete","confirm","this","call"],"mappings":"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","file":"../../../danganguanli/pricedetailfiles.js","sourcesContent":["layui\r\n  .config({\r\n    base: \"../../../layuiadmin/\" //静态资源所在路径\r\n  })\r\n  .extend({\r\n    index: \"lib/index\" //主入口模块\r\n  })\r\n  .use(\r\n    [\r\n      \"index\",\r\n      \"table\",\r\n      \"layer\",\r\n      \"tree\",\r\n      \"jquery_ztree_excheck\",\r\n      \"utils\",\r\n      \"common\",\r\n      \"consts\"\r\n    ],\r\n    function () {\r\n      var $ = layui.$,\r\n        form = layui.form,\r\n        table = layui.table,\r\n        layer = layui.layer,\r\n        tree = layui.tree,\r\n        ztree = layui.ztree,\r\n        jquery_ztree = layui.jquery_ztree_excheck,\r\n        utils = layui.utils,\r\n        common = layui.common,\r\n        ladderType = [],\r\n        surchargeType = [],\r\n        surchargeStartType = [];\r\n\r\n\r\n      //监听搜索\r\n      form.on(\"submit(Handler-search)\", function (data) {\r\n        var field = data.field;\r\n        console.log(data, \"数据\");\r\n\r\n        //执行重载\r\n        table.reload(\"priceDetailFilesTable\", {\r\n          where: field\r\n        });\r\n      });\r\n\r\n      // 表格渲染\r\n      var priceDetailFilesTable = table.render({\r\n        elem: \"#priceDetailFilesTable\",\r\n        url: layui.setter.revenueUrl + \"/api/PriceDetail/query/list\", //接口\r\n        parseData: layui.setter.parseData,\r\n        request: layui.setter.request,\r\n        where: {\r\n          Method: \"list\",\r\n          \"Data.CompanyCoding\": \"string\"\r\n        }, // 传递给接口的参数\r\n        // request: { CompanyCoding: \"string\" }, // 传递给请求头\r\n        cols: [\r\n          [\r\n            {\r\n              // width: 100,\r\n              title: \"价格类型名称\",\r\n              templet: function (d) {\r\n                return d.PriceName;\r\n              }\r\n            },\r\n            {\r\n              title: \"价格类型编号\",\r\n              templet: function (d) {\r\n                return d.PriceCoding;\r\n              }\r\n            },\r\n            {\r\n              title: \"价格版本\",\r\n              templet: function (d) {\r\n                return d.Me.PriceVersion;\r\n              }\r\n            },\r\n            {\r\n              title: \"基础价格\",\r\n              templet: function (d) {\r\n                return d.Me.BasePrice;\r\n              }\r\n            },\r\n            {\r\n              title: \"是否启用阶梯\",\r\n              templet: function (d) {\r\n                return (d.Me.IsLadder === true) ? \"是\" : \"否\";\r\n              }\r\n            },\r\n            {\r\n              title: \"创建时间\",\r\n              templet: function (d) {\r\n                // console.log(d, \"创建时间\");\r\n                return (\r\n                  \"<div>\" + layui.util.toDateString(d.Me.CreateDate) + \"</div>\"\r\n                );\r\n              }\r\n            },\r\n            {\r\n              title: \"操作\",\r\n              width: 150,\r\n              align: \"center\",\r\n              fixed: \"right\",\r\n              toolbar: \"#table-Handler\"\r\n            }\r\n          ]\r\n        ],\r\n        loading: true,\r\n        page: true,\r\n        limit: 10,\r\n        text: {\r\n          none: layui.consts[\"DATA_NO\"] //默认：无数据。注：该属性为 layui 2.2.5 开始新增\r\n        }\r\n      });\r\n\r\n      //监听工具条\r\n      table.on(\"tool(table-Handler)\", function (obj) {\r\n        console.log(obj.event, \"obj 监听工具条\");\r\n\r\n        // 删除\r\n        if (obj.event === \"delete\") {\r\n          active.delete({\r\n            Tip: \"是否确认删除？\",\r\n            // Sign: \"string\",\r\n            Method: \"remove\",\r\n            // Timestamp: 0,\r\n            Data: { Id: obj.data.Me.Id }\r\n          });\r\n        }\r\n\r\n        // 编辑\r\n        if (obj.event === \"edit\") {\r\n          active.edit({\r\n            type: obj.event,\r\n            haveArray: true,\r\n            ladderType: JSON.stringify(ladderType),\r\n            surchargeType: JSON.stringify(surchargeType),\r\n            surchargeStartType: JSON.stringify(surchargeStartType),\r\n            data: JSON.stringify([obj.data])\r\n          });\r\n        }\r\n      });\r\n\r\n      //服务交互\r\n      var request = {\r\n        //获取阶梯类型\r\n        getLadderType() {\r\n          utils.request(\r\n            \"/api/PriceDetail/priceladdertypestatus\",\r\n            { Method: \"priceladdertypestatus\" },\r\n            \"GET\",\r\n            function (res) {\r\n              if (res.IsSucceed) {\r\n                ladderType = res.Result;\r\n              } else {\r\n                var errorMessage = res.Errors[0].Message;\r\n                layer.msg(errorMessage, {\r\n                  icon: 5\r\n                });\r\n              }\r\n            },\r\n            function (err) {\r\n              console.log(err, \"err\");\r\n            }\r\n          );\r\n        },\r\n        //获取滞纳金类型\r\n        getSurchargeType() {\r\n          utils.request(\r\n            \"/api/PriceDetail/pricesurchargetypestatus\",\r\n            { Method: \"pricesurchargetypestatus\" },\r\n            \"GET\",\r\n            function (res) {\r\n              if (res.IsSucceed) {\r\n                surchargeType = res.Result;\r\n              } else {\r\n                var errorMessage = res.Errors[0].Message;\r\n                layer.msg(errorMessage, {\r\n                  icon: 5\r\n                });\r\n              }\r\n            },\r\n            function (err) {\r\n              console.log(err, \"err\");\r\n            }\r\n          );\r\n        },\r\n        //获取滞纳金开始日类型\r\n        getSurchargeStartType() {\r\n          utils.request(\r\n            \"/api/PriceDetail/pricesurchargestarttypestatus\",\r\n            { Method: \"pricesurchargestarttypestatus\" },\r\n            \"GET\",\r\n            function (res) {\r\n              if (res.IsSucceed) {\r\n                surchargeStartType = res.Result;\r\n              } else {\r\n                var errorMessage = res.Errors[0].Message;\r\n                layer.msg(errorMessage, {\r\n                  icon: 5\r\n                });\r\n              }\r\n            },\r\n            function (err) {\r\n              console.log(err, \"err\");\r\n            }\r\n          );\r\n        },\r\n        getSomeTypes(method, result) {\r\n          utils.request(\r\n            \"/api/PriceDetail/\" + method,\r\n            { Method: method },\r\n            \"GET\",\r\n            function (res) {\r\n              if (res.IsSucceed) {\r\n                result = res.Result;\r\n              } else {\r\n                var errorMessage = res.Errors[0].Message;\r\n                layer.msg(errorMessage, {\r\n                  icon: 5\r\n                });\r\n              }\r\n            },\r\n            function (err) {\r\n              console.log(err, \"err\");\r\n            }\r\n          );\r\n        },\r\n        // 插入新价格明细\r\n        insertPriceDetail(params) {\r\n          utils.request(\r\n            \"/api/PriceDetail/insert\",\r\n            params,\r\n            \"POST\",\r\n            function (res) {\r\n              // console.log(res, \"res\");\r\n              if (res.IsSucceed) {\r\n                // 重载表格\r\n                table.reload(\"priceDetailFilesTable\");\r\n\r\n                layer.msg(\"新增成功\", {\r\n                  icon: 1\r\n                });\r\n              } else {\r\n                var errorMessage = res.Errors[0].Message;\r\n                layer.msg(errorMessage, {\r\n                  icon: 5\r\n                });\r\n              }\r\n            },\r\n            function (err) {\r\n              console.log(err, \"err\");\r\n            },\r\n            {\r\n              contentType: \"application/json\"\r\n            }\r\n          );\r\n        },\r\n        // 新增价格明细\r\n        addPriceDetail(params) {\r\n          utils.request(\r\n            \"/api/Common/GetInsertGuid\",\r\n            {},\r\n            \"GET\",\r\n            function (res) {\r\n              console.log(res, \"获取 Guid res\");\r\n              if (res.IsSucceed) {\r\n                // 获取到的Guid赋值给params\r\n                params.Data.Idd = res.Result;\r\n                params.Data.PriceTypeID = res.Result;\r\n                // 插入新价格明细\r\n                request.insertPriceDetail(params);\r\n              } else {\r\n                layer.msg(\"获取Guid失败\", {\r\n                  icon: 5\r\n                });\r\n              }\r\n            },\r\n            function (err) {\r\n              console.log(err, \"获取 Guid err\");\r\n            }\r\n          );\r\n        },\r\n        // 修改价格明细\r\n        editPriceDetail(params) {\r\n          utils.request(\r\n            \"/api/PriceDetail/update\",\r\n            params,\r\n            \"PUT\",\r\n            function (res) {\r\n              // console.log(res, \"res\");\r\n              if (res.IsSucceed) {\r\n                // 重载表格\r\n                table.reload(\"priceDetailFilesTable\");\r\n\r\n                layer.msg(\"修改成功\", {\r\n                  icon: 1\r\n                });\r\n              } else {\r\n                var errorMessage = res.Errors[0].Message;\r\n                layer.msg(errorMessage, {\r\n                  icon: 5\r\n                });\r\n              }\r\n            },\r\n            function (err) {\r\n              console.log(err, \"err\");\r\n            },\r\n            {\r\n              contentType: \"application/json\"\r\n            }\r\n          );\r\n        },\r\n        // 删除价格明细\r\n        delPriceDetail(params) {\r\n          // console.log(params, \"调用接口: /api/PriceDetail/remove\");\r\n          utils.request(\r\n            \"/api/PriceDetail/remove\",\r\n            params,\r\n            \"DELETE\",\r\n            function (res) {\r\n              // console.log(res, \"res\");\r\n              if (res.IsSucceed) {\r\n                // 重载表格\r\n                table.reload(\"priceDetailFilesTable\");\r\n\r\n                layer.msg(\"删除成功\", {\r\n                  icon: 1\r\n                });\r\n              } else {\r\n                layer.msg(\"删除失败\", {\r\n                  icon: 5\r\n                });\r\n              }\r\n            },\r\n            function (err) {\r\n              console.log(err, \"err\");\r\n            },\r\n            {\r\n              contentType: \"application/json\"\r\n            }\r\n          );\r\n        }\r\n      };\r\n      // 获取树形菜单数据\r\n      // request.getArea({ CompanyCoding: \"string\" });\r\n\r\n      //事件\r\n      var active = {\r\n        export: function () {\r\n          console.log(\"导出数据\");\r\n        },\r\n        create: function (params) {\r\n          console.log(\"新增\");\r\n\r\n          var content = \"../tpl/from/priceDetailForm.html?\" + $.param(params);\r\n\r\n          layer.open({\r\n            type: 2,\r\n            title: \"新增价格明细\",\r\n            content,\r\n            maxmin: true,\r\n            area: [\"700px\", \"400px\"],\r\n            btn: [\"确定\", \"取消\"],\r\n            yes: function (index, layero) {\r\n              console.log(\"点击确定\");\r\n              var iframeWindow = window[\"layui-layer-iframe\" + index],\r\n                submitID = \"LAY-pricetype-files-submit\",\r\n                submit = layero\r\n                  .find(\"iframe\")\r\n                  .contents()\r\n                  .find(\"#\" + submitID);\r\n              //监听提交\r\n              iframeWindow.layui.form.on(\"submit(\" + submitID + \")\", function (\r\n                data\r\n              ) {\r\n                var field = data.field; //获取提交的字段\r\n                //时间转utc(????待验证是否需要如此操作)\r\n                field.PriceStartDateTime= new Date(field.PriceStartDateTime).toISOString()\r\n                field.PriceEndDateTime= new Date(field.PriceEndDateTime).toISOString()\r\n                var params = { Method: \"insert\", Data: field };\r\n                console.log(params, \"新增价格明细 params\");\r\n\r\n                // 新增价格明细\r\n                request.addPriceDetail(params);\r\n\r\n                layer.close(index); //关闭弹层\r\n              });\r\n              submit.trigger(\"click\");\r\n            },\r\n            btn2: function () {\r\n              console.log(\"点击取消\");\r\n            },\r\n            cancel: function () {\r\n              console.log(\"点击取消\");\r\n            }\r\n          });\r\n        },\r\n        edit: function (params) {\r\n          console.log(\"编辑\");\r\n\r\n          var content = \"../tpl/from/priceDetailForm.html?\" + $.param(params);\r\n          // console.log(content, \"content\");\r\n          layer.open({\r\n            type: 2,\r\n            title: \"编辑价格明细\",\r\n            content,\r\n            maxmin: true,\r\n            area: [\"700px\", \"400px\"],\r\n            btn: [\"确定\", \"取消\"],\r\n            yes: function (index, layero) {\r\n              console.log(\"点击确定\");\r\n              var iframeWindow = window[\"layui-layer-iframe\" + index],\r\n                submitID = \"LAY-pricetype-files-submit\",\r\n                submit = layero\r\n                  .find(\"iframe\")\r\n                  .contents()\r\n                  .find(\"#\" + submitID);\r\n              //监听提交\r\n              iframeWindow.layui.form.on(\"submit(\" + submitID + \")\", function (\r\n                data\r\n              ) {\r\n                var parseParams = JSON.parse(params.data)[0];\r\n                var field = $.extend({}, data.field, { Id: parseParams.Id }); //获取提交的字段\r\n                var passFields = { Method: \"update\", Data: field };\r\n                console.log(passFields, \"passFields\");\r\n\r\n                // 修改价格明细\r\n                request.editPriceDetail(passFields);\r\n\r\n                layer.close(index); //关闭弹层\r\n              });\r\n              submit.trigger(\"click\");\r\n            },\r\n            btn2: function () {\r\n              console.log(\"点击取消\");\r\n            },\r\n            cancel: function () {\r\n              console.log(\"点击取消\");\r\n            }\r\n          });\r\n        },\r\n        delete: function (params) {\r\n          console.log(\"删除\", params);\r\n\r\n          layer.confirm(params.Tip, { icon: 3, title: \"删除提示\" }, function () {\r\n            console.log(params.Data.Id, \"待删除的ID\");\r\n\r\n            // 删除价格明细\r\n            request.delPriceDetail(params);\r\n          });\r\n        }\r\n      };\r\n\r\n      //按钮操作\r\n      $(\".layui-btn\").on(\"click\", function () {\r\n        var type = $(this).data(\"type\");\r\n        active[type]\r\n          ? active[type].call(this, {\r\n            type,\r\n            haveArray: true,\r\n            ladderType: JSON.stringify(ladderType),\r\n            surchargeType: JSON.stringify(surchargeType),\r\n            surchargeStartType: JSON.stringify(surchargeStartType),\r\n            data: []\r\n          })\r\n          : \"\";\r\n      });\r\n\r\n      //获取阶梯类型,滞纳金类型,滞纳金开启日类型\r\n      request.getLadderType();\r\n      request.getSurchargeType();\r\n      request.getSurchargeStartType();\r\n    }\r\n  );\r\n"]}
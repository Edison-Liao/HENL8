/** layuiAdmin.std-v1.0.0 LPPL License By http://www.layui.com/admin/ */
 ;"use strict";layui.config({base:"../../../layuiadmin/"}).extend({index:"lib/index"}).use(["index","table","layer","tree","common","consts","haderSerch","laydate"],function(){var e=layui.$,t=layui.form,a=layui.table,i=layui.layer,r=(layui.tree,layui.laydate),n=layui.common,o={baseUrl:layui.setter.revenueUrl},d={};r.render({elem:"#LadderDatetime",range:!0}),r.render({elem:"#PriceDateTime",range:!0}),r.render({elem:"#PriceSurchargeStar"}),e("body").on("mousedown",".layui-tree a",function(){e(this).siblings("ul").length||(e(".layui-tree a cite").css("color","#333"),e(this).find("cite").css("color","red"))}),a.on("tool()",function(a){var r=a.data,d=a.event;a.tr;"detail"===d&&(console.info(r),n.ajaxFun("get","/api/PriceDetail/query/key?Data.Id="+r.Me.Id+"&Method=key","",o).then(function(a){if(n.appResult.isSucceeded(a)){var r=a.Result.Me;i.open({type:1,title:"查看价格版本详情",content:e("#lock-detail-from"),maxmin:!0,area:["800px","400px"],btn:["关闭"]}),console.info(r),t.val("lock-detail-from",{PriceVersion:r.PriceVersion,BasePrice:r.BasePrice,IsLadder:r.IsLadder,PriceLadderType:r.PriceLadderType,PriceLadderTypeName:r.PriceLadderTypeName,LadderCycleValue:r.LadderCycleValue,LadderDatetime:r.LadderStartDatetime.substr(0,10),IsSale:r.IsSale,LadderGas1:r.LadderGas1,LadderPrice1:r.LadderPrice1,LadderGas2:r.LadderGas2,LadderPrice2:r.LadderPrice2,LadderGas3:r.LadderGas3,LadderPrice3:r.LadderPrice3,LadderGas4:r.LadderGas4,LadderPrice4:r.LadderPrice4,BasePersonCount:r.BasePersonCount,PersonLadderAdd1:r.PersonLadderAdd1,PersonLadderAdd2:r.PersonLadderAdd2,PersonLadderAdd3:r.PersonLadderAdd3,PersonLadderAdd4:r.PersonLadderAdd4,IsSurcharge:r.IsSurcharge,priceSurcharge:r.priceSurcharge,PriceSurchargeStart:r.PriceSurchargeStart,PriceSurchargeValue:r.PriceSurchargeValue,PriceSurchargeDelayMonth:r.PriceSurchargeDelayMonth,PriceSurchargeDelayDay:r.PriceSurchargeDelayDay,PriceDateTime:r.PriceStartDateTime.substr(0,10)+" - "+r.PriceEndDateTime.substr(0,10),SortNum:r.SortNum,Description:r.Description})}else n.appResult.loadErrorText(a)}).fail(function(e){console.log(e)}))});var l={init:function(){this.server.getTreeData(),this.render.showtips(),this.event()},baseData:{treeNode:{},id:"",nodeData:{},editFalge:!1},event:function(){e("#refresh").click(function(){e("#treeOrgan").html(""),l.server.getTreeData(),l.baseData.editFalge=!1}),e("#addPriceType").click(function(){i.open({type:1,title:"添加价格类型",content:e("#lock-from"),maxmin:!0,area:["800px","400px"],btn:["确定","取消"],yes:function(a,i){var r=e("#LAY-jiageleixing-add-submit");t.on("submit(LAY-jiageleixing-add-submit)",function(e){var t=e.field;n.ajaxFun("get","/api/Common/GetInsertGuid","",o).then(function(e){n.appResult.isSucceeded(e)?(t.Idd=e.Result,console.info(t),l.server.addType(t)):n.appResult.loadErrorText(e)}).fail(function(e){console.log(e)})}),r.trigger("click")}})}),e("#addPriceVersion").click(function(){return console.info("addPriceVersion"),"{}"==JSON.stringify(d)?void i.msg("未选择价格类型，请选择后再进行修改操作",{icon:5}):(e("#lock-detail-from").find("input[type=text],select,input[type=hidden]").each(function(){e(this).val("")}),void i.open({type:1,title:"添加价格版本",content:e("#lock-detail-from"),maxmin:!0,area:["800px","400px"],btn:["确定","取消"],yes:function(a,i){var r=e("#LAY-jiagebanben-add-submit");t.on("submit(LAY-jiagebanben-add-submit)",function(e){var t=e.field;t.PriceTypeID=d.Id,n.ajaxFun("get","/api/Common/GetInsertGuid","",o).then(function(e){if(n.appResult.isSucceeded(e)){t.Idd=e.Result;var a=t.LadderDatetime.split(" "),i=t.PriceDateTime.split(" ");t.PriceStartDateTime=i[0],t.PriceEndDateTime=i[2],t.LadderStartDatetime=a[0],t.LadderEndDatetime=a[2],t.IsLadder="on"==t.IsLadder,t.IsSale="on"==t.IsSale,t.IsSurcharge="on"==t.IsSurcharge,delete t.PriceDateTime,delete t.LadderDatetime,l.server.addVer(t)}else n.appResult.loadErrorText(e)}).fail(function(e){console.log(e)})}),r.trigger("click")}}))}),e("#edtPriceType").click(function(){return console.info(d),"{}"==JSON.stringify(d)?void i.msg("未选择价格类型，请选择后再进行修改操作",{icon:5}):(i.open({type:1,title:"修改用气类型",content:e("#lock-from"),maxmin:!0,area:["800px","400px"],btn:["确定","取消"],yes:function(a,i){var r=e("#LAY-jiageleixing-add-submit");t.on("submit(LAY-jiageleixing-add-submit)",function(e){var t=e.field;console.info(t),l.server.edit(t)}),r.trigger("click")}}),void t.val("lock-from",{Coding:d.Coding,Name:d.Name,CompanyCoding:d.CompanyCoding,Status:d.Status,MonthLimitGas:d.MonthLimitGas,YearLimitGas:d.YearLimitGas,SortNum:d.SortNum,Description:d.Description}))}),e("#delPriceType").click(function(){return console.info(d),"{}"==JSON.stringify(d)?void i.msg("未选择价格类型，请选择后再进行删除操作",{icon:5}):void i.confirm("真的删除行么",function(){console.info(d),l.server["delete"](d.Id)})})},server:{getTreeData:function(){var e=layui.consts.basePostData();e.Data={},e.Data.PageIndex="1",e.Data.PageSize="100",e.Method="list",console.log(e);JSON.stringify(e);n.ajaxFun("get","/api/PriceType/query/list/?Data.PageIndex="+e.Data.PageIndex+"&Data.PageSize="+e.Data.PageSize+"&Method=list","",o).then(function(e){if(n.appResult.isSucceeded(e)){var t=function(e){if(e.length>0)for(var t=0;t<e.length;t++)e[t].name=e[t].Name;return e};console.log(e.Result);var a=e.Result.DataSource,i=t(a);l.render.renderTree(i)}else n.appResult.loadErrorText(e)}).fail(function(e){console.log(e)})},addType:function(t,a,r){var d=layui.consts.basePostData();d.Data=t,d.Data.CompanyCoding="88888888",d.Data.CompanyName="88888888",d.Method="insert";var s=JSON.stringify(d);i.load(),n.ajaxFun("post","/api/PriceType/insert",s,o).then(function(t){n.appResult.isSucceeded(t)?(e("#lock-from").find("input[type=text],select,input[type=hidden]").each(function(){e(this).val("")}),e("#treeOrgan").html(""),l.server.getTreeData(),i.msg("数据添加成功!",{icon:6})):n.appResult.loadErrorText(t)}).fail(function(e){console.log(e)}),i.closeAll()},addVer:function(t,r,d){var l=layui.consts.basePostData();l.Data=t,l.Method="insert";var s=JSON.stringify(l);i.load(),n.ajaxFun("post","/api/PriceDetail/insert",s,o).then(function(t){n.appResult.isSucceeded(t)?(e("#lock-from").find("input[type=text],select,input[type=hidden]").each(function(){e(this).val("")}),a.reload("LAY-jiagebanbenTable"),i.msg("数据添加成功!",{icon:6})):n.appResult.loadErrorText(t)}).fail(function(e){console.log(e)}),i.closeAll()},edit:function(t,a){i.load();var r=layui.consts.basePostData();r.Data=t,r.Data.CompanyCoding="88888888",r.Data.CompanyName="88888888",r.Data.Id=d.Id,r.Method="update",console.log(t);var s=JSON.stringify(r);n.ajaxFun("put","/api/PriceType/update",s,o).then(function(t){n.appResult.isSucceeded(t)?(e("#lock-from").find("input[type=text],select,input[type=hidden]").each(function(){e(this).val("")}),e("#treeOrgan").html(""),l.server.getTreeData(),i.msg("数据修改成功!",{icon:6})):n.appResult.loadErrorText(t)}).fail(function(e){console.log(e)}),i.closeAll()},"delete":function(a){i.load();var r=layui.consts.basePostData();r.Data=a,r.Method="remove",console.log(r);var d=JSON.stringify(r);n.ajaxFun("delete","/api/PriceType/remove",d,o).then(function(a){n.appResult.isSucceeded(a)?(e("#treeOrgan").html(""),l.server.getTreeData(),i.msg("数据删除成功!",{icon:6}),t.val("PriceTypeFrom",{Coding:"",Name:"",CompanyCoding:"",Status:"",MonthLimitGas:"",YearLimitGas:"",SortNum:"",Description:""})):n.appResult.loadErrorText(a)}).fail(function(e){console.log(e)})}},render:{renderTree:function(e){layui.tree({elem:"#treeOrgan",target:"_blank",click:function(e){d=e,t.val("PriceTypeFrom",{Coding:d.Coding,Name:d.Name,CompanyCoding:d.CompanyCoding,Status:d.Status,MonthLimitGas:d.MonthLimitGas,YearLimitGas:d.YearLimitGas,SortNum:d.SortNum,Description:d.Description});a.render({elem:"#LAY-jiagebanbenTable",id:"LAY-jiagebanbenTable",url:layui.setter.revenueUrl+"/api/PriceDetail/query/list",where:{"Data.PriceTypeId":d.Id,Method:"list"},parseData:layui.setter.parseData,request:layui.setter.request,page:!0,cols:[[{field:"PriceVersion",title:"价格版本",templet:function(e){return e.Me.PriceVersion}},{field:"IsLadder",title:"是否有阶梯",templet:function(e){return e.Me.IsLadder?"是":"无"}},{field:"BasePrice",title:"基础价格",templet:function(e){return e.Me.BasePrice}},{field:"LadderStartDatetime",title:"阶梯开始时间",templet:function(e){return"<div>"+layui.util.toDateString(e.LadderStartDatetime)+"</div>"}},{field:"PriceStartDateTime",title:"价格开始时间",templet:function(e){return"<div>"+layui.util.toDateString(e.Me.PriceStartDateTime)+"</div>"}},{title:"操作",fixed:"right",align:"center",toolbar:"#LAY-jiagebanbenTable-barOperation"}]],loading:!0,limit:10,text:"对不起，加载出现异常！"})},nodes:e})},renderTitle:function(t){"roleCatalog"===t?e("#formTitle").html("编辑角色信息分组"):"roleInfo"===t&&e("#formTitle").html("编辑角色信息")},showtips:function(){n.showtips(".layui-btn-group button")},openDeleteConfirm:function(e){i.confirm("你确定要删除<span style='font-weight:bolder'>"+e.Title+"</span>的节点吗?",{btn:["确定","取消"],icon:3},function(){l.server.delet(e.Flag,e.Id)},function(){console.log("取消")})}},currData:{getTreeNodeName:function(t,a){var i=n.getTreeNodeName(t,a,"name");e(".topName").val(i),e(".submit").html("立即修改")}}};l.init()});
//# sourceMappingURL=../src/maps/xitongguanli/jiageguanli.js.map

/** layuiAdmin.std-v1.0.0 LPPL License By http://www.layui.com/admin/ */
 ;"use strict";layui.config({base:"../../../layuiadmin/"}).extend({index:"lib/index"}).use(["index","table","layer","common","consts","z_treeConfig"],function(){var e=layui.$,a=layui.form,t=(layui.table,layui.layer),o=(layui.tree,layui.common);layui.z_treeConfig;a.on("submit(DepartmentFrom)",function(e){return console.log(e.field,"新增部门"),delete e.field.topName,n.baseData.editFalge?(console.log("执行编辑命令"),n.server.eidtOrgan(e.field,"/api/Role","department")):(n.server.addOrgan(e.field,"/api/Role","department"),console.log("执行添加命令")),!1}),a.on("submit(staffFrom)",function(e){return delete e.field.topName,console.log("新增"),n.baseData.editFalge?n.server.eidtOrgan(e.field,"/api/Role","staff"):n.server.addOrgan(e.field,"/api/Role","staff"),!1});var n={init:function(){this.server.getTreeData(),this.render.showtips(),this.event()},baseData:{treeObj:{},id:"",nodeData:{},sunNodeFalge:!1,editFalge:!1},event:function(){e("#refresh").click(function(){e("#treeOrgan").html(""),n.server.getTreeData(),n.baseData.editFalge=!1,n.baseData.sunNodeFalge=!1,o.isDisableButton("#delet",!0),o.isDisableButton("#delet",!0)}),e("#showDepartment").click(function(){e("#formTitle").html("新增区域信息"),e(".submit").html("立即提交"),a.val("DepartmentFrom",{topName:n.baseData.nodeData.Title}),n.baseData.editFalge=!1,n.baseData.sunNodeFalge=!1}),e("#showStaff").click(function(){e("#formTitle").html("新增子域信息"),e(".submit").html("立即提交"),n.baseData.sunNodeFalge=!0,n.baseData.editFalge=!1}),e("#delet").click(function(){n.render.openDeleteConfirm(n.baseData.nodeData)})},server:{getTreeData:function(){o.ajaxFun("get","/api/Region/tree").then(function(e){o.appResult.isSucceeded(e)?n.render.renderTree(e.Result.TreeNodes):o.appResult.loadErrorText(e)}).fail(function(e){console.log(e)})},getNodedata:function(e,i){var s="";if("roleCatalog"===e)s="/api/Role/"+i,n.render.showForm("#DepartmentFrom");else{if("roleInfo"!==e)return;s="/api/Role/"+i,n.render.showForm("#staffFrom")}o.ajaxFun("get",s).then(function(i){if(o.appResult.isSucceeded(i)){n.baseData.nodeData=i.Result;var s=i.Result;"roleCatalog"===e?a.val("DepartmentFrom",{Name:s.Name,Code:s.Code,Message:s.Message}):"roleInfo"===e&&a.val("staffFrom",{Name:s.Name,Code:s.Code,Message:s.Message})}else t.msg("获取节点数据失败! "+i.Errors[0].Message,{icon:5})}).fail(function(e){console.log(e)})},addOrgan:function(e,a,i){var s=layui.consts.basePostData();n.baseData.sunNodeFalge?e.ParentId=n.baseData.nodeData.Id:e.ParentId="",s.Data=e,console.log(e);var l=JSON.stringify(s);o.ajaxFun("post","/api/Region/info",l).then(function(e){o.appResult.isSucceeded(e)?(n.server.getTreeData(),t.msg("数据添加成功!",{icon:6})):o.appResult.loadErrorText(e)}).fail(function(e){console.log(e)})},eidtOrgan:function(e,a){var t=layui.consts.basePostData();e.Id=n.baseData.id,t.Data=e;var i=JSON.stringify(t),t=layui.consts.basePostData();"staff"===flage&&(e.ParentId=n.baseData.id),e.ParentId="",t.Data=e;var i=JSON.stringify(t);o.ajaxFun("put","/api/Region/info",i).then(function(e){o.appResult.isSucceeded(e)?console.log("数据添加成功"):o.appResult.loadErrorText(e)}).fail(function(e){console.log(e)})},delet:function(e,a){console.log(e,a,"id信息");var i="";"regionInfo"===e&&(i="/api/Region/info/"+a,o.ajaxFun("DELETE",i).then(function(e){o.appResult.isSucceeded(e)?(n.server.getTreeData(),t.msg("数据删除成功!",{icon:6})):o.appResult.loadErrorText(e)}).fail(function(e){console.log(e)}))}},render:{renderTree:function(e){n.baseData.treeObj=layui.z_treeConfig.renderTree(e,"treeRegion",{callback:{onClick:n.currData.treeOnClick}})},showForm:function(a){e("#DepartmentFrom").addClass("layui-hide"),e("#staffFrom").addClass("layui-hide"),e(a).show(),e(a).removeClass("layui-hide")},renderFormData:function(e){"roleCatalog"===e.Flag&&a.val("DepartmentFrom",{Name:e.Title})},disabledBtton:function(e){o.isDisableButton("#lower",!1),o.isDisableButton("#upper",!1),o.isDisableButton("#delet",!1),"roleCatalog"===e?(o.isDisableButton("#lower",!0),o.isDisableButton("#upper",!0),o.isDisableButton("#showDepartment",!1),o.isDisableButton("#showStaff",!1)):"roleInfo"===e&&(o.isDisableButton("#showDepartment",!0),o.isDisableButton("#showStaff",!0))},showtips:function(){o.showtips(".layui-btn-group button")},openDeleteConfirm:function(e){t.confirm("你确定要删除<span style='font-weight:bolder'>"+e.Title+"</span>的节点吗?",{btn:["确定","取消"],icon:3},function(){n.server.delet(e.Flag,e.Id)},function(){console.log("取消")})}},currData:{getTreeNodeName:function(a,t){var n=o.getTreeNodeName(a,t,"name");e(".topName").val(n),e(".submit").html("立即修改")},treeOnClick:function(e,a,t){console.log(t),o.isDisableButton("#delet",!1),o.isDisableButton("#showStaff",!1),n.baseData.nodeData=t}}};n.init()});
//# sourceMappingURL=../src/maps/platform/region.js.map

/** layuiAdmin.std-v1.0.0 LPPL License By http://www.layui.com/admin/ */
 ;"use strict";layui.config({base:"../../../layuiadmin/"}).extend({index:"lib/index"}).use(["index","table","layer","tree","jquery_ztree_excheck","utils","common","consts"],function(){var e=layui.$,t=layui.form,n=layui.table,i=layui.layer,o=(layui.tree,layui.ztree,layui.jquery_ztree_excheck,layui.utils),a=(layui.common,[]);t.on("submit(Handler-search)",function(e){var t=e.field;console.log(e,"数据"),n.reload("metereadTable",{where:t})});n.render({elem:"#metereadTable",url:layui.setter.revenueUrl+"/api/ReadingPoint/query/list",parseData:layui.setter.parseData,request:layui.setter.request,where:{Method:"list","Data.CompanyCoding":"string"},cols:[[{title:"所属公司",templet:function(e){return e.Me.CompanyName||layui.consts.DATA_NULL}},{title:"所属区域-小区",templet:function(e){return e.Area_Id_VillageName||layui.consts.DATA_NULL}},{title:"编号",templet:function(e){return e.Me.Coding}},{title:"名称",templet:function(e){return e.Me.Name}},{field:"Address",title:"详细地址",minWidth:300,templet:function(e){return e.Me.Address||layui.consts.DATA_NULL}},{title:"状态",width:100,templet:function(e){return console.log(e,"d 状态"),1===parseInt(e.Me.Status,10)?layui.consts.STATUS_ACTIVE:layui.consts.STATUS_BLOCK}},{title:"创建时间",width:200,templet:function(e){return"<div>"+layui.util.toDateString(e.CreateDate)+"</div>"}},{title:"操作",width:150,align:"center",fixed:"right",toolbar:"#table-Handler"}]],loading:!0,page:!0,limit:10,text:{none:layui.consts.DATA_NO}});n.on("tool(table-Handler)",function(e){console.log(e.event,"obj 监听工具条"),"delete"===e.event&&r["delete"]({Tip:"是否确认删除？",Method:"remove",Data:{Id:e.data.Me.Id}}),"edit"===e.event&&r.edit({type:e.event,haveArray:!0,villageTypes:JSON.stringify(a),data:JSON.stringify([e.data])})});var l={getVillageType:function(){o.request("/api/Area/query/all",{Method:"all","Data.AreaType":3},"GET",function(e){if(console.log(e,"res"),e.IsSucceed)a=e.Result;else{var t=e.Errors[0].Message;i.msg(t,{icon:5})}},function(e){console.log(e,"err")})},insertReadingPoint:function(e){o.request("/api/ReadingPoint/insert",e,"POST",function(e){if(e.IsSucceed)n.reload("metereadTable"),i.msg("新增成功",{icon:1});else{var t=e.Errors[0].Message;i.msg(t,{icon:5})}},function(e){console.log(e,"err")},{contentType:"application/json"})},addReadingPoint:function(e){o.request("/api/Common/GetInsertGuid",{},"GET",function(t){console.log(t,"获取 Guid res"),t.IsSucceed?(e.Data.Idd=t.Result,l.insertReadingPoint(e)):i.msg("获取Guid失败",{icon:5})},function(e){console.log(e,"获取 Guid err")})},editReadingPoint:function(e){o.request("/api/ReadingPoint/update",e,"PUT",function(e){if(e.IsSucceed)n.reload("metereadTable"),i.msg("修改成功",{icon:1});else{var t=e.Errors[0].Message;i.msg(t,{icon:5})}},function(e){console.log(e,"err")},{contentType:"application/json"})},delReadingPoint:function(e){o.request("/api/ReadingPoint/remove",e,"DELETE",function(e){e.IsSucceed?(n.reload("metereadTable"),i.msg("删除成功",{icon:1})):i.msg("删除失败",{icon:5})},function(e){console.log(e,"err")},{contentType:"application/json"})}},r={"export":function(){console.log("导出数据")},create:function(t){var n="../tpl/from/meteReadForm.html?"+e.param(t);i.open({type:2,title:"新增抄表点档案",content:n,maxmin:!0,area:["700px","400px"],btn:["确定","取消"],yes:function(e,t){console.log("点击确定");var n=window["layui-layer-iframe"+e],o="LAY-area-files-submit",a=t.find("iframe").contents().find("#"+o);n.layui.form.on("submit("+o+")",function(t){var n=t.field,o={Method:"insert",Data:n};console.log(o,"新增抄表点档案 params"),l.addReadingPoint(o),i.close(e)}),a.trigger("click")},btn2:function(){console.log("点击取消")},cancel:function(){console.log("点击取消")}})},edit:function(t){console.log("编辑");var n="../tpl/from/meteReadForm.html?"+e.param(t);i.open({type:2,title:"编辑抄表点档案",content:n,maxmin:!0,area:["700px","400px"],btn:["确定","取消"],yes:function(n,o){console.log("点击确定");var a=window["layui-layer-iframe"+n],r="LAY-area-files-submit",s=o.find("iframe").contents().find("#"+r);a.layui.form.on("submit("+r+")",function(o){var a=JSON.parse(t.data)[0].Me,r=e.extend({},o.field,{Id:a.Id}),s={Method:"update",Data:r};console.log(s,"passFields"),l.editReadingPoint(s),i.close(n)}),s.trigger("click")},btn2:function(){console.log("点击取消")},cancel:function(){console.log("点击取消")}})},"delete":function(e){console.log("删除",e),i.confirm(e.Tip,{icon:3,title:"删除提示"},function(){console.log(e.Data.Id,"待删除的ID"),l.delReadingPoint(e)})}};e(".layui-btn").on("click",function(){var t=e(this).data("type");r[t]?r[t].call(this,{type:t,haveArray:!0,villageTypes:JSON.stringify(a),data:[]}):""}),l.getVillageType()});
//# sourceMappingURL=../src/maps/danganguanli/meteread.js.map
